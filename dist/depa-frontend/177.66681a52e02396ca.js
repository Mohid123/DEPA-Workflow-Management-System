"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[177],{21177:(V,b,n)=>{n.r(b),n.d(b,{FormsModule:()=>v});var p=n(36895),d=n(19132),t=n(94650);class y{}y.\u0275fac=function(e){return new(e||y)},y.\u0275cmp=t.Xpm({type:y,selectors:[["app-forms"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},dependencies:[d.lC]});var l=n(90433),I=n(77579),x=n(82722),D=n(20696),S=n(22603),Z=n(94051),g=n(60101),f=n(75809),C=n(39367),M=n(56546);const E=["json"],N=["code"];function J(i,e){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",4),t.NdJ("click",function(){const a=t.CHM(o).index,c=t.oxw();return c.activeIndex=a,t.KtG(c.onJsonView())}),t._UZ(2,"i",5),t._uU(3),t.qZA(),t.BQk()}if(2&i){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function w(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"section",6)(1,"div",7)(2,"div",8)(3,"label",9),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.qZA()(),t.TgZ(6,"form-builder",11),t.NdJ("change",function(s){t.CHM(o);const a=t.oxw();return t.KtG(a.onChange(s))}),t.qZA(),t.TgZ(7,"div",12)(8,"button",13),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.submitFormData())}),t._uU(9," Submit Form "),t.qZA(),t.TgZ(10,"button",14),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.cancelFormData())}),t._uU(11," Cancel "),t.qZA()()()}if(2&i){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("form",o.form)}}function B(i,e){if(1&i&&(t.TgZ(0,"section",6)(1,"div",15),t._UZ(2,"formio",16),t.qZA()()),2&i){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function j(i,e){1&i&&(t.TgZ(0,"section",6)(1,"div",15)(2,"pre",17),t._UZ(3,"code",18),t.qZA()()())}class F{constructor(e,o,r,s,a){this.transportService=e,this.notif=o,this.router=r,this.activatedRoute=s,this.formService=a,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode}),this.formDisplayType=new l.NI("form"),this.destroy$=new I.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.editMode=this.transportService.isFormEdit.value,this.activatedRoute.queryParams?.subscribe(c=>{c.key&&this.formService.getFormByKey(c.key).pipe((0,x.R)(this.destroy$)).subscribe(u=>{u&&(this.form=u,this.formTitleControl.setValue(u?.title))}),!0===this.editMode?(this.form=this.transportService.sendFormDataForEdit.value,this.formTitleControl.setValue(this.transportService.sendFormDataForEdit.value.title),this.formTitleControl.disable()):this.form={title:this.formTitleControl?.value,key:"",display:this.formDisplayType.value,components:[]}})}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,this.formValue=e.form}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value)return this.notif.displayNotification("Please provide a title for your form","Create Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("You have not created a form!","Create Form","warning");if(this.form.title=this.formTitleControl?.value,this.form.display=this.formDisplayType?.value,this.form.key=this.formTitleControl?.value?.replace(" ","-"),0==this.editMode)if(this.transportService.formBuilderData.value[0].components?.length>0){const e=[...this.transportService.formBuilderData.value,this.form];this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}else this.transportService.sendFormBuilderData([this.form]),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value]);else{const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){if(0==this.editMode)this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value]);else{const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}F.\u0275fac=function(e){return new(e||F)(t.Y36(D.R),t.Y36(S.T),t.Y36(d.F0),t.Y36(d.gz),t.Y36(Z.s))},F.\u0275cmp=t.Xpm({type:F,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(E,7),t.Gf(N,7)),2&e){let r;t.iGM(r=t.CRH())&&(o.jsonElement=r.first),t.iGM(r=t.CRH())&&(o.codeElement=r.first)}},decls:7,vars:5,consts:[[1,"py-5","mt-40"],["tuiMobileTabs","",1,"flex","justify-center","mx-2","lg:mx-20","md:mx-10",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","w-8/12","grid-cols-12","gap-3","px-1","mx-auto","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],[3,"form","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t._UZ(0,"app-header"),t.TgZ(1,"section",0)(2,"tui-tabs",1),t.YNc(3,J,4,3,"ng-container",2),t.qZA()(),t.YNc(4,w,12,2,"section",3),t.YNc(5,B,3,2,"section",3),t.YNc(6,j,4,0,"section",3)),2&e&&(t.xp6(2),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[p.sg,p.O5,g.k4,g.hd,f.H9,f.p_,f.yu,C.v0,M.G,l.Fj,l.JJ,l.oH]});var m=n(4266);const A=["json"],U=["code"];function k(i,e){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",4),t.NdJ("click",function(){const a=t.CHM(o).index,c=t.oxw();return c.activeIndex=a,t.KtG(c.onJsonView())}),t._UZ(2,"i",5),t._uU(3),t.qZA(),t.BQk()}if(2&i){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function Q(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"section",6)(1,"div",7)(2,"div",8)(3,"label",9),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.qZA()(),t.TgZ(6,"form-builder",11),t.NdJ("change",function(s){t.CHM(o);const a=t.oxw();return t.KtG(a.onChange(s))}),t.qZA(),t.TgZ(7,"div",12)(8,"button",13),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.submitFormData())}),t._uU(9," Submit Form "),t.qZA(),t.TgZ(10,"button",14),t.NdJ("click",function(){t.CHM(o);const s=t.oxw();return t.KtG(s.cancelFormData())}),t._uU(11," Cancel "),t.qZA()()()}if(2&i){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("form",o.form)}}function Y(i,e){if(1&i&&(t.TgZ(0,"section",6)(1,"div",15),t._UZ(2,"formio",16),t.qZA()()),2&i){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function R(i,e){1&i&&(t.TgZ(0,"section",6)(1,"div",15)(2,"pre",17),t._UZ(3,"code",18),t.qZA()()())}class _{constructor(e,o,r,s,a,c){this.notif=e,this.router=o,this.activatedRoute=r,this.formService=s,this.transportService=a,this._location=c,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode}),this.formDisplayType=new l.NI("form"),this.destroy$=new I.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.activatedRoute?.queryParams?.subscribe(u=>{u.id?(this.editFormID=u.id,this.formService.getFormById(u.id).pipe((0,x.R)(this.destroy$)).subscribe(T=>{T&&(this.form=T,this.formTitleControl.setValue(T?.title))})):this.form={title:this.formTitleControl?.value,key:null,display:this.formDisplayType.value||null,components:[]}})}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,this.formValue=e.form}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value)return this.notif.displayNotification("Please provide a title for your form","Edit Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("Your form cannot be empty!","Edit Form","warning");const e={title:this.formTitleControl?.value,display:this.form?.display??this.formDisplayType.value,components:this.form?.components},o=(0,m.rV)(m.MX.formEdit);this.editFormID?this.formService.updateForm(this.editFormID,e).pipe((0,x.R)(this.destroy$)).subscribe(r=>{r&&(o?((0,m.cl)(m.MX.formEdit),setTimeout(()=>this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}}),800)):this._location.back())}):(Object.assign(e,{subModuleId:this.transportService.subModuleID?.value}),this.formService.createForm(e).pipe((0,x.R)(this.destroy$)).subscribe(r=>{r&&(o?((0,m.cl)(m.MX.formEdit),setTimeout(()=>this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}}),800)):this._location.back())}))}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){(0,m.rV)(m.MX.formEdit)?((0,m.cl)(m.MX.formEdit),this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}})):this._location.back()}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}_.\u0275fac=function(e){return new(e||_)(t.Y36(S.T),t.Y36(d.F0),t.Y36(d.gz),t.Y36(Z.s),t.Y36(D.R),t.Y36(p.Ye))},_.\u0275cmp=t.Xpm({type:_,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(A,7),t.Gf(U,7)),2&e){let r;t.iGM(r=t.CRH())&&(o.jsonElement=r.first),t.iGM(r=t.CRH())&&(o.codeElement=r.first)}},decls:6,vars:5,consts:[[1,"py-5"],["tuiMobileTabs","",1,"mx-2","lg:mx-20","md:mx-10","flex","justify-center",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","grid-cols-12","gap-3","w-8/12","mx-auto","px-1","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],[3,"form","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t.TgZ(0,"section",0)(1,"tui-tabs",1),t.YNc(2,k,4,3,"ng-container",2),t.qZA()(),t.YNc(3,Q,12,2,"section",3),t.YNc(4,Y,3,2,"section",3),t.YNc(5,R,4,0,"section",3)),2&e&&(t.xp6(1),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[p.sg,p.O5,g.k4,g.hd,f.H9,f.p_,f.yu,C.v0,l.Fj,l.JJ,l.oH]});const G=[{path:"",component:y,children:[{path:"form-builder",component:F,data:{breadcrumb:"Form builder"}},{path:"edit-form",component:_,data:{breadcrumb:"Edit-Form"}},{path:"",redirectTo:"form-builder",pathMatch:"full"}]}];class h{}h.\u0275fac=function(e){return new(e||h)},h.\u0275mod=t.oAB({type:h}),h.\u0275inj=t.cJS({imports:[d.Bz.forChild(G),d.Bz]});var H=n(77915);class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275mod=t.oAB({type:v}),v.\u0275inj=t.cJS({imports:[p.ez,h,g.XI,f.$$,C.fN,M.G,l.UX,H.e]})}}]);