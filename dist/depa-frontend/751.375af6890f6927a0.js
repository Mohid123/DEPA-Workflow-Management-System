"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[751],{51751:(ge,oe,u)=>{u.r(oe),u.d(oe,{AppListingModule:()=>Ze});var n=u(36895),a=u(19132),d=u(4266),e=u(94650);class J{constructor(i,t){this.ac=i,this.router=t;let o=(0,d.rV)(d.MX.moduleSlug)||"",r=(0,d.rV)(d.MX.moduleID)||"";"/modules"==this.router.url&&this.router.navigate(["/modules",o],{queryParams:{moduleID:r}})}}J.\u0275fac=function(i){return new(i||J)(e.Y36(a.gz),e.Y36(a.F0))},J.\u0275cmp=e.Xpm({type:J,selectors:[["app-app-listing"]],decls:1,vars:0,template:function(i,t){1&i&&e._UZ(0,"router-outlet")},dependencies:[a.lC]});var c=u(90433),U=u(86169),A=u(1163),k=u(61135),x=u(77579),f=u(82722),L=u(63900),E=u(17820),ne=u(15274),ae=u(20696),q=u(46954),X=u(22603),K=u(18505),I=u(61005),Z=u(80529);class M extends I.s{constructor(i,t){super(i),this.http=i,this.notif=t}uploadMedia(i){const t=new FormData;return t.append("file",i),this.postMedia("/upload",t).pipe((0,K.b)(o=>{if(o.hasErrors())return this.notif.displayNotification(o.errors[0]?.error?.message,"Image Upload","error")}))}}M.\u0275fac=function(i){return new(i||M)(e.LFG(Z.eN),e.LFG(X.T))},M.\u0275prov=e.Yz7({token:M,factory:M.\u0275fac,providedIn:"root"});var $=u(56546),de=u(5754),ue=u(86679),N=u(56772),R=u(77975),C=u(21469),Y=u(70655),te=u(1054),le=u(78535),O=u(37414),H=u(68923),W=u(79982),me=u(88261),w=u(82302),j=u(68702),T=u(80063),B=u(39255),z=u(47846),pe=u(31947),Te=u(53281);const fe=["*"];let S=(()=>{class s{constructor(){this.name="tui-radio-group-"+s.index++}}return s.index=0,s.\u0275fac=function(t){return new(t||s)},s.\u0275cmp=e.Xpm({type:s,selectors:[["tui-radio-group"]],inputs:{name:"name"},ngContentSelectors:fe,decls:1,vars:0,template:function(t,o){1&t&&(e.F$t(),e.Hsn(0))},encapsulation:2,changeDetection:0}),(0,Y.gn)([(0,H.TH)()],s.prototype,"name",void 0),s})();const _=["focusableElement"];function D(s,i){if(1&s&&e._UZ(0,"div",4),2&s){const t=e.oxw();e.Q6J("@tuiScaleIn",t.animation)}}const G={size:"m",appearances:{unchecked:"outline",checked:"primary"}},ce=new e.OlP("[TUI_RADIO_OPTIONS]",{factory:()=>G});let Ce=(()=>{class s extends te.F9{constructor(t,o,r,l,g){super(t,o),this.animationOptions=r,this.options=l,this.radioGroup=g,this.identityMatcher=le.bg,this.name=null,this.size=this.options.size,this.pseudoDisabled=!1,this.animation=Object.assign({value:""},this.animationOptions)}get appearance(){return this.checked?this.options.appearances.checked:this.options.appearances.unchecked}get computedDisabled(){return this.disabled||this.pseudoDisabled}get nativeFocusableElement(){return!this.focusableElement||this.computedDisabled?null:this.focusableElement.nativeElement}get focused(){return(0,B.V8)(this.nativeFocusableElement)}get checked(){return null===this.value?null===this.item:null!=this.item&&this.identityMatcher(this.value,this.item)}get computedName(){return this.name||this.radioGroupName||this.controlName||""}get isFocusable(){return!this.readOnly&&this.computedFocusable}onChecked(t){t&&this.updateValue(void 0!==this.item?this.item:this.fallbackValue)}onFocused(t){this.updateFocused(t)}onFocusVisible(t){this.updateFocusVisible(t)}get radioGroupName(){return null===this.radioGroup?null:this.radioGroup.name}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(c.a5,10),e.Y36(e.sBO),e.Y36(pe.Pw),e.Y36(ce),e.Y36(S,8))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tui-radio"]],viewQuery:function(t,o){if(1&t&&e.Gf(_,5),2&t){let r;e.iGM(r=e.CRH())&&(o.focusableElement=r.first)}},hostVars:3,hostBindings:function(t,o){2&t&&(e.uIk("data-size",o.size),e.ekj("_disabled",o.computedDisabled))},inputs:{item:"item",identityMatcher:"identityMatcher",name:"name",size:"size",pseudoDisabled:"pseudoDisabled"},features:[e._Bn([(0,O.FT)(s),(0,te.wB)(s)]),e.qOj],decls:4,vars:12,consts:[["tuiWrapper","",3,"appearance","disabled","focus","hover","active","invalid"],["class","t-mark",4,"ngIf"],["type","radio",1,"t-native",3,"id","disabled","tuiChecked","tuiFocusable","tuiFocusedChange","tuiCheckedChange","tuiFocusVisibleChange"],["focusableElement",""],[1,"t-mark"]],template:function(t,o){1&t&&(e.TgZ(0,"div",0),e.YNc(1,D,1,1,"div",1),e.TgZ(2,"input",2,3),e.NdJ("tuiFocusedChange",function(l){return o.onFocused(l)})("tuiCheckedChange",function(l){return o.onChecked(l)})("tuiFocusVisibleChange",function(l){return o.onFocusVisible(l)}),e.qZA()()),2&t&&(e.Q6J("appearance",o.appearance)("disabled",o.computedDisabled)("focus",o.computedFocusVisible)("hover",o.pseudoHover)("active",o.pseudoActive)("invalid",o.computedInvalid),e.xp6(1),e.Q6J("ngIf",o.checked),e.xp6(1),e.Q6J("id",o.id)("disabled",o.computedDisabled)("tuiChecked",o.checked)("tuiFocusable",o.isFocusable),e.uIk("name",o.computedName))},dependencies:[z.o,n.O5,j.t,W.t,me.U,T.q],styles:["[_nghost-%COMP%]{font:var(--tui-font-text-s);color:var(--tui-text-01);position:relative;display:block;flex-shrink:0;border-radius:100%}[data-size=m][_nghost-%COMP%]{width:1rem;height:1rem}[data-size=l][_nghost-%COMP%]{width:1.5rem;height:1.5rem}._readonly[_nghost-%COMP%]{pointer-events:none}.t-mark[_ngcontent-%COMP%]{position:absolute;background-color:currentColor;border-radius:100%}[data-size=m][_nghost-%COMP%]   .t-mark[_ngcontent-%COMP%]{margin:.25rem;width:.5rem;height:.5rem}[data-size=l][_nghost-%COMP%]   .t-mark[_ngcontent-%COMP%]{margin:.4375rem;width:.625rem;height:.625rem}.t-native[_ngcontent-%COMP%]{padding:0;margin:0;border:0;border-radius:inherit;background:none;font-size:inherit;line-height:inherit;font-weight:inherit;color:inherit;caret-color:currentColor;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;word-break:keep-all;-webkit-text-fill-color:currentColor;position:absolute;top:0;left:0;width:100%;height:100%;opacity:0;cursor:pointer}.t-native[_ngcontent-%COMP%]:-webkit-autofill, .t-native[_ngcontent-%COMP%]:-webkit-autofill:hover, .t-native[_ngcontent-%COMP%]:-webkit-autofill:focus{caret-color:var(--tui-base-09);border-radius:inherit;color:inherit!important;background-color:transparent!important;-webkit-text-fill-color:var(--tui-text-01)!important;border-color:var(--tui-autofill);-webkit-box-shadow:0 0 0 100rem var(--tui-autofill) inset!important}._disabled[_nghost-%COMP%]   .t-native[_ngcontent-%COMP%]{cursor:default}"],data:{animation:[Te.gI]},changeDetection:0}),(0,Y.gn)([(0,H.TH)()],s.prototype,"identityMatcher",void 0),(0,Y.gn)([(0,H.TH)()],s.prototype,"name",void 0),(0,Y.gn)([(0,H.TH)()],s.prototype,"size",void 0),(0,Y.gn)([(0,H.TH)()],s.prototype,"pseudoDisabled",void 0),s})(),v=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[n.ez,j.S,W.u,me.F,T.c,z.W]]}),s})();const F=["*"];let m=(()=>{class s extends te.F9{constructor(t,o,r,l){super(t,o),this.modeDirective=r,this.options=l,this.size=this.options.size,this.identityMatcher=le.bg,this.pseudoDisabled=!1}get nativeFocusableElement(){return this.radio?this.radio.nativeFocusableElement:null}get focused(){return!!this.radio&&this.radio.focused}get computedDisabled(){return this.disabled||this.pseudoDisabled}get mode(){return this.modeDirective?this.modeDirective.mode:null}onFocused(t){this.updateFocused(t)}onModelChange(t){this.updateValue(t)}}return s.\u0275fac=function(t){return new(t||s)(e.Y36(c.a5,10),e.Y36(e.sBO),e.Y36(w.w,8),e.Y36(ce))},s.\u0275cmp=e.Xpm({type:s,selectors:[["tui-radio-labeled"]],viewQuery:function(t,o){if(1&t&&e.Gf(Ce,5),2&t){let r;e.iGM(r=e.CRH())&&(o.radio=r.first)}},hostVars:4,hostBindings:function(t,o){2&t&&(e.uIk("data-size",o.size)("data-mode",o.mode),e.ekj("_disabled",o.computedDisabled))},inputs:{item:"item",size:"size",identityMatcher:"identityMatcher",pseudoDisabled:"pseudoDisabled"},features:[e._Bn([(0,O.FT)(s),(0,te.wB)(s)]),e.qOj],ngContentSelectors:F,decls:4,vars:15,consts:[[1,"t-wrapper"],[3,"focusable","identityMatcher","name","nativeId","readOnly","pseudoDisabled","pseudoInvalid","pseudoFocus","pseudoHover","pseudoActive","size","item","ngModel","ngModelChange","focusedChange"],[1,"t-content"]],template:function(t,o){1&t&&(e.F$t(),e.TgZ(0,"label",0)(1,"tui-radio",1),e.NdJ("ngModelChange",function(l){return o.onModelChange(l)})("focusedChange",function(l){return o.onFocused(l)}),e.qZA(),e.TgZ(2,"div",2),e.Hsn(3),e.qZA()()),2&t&&(e.xp6(1),e.Q6J("focusable",o.focusable)("identityMatcher",o.identityMatcher)("name",o.computedName||"")("nativeId",o.nativeId)("readOnly",o.readOnly)("pseudoDisabled",o.computedDisabled)("pseudoInvalid",o.computedInvalid)("pseudoFocus",o.pseudoFocus)("pseudoHover",o.pseudoHover)("pseudoActive",o.pseudoActive)("size",o.size)("item",o.item)("ngModel",o.value),e.xp6(1),e.ekj("t-content_disabled",o.computedDisabled))},dependencies:[Ce,c.JJ,c.On],styles:["[_nghost-%COMP%]{position:relative;display:block;font:var(--tui-font-text-s);line-height:1rem}._readonly[_nghost-%COMP%]{pointer-events:none}.t-wrapper[_ngcontent-%COMP%]{display:inline-flex;max-width:100%;cursor:pointer;vertical-align:top}._disabled[_nghost-%COMP%]   .t-wrapper[_ngcontent-%COMP%]{cursor:default}[data-mode=onDark][_nghost-%COMP%]   .t-wrapper[_ngcontent-%COMP%]{color:var(--tui-text-01-night)}.t-content[_ngcontent-%COMP%]{word-wrap:break-word;min-width:0}.t-content_disabled[_ngcontent-%COMP%]{opacity:var(--tui-disabled-opacity)}[data-size=m][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{margin-left:.5rem}[data-size=l][_nghost-%COMP%]   .t-content[_ngcontent-%COMP%]{font:var(--tui-font-text-m);margin-left:.75rem}"],changeDetection:0}),(0,Y.gn)([(0,H.TH)()],s.prototype,"size",void 0),(0,Y.gn)([(0,H.TH)()],s.prototype,"identityMatcher",void 0),(0,Y.gn)([(0,H.TH)()],s.prototype,"pseudoDisabled",void 0),s})(),b=(()=>{class s{}return s.\u0275fac=function(t){return new(t||s)},s.\u0275mod=e.oAB({type:s}),s.\u0275inj=e.cJS({imports:[[n.ez,c.u5,W.u,me.F,v]]}),s})();var p=u(60946),h=u(37378),Q=u(4053),ie=u(73347),se=u(60117),he=u(71115),ye=u(53861),be=u(39367),we=u(13675),De=u(87819),ke=u(60101),Fe=u(75407);function ze(s,i){1&s&&(e.TgZ(0,"span",55),e._uU(1," An app by this title already exists. Please select another name "),e.qZA())}function We(s,i){if(1&s&&(e.TgZ(0,"div",56),e._UZ(1,"img",57),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("src",t.base64File,e.LSH)}}function je(s,i){1&s&&(e.TgZ(0,"div",58)(1,"div",59),e._UZ(2,"img",60),e.qZA(),e.TgZ(3,"ul",61)(4,"li"),e._uU(5,"Only (JPEG, PNG, WEBP) extensions are allowed"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"Up to 2MB file size is allowed"),e.qZA()()())}function Xe(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"option",62),e._uU(2),e.qZA(),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.value),e.xp6(1),e.Oqu(null==t?null:t.label)}}function et(s,i){1&s&&(e.TgZ(0,"label",72),e._uU(1,"Add new companies"),e.qZA())}function tt(s,i){1&s&&(e.TgZ(0,"span",55),e._uU(1," Please provide a company name with upto 50 characters "),e.qZA())}function nt(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"button",73),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.submitNewCompany())}),e._uU(1,"Submit"),e.qZA()}}function it(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",63)(2,"div",64)(3,"div",65),e.YNc(4,et,2,0,"label",66),e._UZ(5,"input",67),e.YNc(6,tt,2,0,"span",10),e.qZA(),e.TgZ(7,"div",68)(8,"button",69),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw();return e.KtG(g.removeCompany(l))}),e.qZA()()(),e.TgZ(9,"div",70),e.YNc(10,nt,2,0,"button",71),e.qZA()(),e.BQk()}if(2&s){const t=i.index,o=i.first,r=i.last,l=e.oxw();e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngClass",l.getValidityForCompany(t)?"is-invalid":""),e.xp6(1),e.Q6J("ngIf",l.getValidityForCompany(t)),e.xp6(1),e.Q6J("ngClass",o?"mt-7":"mt-0"),e.xp6(3),e.Q6J("ngIf",r)}}function ot(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"option",62),e._uU(2),e.qZA(),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.value),e.xp6(1),e.Oqu(null==t?null:t.label)}}function st(s,i){1&s&&(e.TgZ(0,"label",72),e._uU(1,"Add new categories"),e.qZA())}function rt(s,i){1&s&&(e.TgZ(0,"span",55),e._uU(1," Please provide a category name with upto 40 characters "),e.qZA())}function at(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"button",73),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(3);return e.KtG(r.submitNewCategory())}),e._uU(1,"Submit"),e.qZA()}}function lt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",63)(2,"div",64)(3,"div",65),e.YNc(4,st,2,0,"label",66),e._UZ(5,"input",76),e.YNc(6,rt,2,0,"span",10),e.qZA(),e.TgZ(7,"div",68)(8,"button",69),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.removeCategory(l))}),e.qZA()()(),e.TgZ(9,"div",70),e.YNc(10,at,2,0,"button",71),e.qZA()(),e.BQk()}if(2&s){const t=i.index,o=i.first,r=i.last,l=e.oxw(2);e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngClass",l.getValidityForCategory(t)?"is-invalid":""),e.xp6(1),e.Q6J("ngIf",l.getValidityForCategory(t)),e.xp6(1),e.Q6J("ngClass",o?"mt-7":"mt-0"),e.xp6(3),e.Q6J("ngIf",r)}}const ut=function(s){return{validation:"required",message:"Category is required",control:s}};function ct(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",19)(2,"label",6),e._uU(3,"Category Name "),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"select",74),e.YNc(7,ot,3,2,"ng-container",21),e.qZA(),e.GkF(8,9),e.qZA(),e.TgZ(9,"div",22)(10,"p",23),e._uU(11,"If your desired category isn't listed, you can add it below"),e.qZA()(),e.ynx(12,75),e.YNc(13,lt,11,6,"ng-container",21),e.BQk(),e.TgZ(14,"button",25),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addCategory())}),e.qZA(),e.BQk()}if(2&s){const t=e.oxw(),o=e.MAs(104);e.xp6(6),e.Q6J("ngClass",null!=t.f.categoryName&&t.f.categoryName.invalid&&null!=t.f.categoryName&&t.f.categoryName.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngForOf",t.categoryList),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(5,ut,t.f.categoryName)),e.xp6(5),e.Q6J("ngForOf",t.categories.controls)}}function dt(s,i){1&s&&(e.TgZ(0,"span",55),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function mt(s,i){1&s&&(e.ynx(0),e.TgZ(1,"option",94),e._uU(2,"AND"),e.qZA(),e.BQk())}function pt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",79)(2,"label",6),e._uU(3),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"custom-multi-select",80),e.NdJ("checkUsersLength",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.countUsers(r,l))})("approverList",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.getApproverList(r,l))}),e.qZA(),e.YNc(7,dt,2,0,"span",10),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"div",79)(10,"label",81),e._uU(11,"Condition "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"select",82),e.NdJ("change",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.validateSelection(r))}),e.YNc(15,mt,3,0,"ng-container",26),e.TgZ(16,"option",83),e._uU(17,"OR"),e.qZA(),e.TgZ(18,"option",84),e._uU(19,"NONE"),e.qZA()()(),e.TgZ(20,"div",85),e._UZ(21,"tui-tooltip",86),e.TgZ(22,"tui-badged-content",87)(23,"button",88),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(),g=e.MAs(106);return e.KtG(l.openEmailNotifyModal(g,l.workflows,r))}),e.qZA()()(),e.TgZ(24,"div",89)(25,"div",90)(26,"tui-radio-labeled",91)(27,"div"),e._uU(28,"Any (Create)"),e.qZA(),e.TgZ(29,"div",92),e._uU(30,"Any user can create a new submission"),e.qZA()(),e.TgZ(31,"tui-radio-labeled",91)(32,"div"),e._uU(33,"Any (Create & Modify)"),e.qZA(),e.TgZ(34,"div",92),e._uU(35,"Any user can create a new submission and modify it's workflow"),e.qZA()(),e.TgZ(36,"tui-radio-labeled",91)(37,"div"),e._uU(38,"Disabled"),e.qZA(),e.TgZ(39,"div",92),e._uU(40,"Only Admin users can create and modify submissions"),e.qZA()()()(),e.TgZ(41,"div",93)(42,"button",69),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.removeWorkflowStep(r))}),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw(),o=t.first,r=t.index,l=e.oxw(),g=e.MAs(108);let ee;e.xp6(3),e.hij("",o?"Creators":"Approvers"," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(8,12,l.showError)&&r===l.errorIndex),e.xp6(8),e.Q6J("ngIf",r>0),e.xp6(6),e.Q6J("content",g),e.xp6(1),e.Q6J("contentTop",null==(ee=l.workflows.at(r).get("emailNotifyTo"))||null==ee.value?null:ee.value.length)("colorTop","green"),e.xp6(4),e.Q6J("formControl",l.accessTypeValue)("item",l.items[0]),e.xp6(5),e.Q6J("formControl",l.accessTypeValue)("item",l.items[1]),e.xp6(5),e.Q6J("formControl",l.accessTypeValue)("item",l.items[2])}}function _t(s,i){1&s&&(e.TgZ(0,"span",55),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function gt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",89)(2,"label",6),e._uU(3,"Approvers "),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"custom-multi-select",80),e.NdJ("checkUsersLength",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.countUsers(r,l))})("approverList",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.getApproverList(r,l))}),e.qZA(),e.YNc(7,_t,2,0,"span",10),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"div",89)(10,"label",81),e._uU(11,"Condition "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"select",82),e.NdJ("change",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.validateSelection(r))}),e.TgZ(15,"option",94),e._uU(16,"AND"),e.qZA(),e.TgZ(17,"option",83),e._uU(18,"OR"),e.qZA(),e.TgZ(19,"option",84),e._uU(20,"NONE"),e.qZA()()(),e.TgZ(21,"div",85),e._UZ(22,"tui-tooltip",86),e.TgZ(23,"tui-badged-content",87)(24,"button",88),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(),g=e.MAs(106);return e.KtG(l.openEmailNotifyModal(g,l.workflows,r))}),e.qZA()()(),e.TgZ(25,"div",95)(26,"button",69),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.removeWorkflowStep(r))}),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw().index,o=e.oxw(),r=e.MAs(108);let l;e.xp6(7),e.Q6J("ngIf",e.lcZ(8,4,o.showError)&&t===o.errorIndex),e.xp6(15),e.Q6J("content",r),e.xp6(1),e.Q6J("contentTop",null==(l=o.workflows.at(t).get("emailNotifyTo"))||null==l.value?null:l.value.length)("colorTop","green")}}function ft(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"p",77),e._uU(2),e.qZA(),e.TgZ(3,"div",78),e.YNc(4,pt,43,14,"ng-container",26),e.YNc(5,gt,27,6,"ng-container",26),e.qZA(),e.BQk()),2&s){const t=i.index;e.xp6(2),e.hij("Step ",0===t?"1":t+1,""),e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",t>0)}}function ht(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",96),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=e.MAs(110);return e.KtG(r.openSummarySchemaDialog(l))}),e._uU(1," Summary & View Schema "),e.qZA()}}function bt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",99),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.activeIndex=l)}),e._uU(2),e.qZA(),e.BQk()}if(2&s){const t=i.$implicit;e.xp6(2),e.Oqu(t)}}function vt(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",101)(1,"div",70)(2,"div",102)(3,"a",103),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(2),g=e.MAs(114);return e.KtG(l.addDefaultData(r,g))}),e._UZ(4,"i",104),e.qZA(),e.TgZ(5,"a",105),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(2);return e.KtG(l.sendFormForEdit(r))}),e._UZ(6,"i",106),e.qZA(),e.TgZ(7,"a",107),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(2),g=e.MAs(112);return e.KtG(l.deleteFormDialog(g,r))}),e._UZ(8,"i",108),e.qZA()()(),e._UZ(9,"formio",109),e.qZA()}if(2&s){const t=e.oxw(),o=t.$implicit,r=t.index,l=e.oxw(2);e.xp6(9),e.Q6J("language",l.language)("options",l.options)("form",o)("submission",l.deafultFormSubmission[r])}}function yt(s,i){if(1&s&&(e.ynx(0),e.YNc(1,vt,10,4,"div",100),e.BQk()),2&s){const t=i.index,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.activeIndex==t)}}function xt(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"section",97)(2,"nav",98),e.YNc(3,bt,3,1,"ng-container",21),e.qZA(),e.YNc(4,yt,2,1,"ng-container",21),e.qZA(),e.BQk()),2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.formTabs),e.xp6(1),e.Q6J("ngForOf",t.formComponents)}}function Tt(s,i){1&s&&(e.ynx(0),e.TgZ(1,"div",110),e._UZ(2,"div",111),e.TgZ(3,"div",112),e._UZ(4,"div",113)(5,"div",113),e.qZA(),e.TgZ(6,"div",112),e._UZ(7,"div",114)(8,"div",114),e.qZA()(),e.BQk())}function Ct(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"div",115)(2,"span",116),e._uU(3),e.qZA()(),e.BQk()),2&s){const t=e.oxw().message;e.xp6(3),e.hij(" ",t," ")}}function wt(s,i){if(1&s&&e.YNc(0,Ct,4,1,"ng-container",26),2&s){const t=i.control;e.Q6J("ngIf",t.hasError(i.validation)&&(t.dirty||t.touched))}}function St(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",125),2&s){const t=e.oxw(2);e.Q6J("items",t.userListForEmail)}}function At(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"p",117),e._uU(1,"Email Notification Users"),e.qZA(),e.TgZ(2,"p",118),e._uU(3," Please specify the users you want to send the notification email to "),e.qZA(),e.TgZ(4,"div",119)(5,"tui-input-tag",120),e.NdJ("searchChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onSearchChange(r))}),e._uU(6," Type to search and press Enter to select... "),e.YNc(7,St,1,1,"tui-data-list-wrapper",121),e.qZA()(),e.TgZ(8,"div",122)(9,"button",123),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.validateEmails())}),e._uU(10," Confirm "),e.qZA(),e.TgZ(11,"button",124),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancelEmailNotify())}),e._uU(12," Cancel "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(5),e.Q6J("formControl",null==t.currentFieldArray||null==t.currentFieldArray.controls[t.activeEmailIndex]?null:t.currentFieldArray.controls[t.activeEmailIndex].controls.emailNotifyTo)("tuiTextfieldLabelOutside",!0)}}function It(s,i){1&s&&(e.TgZ(0,"strong",126),e._uU(1,"How conditions work?"),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"ul",127)(4,"li")(5,"strong"),e._uU(6,"AND"),e.qZA(),e._uU(7," implies that every user of the step must provide approval"),e.qZA(),e.TgZ(8,"li",22)(9,"strong"),e._uU(10,"OR"),e.qZA(),e._uU(11," implies that any one of the users may provide approval"),e.qZA(),e.TgZ(12,"li")(13,"strong"),e._uU(14,"NONE"),e.qZA(),e._uU(15," implies that there is only one user per step and hence no conditon is necessary"),e.qZA()())}function Mt(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",125),2&s){const t=e.oxw(2);e.Q6J("items",t.summarySchemaFields)}}function Zt(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",125),2&s){const t=e.oxw(3);e.Q6J("items",t.formKeysForViewSchema)}}function Dt(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",125),2&s){const t=e.oxw(3);e.Q6J("items",t.selectItems)}}function kt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",138)(2,"tui-select",139),e._uU(3," View schema field "),e.YNc(4,Zt,1,1,"tui-data-list-wrapper",121),e.qZA(),e.TgZ(5,"tui-input",140),e._UZ(6,"input",141),e.TgZ(7,"p",127),e._uU(8,"Field label"),e.qZA()(),e.TgZ(9,"tui-select",142),e._uU(10," Specify data type "),e._UZ(11,"input",143),e.YNc(12,Dt,1,1,"tui-data-list-wrapper",121),e.qZA(),e.TgZ(13,"tui-checkbox-labeled",144),e._uU(14," Display in Grid? "),e.TgZ(15,"div",145),e._uU(16,"Specify whether this component should be displayed in the grid"),e.qZA()(),e.TgZ(17,"button",146),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.deleteViewSchema(l))}),e.qZA()(),e.BQk()}if(2&s){const t=i.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(3),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(1),e.Q6J("tuiTextfieldLabelOutside",!0)}}function Ot(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"h2",128),e._uU(1,"Modify Summary & View Schema"),e.qZA(),e.TgZ(2,"div",129)(3,"label",130),e._uU(4,"Summary Schema "),e.TgZ(5,"sup"),e._uU(6,"(Optional)"),e.qZA()(),e.TgZ(7,"tui-multi-select",131),e._uU(8," Summary schema fields "),e.YNc(9,Mt,1,1,"tui-data-list-wrapper",121),e.qZA(),e.TgZ(10,"p",132),e._uU(11,"Type the fieldname and press Enter to add. e.g. formKey.fieldValue"),e.qZA(),e.TgZ(12,"div",43),e.ynx(13,133),e.TgZ(14,"label",130),e._uU(15,"View Schema "),e.TgZ(16,"sup"),e._uU(17,"(Optional)"),e.qZA()(),e.YNc(18,kt,18,4,"ng-container",21),e.TgZ(19,"div",134)(20,"button",135),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addViewSchema())}),e.qZA()(),e.BQk(),e.qZA()(),e.TgZ(21,"div",136)(22,"button",137),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.setSummaryAndViewSchema())}),e._uU(23," Confirm "),e.qZA(),e.TgZ(24,"button",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.closeSchemaDialog())}),e._uU(25," Cancel "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.schemaForm),e.xp6(5),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(11),e.Q6J("ngForOf",t.viewSchema.controls)}}function Ut(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"p",147),e._uU(1,"Delete Form"),e.qZA(),e.TgZ(2,"p",148),e._uU(3,"Are you sure you want to delete this form?"),e.qZA(),e.TgZ(4,"div",149)(5,"button",150),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().deleteForm(),e.KtG(l.complete())}),e._uU(6," Confirm "),e.qZA(),e.TgZ(7,"button",123),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.KtG(l.complete())}),e._uU(8," Cancel "),e.qZA()()}}function Et(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"h2",128),e._uU(1,"Add default data"),e.qZA(),e.TgZ(2,"div",151)(3,"formio",152),e.NdJ("change",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onChangeForm(r))}),e.qZA()(),e.TgZ(4,"div",136)(5,"button",137),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.confirmDefaultSubmission())}),e._uU(6," Confirm "),e.qZA(),e.TgZ(7,"button",48),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.KtG(l.complete())}),e._uU(8," Cancel "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("options",t.options)("form",t.formForDefaultData)("submission",t.deafultFormSubmission[t.defaultFormIndex])}}const Nt=function(s){return{validation:"required",message:"App Title is required",control:s}},Ft=function(s){return{validation:"required",message:"App code is required",control:s}},Pt=function(s){return{validation:"maxlength",message:"App code should not exceed 7 characters",control:s}},Lt=function(s){return{validation:"required",message:"A Description is required",control:s}},Bt=function(s){return{validation:"required",message:"Company is required",control:s}};class Oe{constructor(i,t,o,r,l,g,ee,xe,re){this.fb=i,this.auth=t,this.transportService=o,this.router=r,this.dashboard=l,this.activatedRoute=g,this.notif=ee,this.dialogs=xe,this.media=re,this.formKeys=[],this.formComponents=[],this.activeIndex=0,this.language=new e.vpe,this.langItems=[{name:"en"},{name:"ar"}],this.languageForm=new c.cw({languages:new c.NI(this.langItems[0])}),this.conditions=["OR","AND","ANY"],this.formTabs=[],this.subModuleFormIoValue=new k.X({}),this.destroy$=new x.x,this.isCreatingSubModule=new x.x,this.isSavingAsDraft=new x.x,this.domainURL=window.location.origin,this.userListForEmail=[],this.search$=new x.x,this.saveDialogSubscription=[],this.schemaSubscription=[],this.limit=10,this.page=0,this.showError=new x.x,this.errorIndex=0,this.parentIDUnAssigned=!1,this.items=[{name:"anyCreate"},{name:"anyCreateAndModify"},{name:"disabled"}],this.selectItems=["Text","Number"],this.formKeysForViewSchema=[],this.summarySchemaFields=[],this.schemaForm=new c.cw({summarySchema:new c.NI([]),viewSchema:new c.Oe([new c.cw({fieldKey:new c.NI(""),displayAs:new c.NI(""),type:new c.NI(this.selectItems[0]),isDisplayedInGrid:new c.NI(!1)})])}),this.deafultFormSubmission=[],this.defaultFormSubscription=[],this.initSubModuleForm(),this.accessTypeValue=new c.NI(this.items[2]),this.submoduleFromLS=this.transportService.subModuleDraft.value,this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(P=>{Object.keys(P).length>0?(this.parentIDUnAssigned=!0,this.getDefaultWorkflowByModule(),this.getAllCategories(),this.categoryIdForMatch=P.parentID):this.getDefaultWorkflowBySubModule()}),this.formComponents=this.transportService.formBuilderData.value,this.formTabs=this.formComponents.map(P=>P.title),JSON.parse(JSON.stringify(this.formComponents))?.map(P=>{this.formKeys?.push({[P.key]:U.cQ.flattenComponents(P?.components,!0)})}),this.summarySchemaFields=this.formKeys.flatMap(P=>(0,E.oX)(P)),this.formKeysForViewSchema=this.summarySchemaFields,this.getAllCompanies(),this.search$.pipe((0,L.w)(P=>this.dashboard.getAllUsersForListing(this.limit,this.page,P)),(0,f.R)(this.destroy$)).subscribe(P=>{P&&(this.userListForEmail=P?.results?.map(_e=>_e?.email))}),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,f.R)(this.destroy$)).subscribe(P=>{P&&(this.userListForEmail=P?.results?.map(_e=>_e?.email))})}ngOnInit(){this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(i=>{if(0==Object.keys(i).length){const t=(0,d.rV)(d.MX.navHierarchy);t&&this.dashboard.previousRoute&&this.dashboard.previousRoute.includes("isParent"),t.forEach(o=>{o.routerLink=`/modules/${o.code}?moduleID=${(0,d.rV)(d.MX.moduleID)}`}),this.dashboard.items=[...t,{caption:"Add App",routerLink:`/modules/add-module/${(0,d.rV)(d.MX.moduleID)}`}]}})}checkIfLabelIsUnique(){return new Set(this.schemaForm.controls.viewSchema.value?.map(t=>t?.displayAs)).size===this.schemaForm.controls.viewSchema.value?.length}get viewSchema(){return this.schemaForm.controls.viewSchema}addViewSchema(){const i=this.fb.group({fieldKey:new c.NI(""),displayAs:new c.NI(""),type:new c.NI(this.selectItems[0]),isDisplayedInGrid:new c.NI(!1)});this.viewSchema.push(i)}deleteViewSchema(i){this.viewSchema.removeAt(i)}getDefaultWorkflowByModule(){this.activatedRoute.params.pipe((0,f.R)(this.destroy$)).subscribe(i=>{i.id&&(!1===this.parentIDUnAssigned&&(this.parentID=i.id),this.redirectToModuleID=i.id,this.transportService.moduleID.next(i.id),Object.keys(this.submoduleFromLS)?.length>0&&(this.initSubModuleForm(this.submoduleFromLS),this.base64File=this.submoduleFromLS?.image,this.file=this.submoduleFromLS?.file))})}getDefaultWorkflowBySubModule(){this.activatedRoute.params.pipe((0,f.R)(this.destroy$)).subscribe(i=>{i.id&&(!1===this.parentIDUnAssigned&&(this.parentID=i.id),this.redirectToModuleID=i.id,this.transportService.moduleID.next(i.id),this.dashboard.getWorkflowFromSubModule(i.id).pipe((0,f.R)(this.destroy$)).subscribe(t=>{t&&(this.categoryId=t?.categoryId,this.initSubModuleForm(t?.response)),Object.keys(this.submoduleFromLS)?.length>0&&(this.initSubModuleForm(this.submoduleFromLS),this.base64File=this.submoduleFromLS?.image,this.file=this.submoduleFromLS?.file)}))})}openEmailNotifyModal(i,t,o){this.activeEmailIndex=o,this.currentFieldArray=t,this.saveDialogSubscription.push(this.dialogs.open(i,{dismissible:!1,closeable:!1}).subscribe())}onSearchChange(i){this.search$.next(i)}validateEmails(){let i=this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.value;i=i.map(t=>!!/\S+@\S+\.\S+/.test(t)),i.includes(!1)?this.notif.displayNotification("Please provide valid email addresses","Email Notify","warning"):this.saveDialogSubscription.forEach(t=>t.unsubscribe())}cancelEmailNotify(){this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.setValue([]),this.saveDialogSubscription.forEach(i=>i.unsubscribe())}getAllCompanies(){this.dashboard.getAllCompanies(10,0).pipe((0,f.R)(this.destroy$)).subscribe(i=>{this.companyList=i.results?.map(t=>({value:t?.id,label:t?.title}))})}getAllCategories(){this.dashboard.getAllCategories(10).pipe((0,f.R)(this.destroy$)).subscribe(i=>{this.categoryList=i.results?.map(r=>({value:r?.id,label:r?.name}));let t=this.categoryList;t=t?.filter(r=>r?.value==this.categoryIdForMatch)[0],this.subModuleForm?.get("categoryName")?.value||this.subModuleForm?.get("categoryName")?.setValue(t?.value)})}initSubModuleForm(i){this.subModuleForm=this.fb.group({companies:this.fb.array([]),categories:this.fb.array([]),code:[i?.code||null,c.kI.compose([c.kI.required,c.kI.maxLength(7)])],companyName:[i?.companyName||null,c.kI.required],categoryName:[i?.categoryName||null,c.kI.required],adminUsers:[i?.adminUsers||[],c.kI.required],viewOnlyUsers:[i?.viewOnlyUsers||[],c.kI.required],title:[i?.title||null,c.kI.compose([c.kI.required]),[E.Iw.createValidator(this.dashboard)]],image:[i?.image||null,c.kI.required],description:[i?.description||null,c.kI.required],workflows:this.fb.array(i?.workflows?i?.workflows?.map(t=>this.fb.group({condition:[t.condition,c.kI.required],approverIds:[t.approverIds,c.kI.required],emailNotifyTo:[t.emailNotifyTo||[],c.kI.required]})):i?.map(t=>this.fb.group({condition:[t.condition,c.kI.required],approverIds:[t.approverIds,c.kI.required],emailNotifyTo:[t.emailNotifyTo||[],c.kI.required]}))||[this.fb.group({condition:[null,c.kI.required],approverIds:[[],c.kI.required],emailNotifyTo:[[],c.kI.required]})])})}onFileSelect(i){const t=i?.target?.files[0];if(1==(0,E.QG)(t)){this.file=t;const o=new FileReader;o.readAsDataURL(t),o.onload=r=>{this.base64File=o.result}}else this.notif.displayNotification("Allowed file types are JPG/PNG/WebP. File size cannot exceed 2MB","File Upload","warning")}get f(){return this.subModuleForm.controls}get companies(){return this.f.companies}addCompany(){const i=this.fb.group({title:["",c.kI.compose([c.kI.required,c.kI.maxLength(50)])]});this.companies.push(i)}getValidityForCompany(i){return this.companies.controls[i].invalid}getValidityForCategory(i){return this.categories.controls[i].invalid}removeCompany(i){this.companies.removeAt(i)}get categories(){return this.f.categories}addCategory(){const i=this.fb.group({name:["",c.kI.compose([c.kI.required,c.kI.maxLength(40)])]});this.categories.push(i)}removeCategory(i){this.categories.removeAt(i)}get workflows(){return this.f.workflows}addWorkflowStep(){const i=this.fb.group({condition:["",c.kI.required],approverIds:[[],c.kI.required],emailNotifyTo:[[],c.kI.required]});this.workflows.push(i)}removeWorkflowStep(i){this.workflows.removeAt(i)}getApproverList(i,t){this.workflows.at(t)?.get("approverIds")?.setValue(i)}submitNewCompany(){const i={title:this.f.companies?.value[0]?.title,groupCode:this.f.companies?.value[0]?.title.replace(/\s/g,"-")};this.dashboard.addCompany(i).pipe((0,f.R)(this.destroy$)).subscribe(t=>{t&&(this.companies.reset(),this.companies.removeAt(0),this.getAllCompanies())})}submitNewCategory(){this.dashboard.addCategory({name:this.f.categories?.value[0]?.name}).pipe((0,f.R)(this.destroy$)).subscribe(t=>{t&&(this.categories.reset(),this.categories.removeAt(0),this.getAllCategories())})}saveDraft(){this.transportService.isFormEdit.next(!1),this.transportService.saveDraftLocally({...this.subModuleForm.value,image:this.base64File,file:this.file});let i=this.workflows?.value?.flatMap(t=>t?.approverIds?.map(o=>({id:o.id,name:o.name})));if(0==i.length)return this.notif.displayNotification("Please create a default workflow before adding forms","Default Workflow","warning");(0,d.LS)(d.MX.approvers,i),this.categoryIdForMatch?this.router.navigate(["/forms/form-builder"],{queryParams:{isParent:!0}}):this.router.navigate(["/forms/form-builder"])}addDefaultData(i,t){this.formForDefaultData=this.formComponents[i],this.defaultFormIndex=i,this.defaultFormSubscription.push(this.dialogs.open(t,{dismissible:!1,closeable:!1,size:"page"}).subscribe())}onChangeForm(i){i?.data&&i?.changed&&(i?.data?.file&&i?.data?.file?.forEach(t=>{t.url=t?.data?.baseUrl.split("v1")[0]+t?.data?.fileUrl}),this.deafultFormSubmission[this.defaultFormIndex]={data:i?.data})}confirmDefaultSubmission(){this.formComponents[this.defaultFormIndex].defaultData=this.deafultFormSubmission[this.defaultFormIndex],this.defaultFormSubscription.forEach(i=>i.unsubscribe())}sendFormForEdit(i){this.transportService.isFormEdit.next(!0),this.transportService.sendFormDataForEdit.next(this.formComponents[i]),this.transportService.saveDraftLocally({...this.subModuleForm.value,image:this.base64File,file:this.file}),this.router.navigate(["/forms/form-builder"])}deleteFormDialog(i,t){this.delIndex=t,this.dialogs.open(i,{dismissible:!0,closeable:!0}).pipe((0,f.R)(this.destroy$)).subscribe()}deleteForm(){this.formComponents.splice(this.delIndex,1),this.formTabs.splice(this.delIndex,1)}changeLanguage(i){this.language.emit(i)}setSummaryAndViewSchema(){return 0==this.checkIfLabelIsUnique()?this.notif.displayNotification("Field labels must be unique","Schema Controls","warning"):this.schemaForm?.value?.viewSchema[0]?.displayAs?(this.schemaSubscription.forEach(i=>i.unsubscribe()),void console.log(this.schemaForm.value)):this.notif.displayNotification("Please provide all data","Form Schema","warning")}closeSchemaDialog(){this.schemaForm?.reset(),this.schemaSubscription.forEach(i=>i.unsubscribe())}saveSubModule(i){if(!i){if(0==this.dataSubmitValidation())return this.subModuleForm.markAllAsTouched(),this.notif.displayNotification("Please provide complete data for all fields","Create module","warning");if(this.workflows.controls.map(o=>o.get("approverIds")?.value.length>1&&o.get("condition")?.value).includes("none"))return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create module","warning")}let t={title:this.subModuleForm.get("title")?.value,description:this.subModuleForm.get("description")?.value,url:`/modules/module-details/${this.subModuleForm.get("title")?.value.replace(/\s/g,"-").toLowerCase()}`,companyId:this.subModuleForm.get("companyName")?.value,categoryId:this.subModuleForm.get("categoryName")?.value?this.subModuleForm.get("categoryName")?.value:this.categoryId,code:this.subModuleForm.get("code")?.value,adminUsers:this.subModuleForm.get("adminUsers")?.value?.map(o=>o?.id),viewOnlyUsers:this.subModuleForm.get("viewOnlyUsers")?.value?.map(o=>o?.id),formIds:this.formComponents,parentId:!0===this.parentIDUnAssigned?void 0:this.parentID,steps:this.workflows?.value?.map(o=>({approverIds:o?.approverIds?.map(r=>r.id?r.id:r),condition:o?.condition,emailNotifyTo:o?.emailNotifyTo||[]})),summarySchema:this.schemaForm.value?.summarySchema?.length>0?this.schemaForm.value?.summarySchema:void 0,viewSchema:this.schemaForm.value?.viewSchema[0]?.displayAs?this.schemaForm.value?.viewSchema:void 0,accessType:"disabled"!==this.accessTypeValue?.value?.name?this.accessTypeValue?.value?.name:void 0};i?this.isSavingAsDraft.next(!0):this.isCreatingSubModule.next(!0),this.file?this.media.uploadMedia(this.file).pipe((0,f.R)(this.destroy$)).subscribe(o=>{o.hasErrors()?(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1)):(t={...t,image:o?.data?.fileUrl},i&&Object.assign(t,{status:i}),this.dashboard.createSubModule(t).pipe((0,f.R)(this.destroy$)).subscribe(r=>{r?(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1),this.transportService.saveDraftLocally({}),this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.routeToBasedOnPreviousPage()):(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1))}))}):this.dashboard.createSubModule(t).pipe((0,f.R)(this.destroy$)).subscribe(o=>{o?(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1),this.transportService.saveDraftLocally({}),this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.routeToBasedOnPreviousPage()):(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1))})}routeToBasedOnPreviousPage(){this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(i=>{Object.keys(i).length>0?this.router.navigate(["/dashboard/home"]):this.router.navigate(["/modules",(0,d.rV)(d.MX.moduleSlug)||""],{queryParams:{moduleID:(0,d.rV)(d.MX.moduleID)||""}})})}cancelSubmodule(){this.routeToBasedOnPreviousPage()}dataSubmitValidation(){return!(this.f.companyName?.invalid||0==this.workflows?.length||this.workflows.controls.map(i=>0==i.get("approverIds")?.value.length).includes(!0)||!0===this.workflows.controls.map(i=>i.get("condition")?.value).includes(""))}validateSelection(i){return this.errorIndex=i,this.workflows.at(i)?.get("approverIds")?.value?.length<2?(this.workflows.at(i)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create module","info"),this.showError.next(!1)):this.workflows.at(i)?.get("approverIds")?.value?.length>=2&&"none"==this.workflows.at(i)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}countUsers(i,t){return this.errorIndex=t,i<2?(this.workflows.at(t)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info"),this.showError.next(!1)):i>=2&&"none"==this.workflows.at(t)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}setAdminUsers(i){this.subModuleForm?.get("adminUsers")?.setValue(i)}setViewUsers(i){this.subModuleForm?.get("viewOnlyUsers")?.setValue(i)}openSummarySchemaDialog(i){this.schemaSubscription.push(this.dialogs.open(i,{dismissible:!1,closeable:!1,size:"page"}).subscribe())}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}Oe.\u0275fac=function(i){return new(i||Oe)(e.Y36(c.qu),e.Y36(ne.e),e.Y36(ae.R),e.Y36(a.F0),e.Y36(q.s),e.Y36(a.gz),e.Y36(X.T),e.Y36(A.RO),e.Y36(M))},Oe.\u0275cmp=e.Xpm({type:Oe,selectors:[["ng-component"]],decls:115,vars:46,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52","pb-44"],[1,"text-xl","font-semibold","text-center"],[1,"text-lg","font-semibold","bg-[#EAE4D8]","px-2","py-2","rounded-md","mt-2"],[1,"block","pt-5",3,"formGroup"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-6","mt-3","mb-5"],[1,"block","pb-1"],[1,"text-xs","text-red-400"],["required","","formControlName","title","type","text",1,"form-control",3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["class","text-xs text-red-500",4,"ngIf"],["required","","formControlName","code","type","text",1,"form-control",3,"ngClass"],[1,"col-span-6","mt-3","mb-3"],["required","","formControlName","description","type","text","rows","6",1,"form-control",3,"ngClass"],["for","dropzone-file",1,"flex","flex-col","items-center","justify-center","w-full","h-[9.85rem]","border-2","border-gray-300","border-dashed","rounded-md","cursor-pointer","bg-gray-50","hover:bg-gray-100",3,"change"],[3,"inheritColor","size","showLoader","overlay"],["class","flex justify-center",4,"ngIf"],["class","flex justify-start",4,"ngIf"],["id","dropzone-file","type","file",1,"hidden"],[1,"my-7"],["required","","formControlName","companyName","type","text",1,"form-control",3,"ngClass"],[4,"ngFor","ngForOf"],[1,"my-2"],[1,"text-xs","text-gray-500"],["formArrayName","companies"],["tuiIconButton","","type","button","size","m","appearance","secondary","icon","tuiIconPlusLarge",3,"click"],[4,"ngIf"],[1,"grid","grid-cols-12","gap-3","my-8"],[1,"col-span-6"],[1,"block","pb-1","text-sm"],["formControlName","adminUsers",3,"approverList"],["formControlName","viewOnlyUsers",3,"approverList"],[1,"mt-12"],[1,"text-lg","font-semibold","bg-[#EAE4D8]","px-2","py-2","rounded-md","mb-3"],["formArrayName","workflows"],["tuiIconButton","","type","button","size","m","appearance","primary","icon","tuiIconPlusLarge",3,"click"],[1,"mb-5","mt-7"],[1,"flex","justify-between","bg-[#EAE4D8]","px-2","py-2","rounded-md","mb-3"],[1,"text-lg","font-semibold","mt-1.5"],["class","px-2.5 py-2 text-white bg-blue-500 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],[1,"mt-3","text-base","font-semibold","text-center"],[1,"flex","flex-col","w-full","px-5","mx-auto","mt-3","border","border-gray-400","border-dashed","rounded-md","bg-gray-50"],[1,"w-full","mx-auto","my-1"],[1,"mt-7"],[1,"px-5","py-3","rounded-lg","bg-[#a58f81]","no-underline","text-white","cursor-pointer","hover:text-white",3,"click"],[1,"flex","justify-center","gap-2","mt-10"],["tuiButton","","type","button","size","m","appearance","primary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","secondary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],["formError",""],["template",""],["hint",""],["summarySchemaTemplate",""],["deltemplate",""],["defaultForm",""],[1,"text-xs","text-red-500"],[1,"flex","justify-center"],["alt","app_icon","width","100","height","130",1,"rounded-md",3,"src"],[1,"flex","justify-start"],[1,"mx-8","mt-1"],["src","../../../../../assets/windows.svg","width","32","height","32"],[1,"text-sm","text-gray-400","list-disc"],[3,"value"],[1,"w-7/12","px-8",3,"formGroupName"],[1,"flex","items-center","justify-between","w-full","gap-2","mb-3"],[1,"w-full"],["class","block pb-2 text-xs font-semibold",4,"ngIf"],["formControlName","title","type","text",1,"form-control",3,"ngClass"],[3,"ngClass"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2Large",3,"click"],[1,"flex","justify-end"],["tuiButton","","type","button","class","mb-3","size","m",3,"click",4,"ngIf"],[1,"block","pb-2","text-xs","font-semibold"],["tuiButton","","type","button","size","m",1,"mb-3",3,"click"],["required","","formControlName","categoryName","type","text",1,"form-control",3,"ngClass"],["formArrayName","categories"],["formControlName","name","type","text",1,"form-control",3,"ngClass"],[1,"text-base","font-semibold","mt-7"],[1,"grid","grid-cols-12","gap-3","my-4",3,"formGroupName"],[1,"col-span-3"],["formControlName","approverIds",3,"checkUsersLength","approverList"],["for","conditionSelect",1,"block","pb-1"],["formControlName","condition","aria-label","Default select example","id","conditionSelect",1,"h-10","mt-2","form-select","form-control",3,"change"],["value","or"],["value","none"],[1,"inline-flex","col-span-1","mt-8"],["direction","right",1,"mt-1","mr-4","-ml-2",3,"content"],[3,"contentTop","colorTop"],["tuiIconButton","","type","button","size","s","appearance","outline","icon","tuiIconMailLarge",3,"click"],[1,"col-span-4"],[1,"flex","justify-between","mt-8"],[1,"tui-space_bottom-3",3,"formControl","item"],[1,"mt-1","text-xxs","font-extralight"],[1,"col-span-1","mt-8"],["value","and"],[1,"col-span-1","mt-8","-ml-4"],[1,"px-2.5","py-2","text-white","bg-blue-500","rounded-md","cursor-pointer","hover:text-white",3,"click"],[1,"relative","flex","justify-between","my-8"],["tuiTabs","","vertical","left",1,"w-32","mr-5"],["tuiTab","",3,"click"],["class","w-full well jsonviewer",4,"ngIf"],[1,"w-full","well","jsonviewer"],[1,"absolute","z-10","flex","justify-end","-top-7","right-1","gap-x-2"],["title","Add default data",1,"rounded-md","cursor-pointer","mt-[0.5px]",3,"click"],["aria-hidden","true",1,"text-green-500","hover:text-green-600","fa","fa-table","fa-2x"],["title","Edit Form",1,"rounded-md","cursor-pointer",3,"click"],["aria-hidden","true",1,"text-blue-500","hover:text-blue-600","fa","fa-pencil-square","fa-2x"],[1,"rounded-md","cursor-pointer",3,"click"],["aria-hidden","true",1,"text-red-500","fa","fa-trash","fa-2x","hover:text-red-600"],[3,"language","options","form","submission"],[1,"grid","grid-cols-12","gap-2"],["data-placeholder","",1,"h-8","col-span-12","my-3","overflow-hidden","bg-gray-200","rounded-md"],[1,"grid","grid-cols-12","col-span-12","gap-2"],["data-placeholder","",1,"col-span-6","mb-3","overflow-hidden","bg-gray-200","rounded-md","h-28"],["data-placeholder","",1,"h-8","col-span-6","my-3","overflow-hidden","bg-gray-200","rounded-md"],[1,"w-full","mt-1","text-left","fv-plugins-message-container","text-xxs","2xl:text-xs"],["role","alert",1,"text-red-400","fv-help-block","text-xxs","2xl:text-xs","2xl:mb-2"],[1,"text-lg","font-semibold","text-center"],[1,"mt-3","text-base","font-medium","text-gray-500"],[1,"flex","flex-col","justify-center","my-5"],[1,"b-form",3,"formControl","tuiTextfieldLabelOutside","searchChange"],[3,"items",4,"tuiDataList"],[1,"flex","justify-start","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["appearance","accent","tuiButton","","type","button","size","m",3,"click"],[3,"items"],[1,"text-base"],[1,"mt-2"],[1,"mt-8","text-lg","font-semibold","text-center"],[1,"w-[80%]","mx-auto","my-8",3,"formGroup"],[1,"mb-2","font-medium"],["formControlName","summarySchema",3,"tuiTextfieldLabelOutside"],[1,"mt-1","text-xxs"],["formArrayName","viewSchema"],[1,"flex","justify-end","my-2"],["tuiIconButton","","type","button","size","s","appearance","primary","icon","tuiIconPlus",3,"click"],[1,"flex","justify-center","gap-2"],["tuiButton","","type","button","size","m","appearance","primary",3,"click"],[1,"grid","grid-cols-12","gap-2","mb-3",3,"formGroupName"],["formControlName","fieldKey",1,"col-span-3",3,"tuiTextfieldLabelOutside"],["formControlName","displayAs",1,"col-span-3",3,"tuiTextfieldLabelOutside"],["tuiTextfield","","type","text",3,"tuiTextfieldLabelOutside"],["formControlName","type",1,"col-span-3"],["placeholder","Specify data type","tuiTextfield",""],["formControlName","isDisplayedInGrid",1,"col-span-2","mt-3"],[1,"text-gray-400","text-xxs"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2",1,"col-span-1","mt-2",3,"click"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"],[1,"w-[90%]","mx-auto"],[3,"options","form","submission","change"]],template:function(i,t){if(1&i&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0)(2,"section")(3,"h3",1),e._uU(4,"Create a new app"),e.qZA(),e.TgZ(5,"h4",2),e._uU(6,"App Details"),e.qZA()(),e.TgZ(7,"form",3)(8,"div",4)(9,"div",5)(10,"label",6),e._uU(11,"App Title "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e._UZ(14,"input",8),e.GkF(15,9),e.YNc(16,ze,2,0,"span",10),e.qZA(),e.TgZ(17,"div",5)(18,"label",6),e._uU(19,"App Code "),e.TgZ(20,"span",7),e._uU(21,"*"),e.qZA()(),e._UZ(22,"input",11),e.GkF(23,9)(24,9),e.qZA()(),e.TgZ(25,"div",4)(26,"div",12)(27,"label",6),e._uU(28,"App Description"),e.TgZ(29,"span",7),e._uU(30,"*"),e.qZA()(),e._UZ(31,"textarea",13),e.GkF(32,9),e.qZA(),e.TgZ(33,"div",12)(34,"label",6),e._uU(35,"App Icon"),e.TgZ(36,"span",7),e._uU(37,"*"),e.qZA()(),e.TgZ(38,"label",14),e.NdJ("change",function(r){return t.onFileSelect(r)}),e.TgZ(39,"tui-loader",15),e.YNc(40,We,2,1,"div",16),e.YNc(41,je,8,0,"div",17),e.qZA(),e._UZ(42,"input",18),e.qZA()()(),e.TgZ(43,"div",19)(44,"label",6),e._uU(45,"Company Name "),e.TgZ(46,"span",7),e._uU(47,"*"),e.qZA()(),e.TgZ(48,"select",20),e.YNc(49,Xe,3,2,"ng-container",21),e.qZA(),e.GkF(50,9),e.qZA(),e.TgZ(51,"div",22)(52,"p",23),e._uU(53,"If your company isn't listed, you can add it below"),e.qZA()(),e.ynx(54,24),e.YNc(55,it,11,6,"ng-container",21),e.BQk(),e.TgZ(56,"button",25),e.NdJ("click",function(){return t.addCompany()}),e.qZA(),e.YNc(57,ct,15,7,"ng-container",26),e.TgZ(58,"div",27)(59,"div",28)(60,"label",29),e._uU(61,"Admin users "),e.TgZ(62,"sup"),e._uU(63,"(optional)"),e.qZA()(),e.TgZ(64,"custom-multi-select",30),e.NdJ("approverList",function(r){return t.setAdminUsers(r)}),e.qZA()(),e.TgZ(65,"div",28)(66,"label",29),e._uU(67,"View Only users "),e.TgZ(68,"sup"),e._uU(69,"(optional)"),e.qZA()(),e.TgZ(70,"custom-multi-select",31),e.NdJ("approverList",function(r){return t.setViewUsers(r)}),e.qZA()()(),e.TgZ(71,"div",32)(72,"h4",33),e._uU(73,"Create Workflow"),e.qZA(),e.ynx(74,34),e.YNc(75,ft,6,4,"ng-container",21),e.BQk(),e.TgZ(76,"button",35),e.NdJ("click",function(){return t.addWorkflowStep()}),e.qZA()(),e.TgZ(77,"div",36)(78,"div",37)(79,"h4",38),e._uU(80,"Create Form/s"),e.qZA(),e.YNc(81,ht,2,0,"a",39),e.qZA(),e.TgZ(82,"h4",40),e._uU(83,"Form/s Preview"),e.qZA(),e.TgZ(84,"div",41),e.YNc(85,xt,5,2,"ng-container",26),e.YNc(86,Tt,9,0,"ng-container",26),e.qZA(),e.TgZ(87,"div",42)(88,"p",23),e._uU(89,"The form/s you add will appear here"),e.qZA()()(),e.TgZ(90,"div",43)(91,"a",44),e.NdJ("click",function(){return t.saveDraft()}),e._uU(92),e.qZA()(),e.TgZ(93,"div",45)(94,"button",46),e.NdJ("click",function(){return t.saveSubModule()}),e.ALo(95,"async"),e._uU(96," Publish "),e.qZA(),e.TgZ(97,"button",47),e.NdJ("click",function(){return t.saveSubModule(3)}),e.ALo(98,"async"),e._uU(99," Save as Draft "),e.qZA(),e.TgZ(100,"button",48),e.NdJ("click",function(){return t.cancelSubmodule()}),e._uU(101,"Cancel"),e.qZA()()()(),e._UZ(102,"app-footer"),e.YNc(103,wt,1,1,"ng-template",null,49,e.W1O),e.YNc(105,At,13,2,"ng-template",null,50,e.W1O),e.YNc(107,It,16,0,"ng-template",null,51,e.W1O),e.YNc(109,Ot,26,3,"ng-template",null,52,e.W1O),e.YNc(111,Ut,9,0,"ng-template",null,53,e.W1O),e.YNc(113,Et,9,3,"ng-template",null,54,e.W1O)),2&i){const o=e.MAs(104);e.xp6(7),e.Q6J("formGroup",t.subModuleForm),e.xp6(7),e.Q6J("ngClass",null!=t.f.title&&t.f.title.invalid&&null!=t.f.title&&t.f.title.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(36,Nt,t.f.title)),e.xp6(1),e.Q6J("ngIf",null==t.f.title?null:t.f.title.hasError("codeExists")),e.xp6(6),e.Q6J("ngClass",null!=t.f.code&&t.f.code.invalid&&null!=t.f.code&&t.f.code.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(38,Ft,t.f.code)),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(40,Pt,t.f.code)),e.xp6(7),e.Q6J("ngClass",null!=t.f.description&&t.f.description.invalid&&null!=t.f.description&&t.f.description.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(42,Lt,t.f.description)),e.xp6(7),e.Q6J("inheritColor",!0)("size","l")("showLoader",!1)("overlay",!0),e.xp6(1),e.Q6J("ngIf",t.file),e.xp6(1),e.Q6J("ngIf",!t.file),e.xp6(7),e.Q6J("ngClass",null!=t.f.companyName&&t.f.companyName.invalid&&null!=t.f.companyName&&t.f.companyName.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngForOf",t.companyList),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(44,Bt,t.f.companyName)),e.xp6(5),e.Q6J("ngForOf",t.companies.controls),e.xp6(2),e.Q6J("ngIf",1==t.parentIDUnAssigned),e.xp6(18),e.Q6J("ngForOf",t.workflows.controls),e.xp6(6),e.Q6J("ngIf",(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)>0),e.xp6(4),e.Q6J("ngIf",(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)>0),e.xp6(1),e.Q6J("ngIf",0==(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)||0==(null==t.formComponents?null:t.formComponents.length)),e.xp6(6),e.hij(" ","Add form"," "),e.xp6(2),e.Q6J("showLoader",1==e.lcZ(95,32,t.isCreatingSubModule)),e.xp6(3),e.Q6J("showLoader",1==e.lcZ(98,34,t.isSavingAsDraft))}},dependencies:[n.mk,n.sg,n.O5,n.tP,$.G,de.c,ue.K3,ue.wU,se.MB,he.xT,N.eC,ye.gX,R.VT,C.uJ,C.OI,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.oH,c.sg,c.u,c.x0,c.CE,be.v0,ke.k4,m,Fe.e,p.p_,p.uW,p.yu,h.V,Q.PZ,we.w,De.kM,ie.p,n.Ov]});var Jt=u(68538),Qt=u(94051);function Rt(s,i){if(1&s&&(e.TgZ(0,"div",52),e._UZ(1,"img",53),e.qZA()),2&s){const t=e.oxw();e.xp6(1),e.Q6J("src",t.base64File,e.LSH)}}function Vt(s,i){1&s&&(e.TgZ(0,"div",54)(1,"div",55),e._UZ(2,"img",56),e.qZA(),e.TgZ(3,"ul",57)(4,"li"),e._uU(5,"Only (JPEG, PNG, WEBP) extensions are allowed"),e.qZA(),e.TgZ(6,"li"),e._uU(7,"Up to 2MB file size is allowed"),e.qZA()()())}function qt(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"option",58),e._uU(2),e.qZA(),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.value),e.xp6(1),e.Oqu(null==t?null:t.label)}}function Kt(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"option",58),e._uU(2),e.qZA(),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("value",null==t?null:t.value),e.xp6(1),e.Oqu(null==t?null:t.label)}}function Gt(s,i){1&s&&(e.TgZ(0,"span",78),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function Yt(s,i){1&s&&(e.ynx(0),e.TgZ(1,"option",79),e._uU(2,"AND"),e.qZA(),e.BQk())}function $t(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",61)(2,"label",6),e._uU(3),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"custom-multi-select",62),e.NdJ("checkUsersLength",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.countUsers(r,l))})("approverList",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.getApproverList(r,l))}),e.qZA(),e.YNc(7,Gt,2,0,"span",63),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"div",61)(10,"label",64),e._uU(11,"Condition "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"select",65),e.NdJ("change",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.validateSelection(r))}),e.YNc(15,Yt,3,0,"ng-container",37),e.TgZ(16,"option",66),e._uU(17,"OR"),e.qZA(),e.TgZ(18,"option",67),e._uU(19,"NONE"),e.qZA()()(),e.TgZ(20,"div",68),e._UZ(21,"tui-tooltip",69),e.TgZ(22,"tui-badged-content",70)(23,"button",71),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(),g=e.MAs(106);return e.KtG(l.openEmailNotifyModal(g,l.workflows,r))}),e.qZA()()(),e.TgZ(24,"div",72)(25,"div",73)(26,"tui-radio-labeled",74)(27,"div"),e._uU(28,"Any (Create)"),e.qZA(),e.TgZ(29,"div",75),e._uU(30,"Any user can create a new submission"),e.qZA()(),e.TgZ(31,"tui-radio-labeled",74)(32,"div"),e._uU(33,"Any (Create & Modify)"),e.qZA(),e.TgZ(34,"div",75),e._uU(35,"Any user can create a new submission and modify it's workflow"),e.qZA()(),e.TgZ(36,"tui-radio-labeled",74)(37,"div"),e._uU(38,"Disabled"),e.qZA(),e.TgZ(39,"div",75),e._uU(40,"Only Admin users can create and modify submissions"),e.qZA()()()(),e.TgZ(41,"div",76)(42,"button",77),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.removeWorkflowStep(r))}),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw(),o=t.first,r=t.index,l=e.oxw(),g=e.MAs(108);let ee;e.xp6(3),e.hij("",o?"Creators":"Approvers"," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(8,12,l.showError)&&r===l.errorIndex),e.xp6(8),e.Q6J("ngIf",r>0),e.xp6(6),e.Q6J("content",g),e.xp6(1),e.Q6J("contentTop",null==(ee=l.workflows.at(r).get("emailNotifyTo"))||null==ee.value?null:ee.value.length)("colorTop","green"),e.xp6(4),e.Q6J("formControl",l.accessTypeValue)("item",l.items[0]),e.xp6(5),e.Q6J("formControl",l.accessTypeValue)("item",l.items[1]),e.xp6(5),e.Q6J("formControl",l.accessTypeValue)("item",l.items[2])}}function Ht(s,i){1&s&&(e.TgZ(0,"span",78),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function zt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",72)(2,"label",6),e._uU(3,"Approvers "),e.TgZ(4,"span",7),e._uU(5,"*"),e.qZA()(),e.TgZ(6,"custom-multi-select",62),e.NdJ("checkUsersLength",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.countUsers(r,l))})("approverList",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.getApproverList(r,l))}),e.qZA(),e.YNc(7,Ht,2,0,"span",63),e.ALo(8,"async"),e.qZA(),e.TgZ(9,"div",72)(10,"label",64),e._uU(11,"Condition "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e.TgZ(14,"select",65),e.NdJ("change",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.validateSelection(r))}),e.TgZ(15,"option",79),e._uU(16,"AND"),e.qZA(),e.TgZ(17,"option",66),e._uU(18,"OR"),e.qZA(),e.TgZ(19,"option",67),e._uU(20,"NONE"),e.qZA()()(),e.TgZ(21,"div",68),e._UZ(22,"tui-tooltip",69),e.TgZ(23,"tui-badged-content",70)(24,"button",71),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(),g=e.MAs(106);return e.KtG(l.openEmailNotifyModal(g,l.workflows,r))}),e.qZA()()(),e.TgZ(25,"div",80)(26,"button",77),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.removeWorkflowStep(r))}),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw().index,o=e.oxw(),r=e.MAs(108);let l;e.xp6(7),e.Q6J("ngIf",e.lcZ(8,4,o.showError)&&t===o.errorIndex),e.xp6(15),e.Q6J("content",r),e.xp6(1),e.Q6J("contentTop",null==(l=o.workflows.at(t).get("emailNotifyTo"))||null==l.value?null:l.value.length)("colorTop","green")}}function Wt(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"p",59),e._uU(2),e.qZA(),e.TgZ(3,"div",60),e.YNc(4,$t,43,14,"ng-container",37),e.YNc(5,zt,27,6,"ng-container",37),e.qZA(),e.BQk()),2&s){const t=i.index;e.xp6(2),e.hij("Step ",0===t?"1":t+1,""),e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("ngIf",0==t),e.xp6(1),e.Q6J("ngIf",t>0)}}function jt(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",81),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=e.MAs(110);return e.KtG(r.openSummarySchemaDialog(l))}),e._uU(1," Summary & View Schema "),e.qZA()}}function Xt(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",84),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.activeIndex=l)}),e._uU(2),e.qZA(),e.BQk()}if(2&s){const t=i.$implicit;e.xp6(2),e.Oqu(t)}}function en(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",86)(1,"div",87)(2,"div",88)(3,"a",89),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().index,l=e.oxw(2),g=e.MAs(114);return e.KtG(l.addDefaultData(r,g))}),e._UZ(4,"i",90),e.qZA(),e.TgZ(5,"a",91),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=r.index,g=r.$implicit,ee=e.oxw(2);return e.KtG(ee.sendFormForEdit(l,null==g?null:g.id,null==g?null:g.key))}),e._UZ(6,"i",92),e.qZA(),e.TgZ(7,"a",93),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,l=e.oxw(2),g=e.MAs(112);return e.KtG(l.deleteFormDialog(g,null==r?null:r.id))}),e._UZ(8,"i",94),e.qZA()()(),e._UZ(9,"formio",95),e.qZA()}if(2&s){const t=e.oxw(),o=t.$implicit,r=t.index,l=e.oxw(2);e.xp6(9),e.Q6J("language",l.language)("options",l.options)("form",o)("submission",l.deafultFormSubmission[r]||(null==o?null:o.defaultData))}}function tn(s,i){if(1&s&&(e.ynx(0),e.YNc(1,en,10,4,"div",85),e.BQk()),2&s){const t=i.index,o=e.oxw(2);e.xp6(1),e.Q6J("ngIf",o.activeIndex==t)}}function nn(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"section",82)(2,"nav",83),e.YNc(3,Xt,3,1,"ng-container",20),e.qZA(),e.YNc(4,tn,2,1,"ng-container",20),e.qZA(),e.BQk()),2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.formTabs),e.xp6(1),e.Q6J("ngForOf",t.formComponents)}}function on(s,i){1&s&&(e.ynx(0),e.TgZ(1,"div",96),e._UZ(2,"div",97),e.TgZ(3,"div",98),e._UZ(4,"div",99)(5,"div",99),e.qZA(),e.TgZ(6,"div",98),e._UZ(7,"div",100)(8,"div",100),e.qZA()(),e.BQk())}function sn(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"div",101)(2,"span",102),e._uU(3),e.qZA()(),e.BQk()),2&s){const t=e.oxw().message;e.xp6(3),e.hij(" ",t," ")}}function rn(s,i){if(1&s&&e.YNc(0,sn,4,1,"ng-container",37),2&s){const t=i.control;e.Q6J("ngIf",t.hasError(i.validation)&&(t.dirty||t.touched))}}function an(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",111),2&s){const t=e.oxw(2);e.Q6J("items",t.userListForEmail)}}function ln(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"p",103),e._uU(1,"Email Notification Users"),e.qZA(),e.TgZ(2,"p",104),e._uU(3," Please specify the users you want to send the notification email to "),e.qZA(),e.TgZ(4,"div",105)(5,"tui-input-tag",106),e.NdJ("searchChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onSearchChange(r))}),e._uU(6," Type to search and press Enter to select... "),e.YNc(7,an,1,1,"tui-data-list-wrapper",107),e.qZA()(),e.TgZ(8,"div",108)(9,"button",109),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.validateEmails())}),e._uU(10," Confirm & Close "),e.qZA(),e.TgZ(11,"button",110),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancelEmailNotify())}),e._uU(12," Remove Users & Close "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(5),e.Q6J("formControl",null==t.currentFieldArray||null==t.currentFieldArray.controls[t.activeEmailIndex]?null:t.currentFieldArray.controls[t.activeEmailIndex].controls.emailNotifyTo)("tuiTextfieldLabelOutside",!0)}}function un(s,i){1&s&&(e.TgZ(0,"strong",112),e._uU(1,"How conditions work?"),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"ul",113)(4,"li")(5,"strong"),e._uU(6,"AND"),e.qZA(),e._uU(7," implies that every user of the step must provide approval"),e.qZA(),e.TgZ(8,"li",114)(9,"strong"),e._uU(10,"OR"),e.qZA(),e._uU(11," implies that any one of the users may provide approval"),e.qZA(),e.TgZ(12,"li")(13,"strong"),e._uU(14,"NONE"),e.qZA(),e._uU(15," implies that there is only one user per step and hence no conditon is necessary"),e.qZA()())}function cn(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",111),2&s){const t=e.oxw(2);e.Q6J("items",t.summarySchemaFields)}}function dn(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",111),2&s){const t=e.oxw(3);e.Q6J("items",t.formKeysForViewSchema)}}function mn(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",111),2&s){const t=e.oxw(3);e.Q6J("items",t.selectItems)}}function pn(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",125)(2,"tui-select",126),e._uU(3," View schema field "),e.YNc(4,dn,1,1,"tui-data-list-wrapper",107),e.qZA(),e.TgZ(5,"tui-input",127),e._UZ(6,"input",128),e.TgZ(7,"p",113),e._uU(8,"Field label"),e.qZA()(),e.TgZ(9,"tui-select",129),e._uU(10," Specify data type "),e._UZ(11,"input",130),e.YNc(12,mn,1,1,"tui-data-list-wrapper",107),e.qZA(),e.TgZ(13,"tui-checkbox-labeled",131),e._uU(14," Display in Grid? "),e.TgZ(15,"div",132),e._uU(16,"Specify whether this component should be displayed in the grid"),e.qZA()(),e.TgZ(17,"button",133),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.deleteViewSchema(l))}),e.qZA()(),e.BQk()}if(2&s){const t=i.index;e.xp6(1),e.Q6J("formGroupName",t),e.xp6(1),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(3),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(1),e.Q6J("tuiTextfieldLabelOutside",!0)}}function _n(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"h2",115),e._uU(1,"Modify Summary & View Schema"),e.qZA(),e.TgZ(2,"div",116)(3,"label",117),e._uU(4,"Summary Schema "),e.TgZ(5,"sup"),e._uU(6,"(Optional)"),e.qZA()(),e.TgZ(7,"tui-multi-select",118),e._uU(8," Summary schema fields "),e.YNc(9,cn,1,1,"tui-data-list-wrapper",107),e.qZA(),e.TgZ(10,"p",119),e._uU(11,"Type the fieldname and press Enter to add. e.g. formKey.fieldValue"),e.qZA(),e.TgZ(12,"div",40),e.ynx(13,120),e.TgZ(14,"label",117),e._uU(15,"View Schema "),e.TgZ(16,"sup"),e._uU(17,"(Optional)"),e.qZA()(),e.YNc(18,pn,18,4,"ng-container",20),e.TgZ(19,"div",121)(20,"button",122),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addViewSchema())}),e.qZA()(),e.BQk(),e.qZA()(),e.TgZ(21,"div",123)(22,"button",124),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.setSummaryAndViewSchema())}),e._uU(23," Confirm "),e.qZA(),e.TgZ(24,"button",45),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.closeSchemaDialog())}),e._uU(25," Cancel "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(2),e.Q6J("formGroup",t.schemaForm),e.xp6(5),e.Q6J("tuiTextfieldLabelOutside",!0),e.xp6(11),e.Q6J("ngForOf",t.viewSchema.controls)}}function gn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"p",134),e._uU(1,"Delete Form"),e.qZA(),e.TgZ(2,"p",135),e._uU(3,"Are you sure you want to delete this form?"),e.qZA(),e.TgZ(4,"div",136)(5,"button",137),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.oxw().deleteForm(),e.KtG(l.complete())}),e._uU(6," Confirm "),e.qZA(),e.TgZ(7,"button",109),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.KtG(l.complete())}),e._uU(8," Cancel "),e.qZA()()}}function fn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"h2",115),e._uU(1,"Add default data"),e.qZA(),e.TgZ(2,"div",138)(3,"formio",139),e.NdJ("change",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onChangeForm(r))}),e.qZA()(),e.TgZ(4,"div",123)(5,"button",124),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.confirmDefaultSubmission())}),e._uU(6," Confirm "),e.qZA(),e.TgZ(7,"button",45),e.NdJ("click",function(){const l=e.CHM(t).$implicit;return e.KtG(l.complete())}),e._uU(8," Cancel "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(3),e.Q6J("options",t.options)("form",t.formForDefaultData)("submission",t.deafultFormSubmission[t.defaultFormIndex])}}const hn=function(s){return{validation:"required",message:"App Title is required",control:s}},bn=function(s){return{validation:"required",message:"App code is required",control:s}},vn=function(s){return{validation:"maxlength",message:"App code should not exceed 7 characters",control:s}},yn=function(s){return{validation:"required",message:"A Description is required",control:s}},xn=function(s){return{validation:"required",message:"Company is required",control:s}},Tn=function(s){return{validation:"required",message:"Category is required",control:s}};class Ue{constructor(i,t,o,r,l,g,ee,xe,re,V){this.fb=i,this.auth=t,this.transportService=o,this.router=r,this.dashboard=l,this.activatedRoute=g,this.notif=ee,this.formService=xe,this.dialogs=re,this.media=V,this.formComponents=[],this.activeIndex=0,this.language=new e.vpe,this.langItems=[{name:"en"},{name:"ar"}],this.languageForm=new c.cw({languages:new c.NI(this.langItems[0])}),this.conditions=["OR","AND","ANY"],this.formTabs=[],this.subModuleFormIoValue=new k.X({}),this.destroy$=new x.x,this.isCreatingSubModule=new x.x,this.isSavingAsDraft=new x.x,this.domainUrl=window.location.origin,this.userListForEmail=[],this.search$=new x.x,this.saveDialogSubscription=[],this.limit=10,this.page=0,this.showError=new x.x,this.errorIndex=0,this.items=[{name:"anyCreate"},{name:"anyCreateAndModify"},{name:"disabled"}],this.formKeysForViewSchema=[],this.summarySchemaFields=[],this.formKeys=[],this.formKeysFinal=[],this.schemaSubscription=[],this.defaultFormSubscription=[],this.selectItems=["Text","Number","Date"],this.schemaForm=new c.cw({summarySchema:new c.NI([]),viewSchema:new c.Oe([new c.cw({fieldKey:new c.NI,displayAs:new c.NI(""),type:new c.NI(this.selectItems[0]),isDisplayedInGrid:new c.NI(!1)})])}),this.deafultFormSubmission=[],this.initSubModuleForm(),this.accessTypeValue=new c.NI(null),this.submoduleFromLS=this.transportService.subModuleDraft.value,this.getAllCompanies(),this.getAllCategories(),this.getSubmoduleByIDForEdit(),this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(P=>{P.moduleID&&P.moduleCode&&(this.transportService.moduleID.next(P.moduleID),this.transportService.moduleCode.next(P.moduleCode))}),this.search$.pipe((0,L.w)(P=>this.dashboard.getAllUsersForListing(this.limit,this.page,P))).subscribe(P=>{P&&(this.userListForEmail=P?.results?.map(_e=>_e?.email))}),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,f.R)(this.destroy$)).subscribe(P=>{P&&(this.userListForEmail=P?.results?.map(_e=>_e?.email))})}ngOnInit(){this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(i=>{if(0==Object.keys(i).length){const t=(0,d.rV)(d.MX.navHierarchy)||[];t.forEach(o=>{o.routerLink=`/modules/${o.code}?moduleID=${(0,d.rV)(d.MX.moduleID)}`}),this.dashboard.items=(0,E.vB)([...t,{caption:(0,d.rV)(d.MX.editmoduleTitle)||(0,d.rV)(d.MX.moduleSlug),routerLink:`/modules/edit-module/${(0,d.rV)(d.MX.editmoduleId)||(0,d.rV)(d.MX.moduleID)}`}],"caption")}else this.router.url.includes("moduleCode")||((0,d.rV)(d.MX.navHierarchy)||[]).forEach(o=>{o.routerLink=`/modules/${o.code}?moduleID=${(0,d.rV)(d.MX.moduleID)}`}),this.dashboard.items=(0,E.vB)([{caption:(0,d.rV)(d.MX.editmoduleTitle)||(0,d.rV)(d.MX.moduleSlug),routerLink:`/modules/edit-module/${(0,d.rV)(d.MX.editmoduleId)||(0,d.rV)(d.MX.moduleID)}?moduleCode=${(0,d.rV)(d.MX.moduleSlug)}`}],"caption")})}get viewSchema(){return this.schemaForm.controls.viewSchema}addViewSchema(){const i=this.fb.group({fieldKey:new c.NI(""),displayAs:new c.NI(""),type:new c.NI(this.selectItems[0]),isDisplayedInGrid:new c.NI(!1)});this.viewSchema.push(i)}deleteViewSchema(i){this.viewSchema.removeAt(i)}onFileSelect(i){const t=i?.target?.files[0];1==(0,E.QG)(t)?(0,E.sl)(t).then(o=>{if(0==o)this.notif.displayNotification("Image should be of 1:1 aspect ratio","File Upload","warning");else{this.file=t;const r=new FileReader;r.readAsDataURL(t),r.onload=l=>{this.base64File=r.result}}}):this.notif.displayNotification("Allowed file types are JPG/PNG/WebP. File size cannot exceed 2MB","File Upload","warning")}openEmailNotifyModal(i,t,o){this.activeEmailIndex=o,this.currentFieldArray=t,this.saveDialogSubscription.push(this.dialogs.open(i,{dismissible:!1,closeable:!1}).subscribe())}onSearchChange(i){this.search$.next(i)}validateEmails(){let i=this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.value;i=i.map(t=>!!/\S+@\S+\.\S+/.test(t)),i.includes(!1)?this.notif.displayNotification("Please provide valid email addresses","Email Notify","warning"):this.saveDialogSubscription.forEach(t=>t.unsubscribe())}cancelEmailNotify(){this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.setValue([]),this.saveDialogSubscription.forEach(i=>i.unsubscribe())}getSubmoduleByIDForEdit(){this.activatedRoute.params.pipe((0,f.R)(this.destroy$)).subscribe(i=>{i.id&&(this.transportService.subModuleID.next(i.id),this.dashboard.getSubModuleByID(i.id).subscribe(t=>{if(t)if(this.workFlowId=t?.workFlowId?.id,this.categoryId=t?.categoryId?.id,this.schemaForm.controls.summarySchema?.setValue(t?.summarySchema),t.viewSchema?.length>0&&this.schemaForm.controls.viewSchema.removeAt(0),t.viewSchema?.map(o=>{const r=this.fb.group({fieldKey:new c.NI(o?.fieldKey),displayAs:new c.NI(o?.displayAs),type:new c.NI(o?.type),isDisplayedInGrid:new c.NI(o?.isDisplayedInGrid)});this.schemaForm.controls.viewSchema.push(r)}),this.items?.forEach((o,r)=>{o?.name==t?.accessType&&this.accessTypeValue?.setValue(this.items[r])}),Object.keys(this.submoduleFromLS)?.length>0){this.initSubModuleForm(this.submoduleFromLS),this.base64File=this.submoduleFromLS?.image,this.file=this.submoduleFromLS?.file,this.formComponents=t?.formIds,this.formTabs=t?.formIds?.map(r=>r.title);let o=JSON.parse(JSON.stringify(this.formComponents));o?.map(r=>{this.formKeys?.push({[r.key]:U.cQ.flattenComponents(r?.components,!0)})}),this.summarySchemaFields=this.formKeys.flatMap(r=>(0,E.oX)(r)),console.log(this.summarySchemaFields),this.formKeysForViewSchema=this.summarySchemaFields,o?.map((r,l)=>{r?.defaultData&&(this.defaultFormIndex=l,this.deafultFormSubmission[this.defaultFormIndex]=r?.defaultData)})}else{this.formComponents=t?.formIds,this.formTabs=t?.formIds?.map(V=>V.title);let o=JSON.parse(JSON.stringify(this.formComponents));o?.map(V=>{this.formKeys?.push({[V.key]:U.cQ.flattenComponents(V?.components,!0)})}),this.summarySchemaFields=this.formKeys.flatMap(V=>(0,E.oX)(V)),this.formKeysForViewSchema=this.summarySchemaFields,o?.map((V,P)=>{V?.defaultData&&(this.defaultFormIndex=P,this.deafultFormSubmission[this.defaultFormIndex]=V?.defaultData)});const r={value:t?.companyId?.id,label:t?.companyId?.title},l={value:t?.categoryId?.id,label:t?.categoryId?.name};this.file=t?.image,this.base64File=t?.image;const g=t?.workFlowId?.stepIds?.map(V=>({id:V?.id,approverIds:V?.approverIds?.map(P=>({name:P?.fullName,id:P?.id,control:new c.NI(!0)})),condition:V?.condition,emailNotifyTo:V?.emailNotifyToId?.notifyUsers||[],emailNotifyToId:V?.emailNotifyToId?.id})),ee=t?.adminUsers?.map(V=>({name:V?.fullName,id:V?.id,control:new c.NI(!0)})),xe=t?.viewOnlyUsers?.map(V=>({name:V?.fullName,id:V?.id,control:new c.NI(!0)}));delete t?.workFlowId,delete t?.url,delete t?.companyId,delete t?.categoryId;const re=Object.assign(t,{workFlowId:g},{categoryId:l},{companyId:r},{viewOnlyUsers:xe},{adminUsers:ee});this.transportService.saveDraftLocally(re),this.initSubModuleForm(re)}}))})}getAllCompanies(){this.dashboard.getAllCompanies(10,0).pipe((0,f.R)(this.destroy$)).subscribe(i=>{this.companyList=i.results?.map(t=>({value:t?.id,label:t?.title}))})}getAllCategories(){this.dashboard.getAllCategories(10).pipe((0,f.R)(this.destroy$)).subscribe(i=>{this.categoryList=i.results?.map(t=>({value:t?.id,label:t?.name}))})}get categories(){return this.f.categories}addCategory(){const i=this.fb.group({name:["",c.kI.required]});this.categories.push(i)}removeCategory(i){this.categories.removeAt(i)}initSubModuleForm(i){this.subModuleForm=this.fb.group({categoryId:[i?.categoryId?.value?i?.categoryId?.value:this.categoryList?.filter(t=>i?.categoryId===t.value)[0]?.value||null,c.kI.required],code:[i?.code,c.kI.compose([c.kI.required,c.kI.maxLength(7)])],companyId:[i?.companyId?.value?i?.companyId?.value:this.companyList?.filter(t=>i?.companyId===t.value)[0]?.value||null,c.kI.required],title:[i?.title||null,c.kI.required],image:[i?.image||null,c.kI.required],description:[i?.description||null,c.kI.required],adminUsers:[i?.adminUsers||[],c.kI.required],viewOnlyUsers:[i?.viewOnlyUsers||[],c.kI.required],workFlowId:this.fb.array(i?.workFlowId?i?.workFlowId?.map(t=>this.fb.group({id:t.id,condition:[t.condition,c.kI.required],approverIds:[t.approverIds,c.kI.required],emailNotifyTo:[t.emailNotifyTo||[],c.kI.required],emailNotifyToId:t?.emailNotifyToId})):[this.fb.group({condition:["",c.kI.required],approverIds:[[],c.kI.required],emailNotifyTo:[[],c.kI.required]})])})}get f(){return this.subModuleForm.controls}setAdminUsers(i){this.subModuleForm?.get("adminUsers")?.setValue(i)}setViewUsers(i){this.subModuleForm?.get("viewOnlyUsers")?.setValue(i)}openSummarySchemaDialog(i){this.schemaSubscription.push(this.dialogs.open(i,{dismissible:!1,closeable:!1,size:"page"}).subscribe())}addDefaultData(i,t){this.formForDefaultData=this.formComponents[i],this.defaultFormIndex=i,this.defaultFormSubscription.push(this.dialogs.open(t,{dismissible:!1,closeable:!1,size:"page"}).subscribe())}onChangeForm(i){i?.data&&i?.changed&&(i?.data?.file&&i?.data?.file?.forEach(t=>{t.url=t?.data?.baseUrl.split("v1")[0]+t?.data?.fileUrl}),this.deafultFormSubmission[this.defaultFormIndex]={data:i?.data})}confirmDefaultSubmission(){this.formComponents[this.defaultFormIndex].defaultData=this.deafultFormSubmission[this.defaultFormIndex];let i={...this.formComponents[this.defaultFormIndex],revisionNo:void 0,id:void 0,createdBy:void 0,status:void 0,updatedBy:void 0};this.formService.updateForm(this.formComponents[this.defaultFormIndex]?.id,i).pipe((0,f.R)(this.destroy$)).subscribe(),this.defaultFormSubscription.forEach(t=>t.unsubscribe())}sendFormForEdit(i,t,o){let r=this.workflows?.value?.flatMap(l=>l?.approverIds?.map(g=>({id:g.id,name:g.name})));if(0==r.length)return this.notif.displayNotification("Please create a default workflow before adding forms","Default Workflow","warning");(0,d.LS)(d.MX.approvers,r),(0,d.LS)(d.MX.formKey,o),t?((0,d.LS)(d.MX.formEdit,!0),this.transportService.saveDraftLocally({...this.subModuleForm.value,image:this.base64File,file:this.file}),this.router.navigate(["/forms/edit-form"],{queryParams:{id:t}})):((0,d.LS)(d.MX.formEdit,!0),this.transportService.isFormEdit.next(!0),this.transportService.sendFormDataForEdit.next(this.formComponents[i]),this.transportService.saveDraftLocally({...this.subModuleForm.value,image:this.base64File,file:this.file}),this.router.navigate(["/forms/edit-form"],{queryParams:{submoduleID:this.transportService.subModuleID?.value}}))}deleteFormDialog(i,t){this.delFormId=t,this.dialogs.open(i,{dismissible:!0,closeable:!0}).pipe((0,f.R)(this.destroy$)).subscribe()}deleteForm(){this.formService.deleteForm(this.delFormId).pipe((0,f.R)(this.destroy$)).subscribe(i=>{this.getSubmoduleByIDForEdit()})}saveDraft(){let i=this.workflows?.value?.flatMap(t=>t?.approverIds?.map(o=>({id:o.id,name:o.name})));if(0==i.length)return this.notif.displayNotification("Please create a default workflow before adding forms","Default Workflow","warning");(0,d.LS)(d.MX.approvers,i),this.transportService.sendFormBuilderData(this.formComponents),this.transportService.saveDraftLocally({...this.subModuleForm.value,image:this.base64File,file:this.file}),this.router.navigate(["/forms/edit-form"])}get workflows(){return this.f.workFlowId}addWorkflowStep(){const i=this.fb.group({condition:["",c.kI.required],approverIds:[[],c.kI.required],emailNotifyTo:[[],c.kI.required]});this.workflows.push(i)}removeWorkflowStep(i){this.workflows.removeAt(i)}getApproverList(i,t){this.workflows.at(t)?.get("approverIds")?.setValue(i)}validateSelection(i){return this.errorIndex=i,this.workflows.at(i)?.get("approverIds")?.value?.length<2?(this.workflows.at(i)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Submodule","info")):this.workflows.at(i)?.get("approverIds")?.value?.length>=2&&"none"==this.workflows.at(i)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}countUsers(i,t){return this.errorIndex=t,i<2?(this.workflows.at(t)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info")):i>=2&&"none"==this.workflows.at(t)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}dataSubmitValidation(){return!(this.f.companyId?.invalid||0==this.workflows?.length||this.workflows.controls.map(i=>0==i.get("approverIds")?.value.length).includes(!0)||!0===this.workflows.controls.map(i=>i.get("condition")?.value).includes("")||0==Object.values(this.formComponents)[0]?.components?.length)}cancelSubmodule(){(0,d.rV)(d.MX.moduleSlug)?this.router.navigate(["/modules",(0,d.rV)(d.MX.moduleSlug)],{queryParams:{moduleID:(0,d.rV)(d.MX.moduleID)}}):this.router.navigate(["/dashboard/home"])}checkIfLabelIsUnique(){return new Set(this.schemaForm.controls.viewSchema.value?.map(t=>t?.displayAs)).size===this.schemaForm.controls.viewSchema.value?.length}setSummaryAndViewSchema(){return 0==this.checkIfLabelIsUnique()?this.notif.displayNotification("Field labels must be unique","Schema Controls","warning"):this.schemaForm?.value?.viewSchema[0]?.displayAs?(this.schemaSubscription.forEach(i=>i.unsubscribe()),void console.log(this.schemaForm.value)):this.notif.displayNotification("Please provide all data","Form Schema","warning")}closeSchemaDialog(){this.schemaSubscription.forEach(i=>i.unsubscribe())}saveSubModule(i){if(!i){if(0==this.dataSubmitValidation())return this.subModuleForm.markAllAsTouched(),this.notif.displayNotification("Please provide all data","Edit Submodule","warning");if(this.workflows.controls.map(o=>o.get("approverIds")?.value.length>1&&o.get("condition")?.value).includes("none"))return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create Submodule","warning")}i?this.isSavingAsDraft.next(!0):this.isCreatingSubModule.next(!0);let t={url:`/modules/module-details/${this.subModuleForm.get("title")?.value.replace(/\s/g,"-").toLowerCase()}`,companyId:this.subModuleForm.get("companyId")?.value,categoryId:this.subModuleForm.get("categoryId")?.value?this.subModuleForm.get("categoryId")?.value:this.categoryId,image:this.subModuleForm.get("image")?.value,title:this.subModuleForm.get("title")?.value,description:this.subModuleForm.get("description")?.value,code:this.subModuleForm.get("code")?.value,adminUsers:this.subModuleForm.get("adminUsers")?.value?.map(o=>o?.id),viewOnlyUsers:this.subModuleForm.get("viewOnlyUsers")?.value?.map(o=>o?.id),steps:this.workflows?.value?.map(o=>({id:o?.id?o?.id:void 0,approverIds:o?.approverIds?.map(r=>r.id?r.id:r),condition:o?.condition,emailNotifyTo:o?.emailNotifyTo||[],emailNotifyToId:o?.emailNotifyToId?o?.emailNotifyToId:void 0})),summarySchema:this.schemaForm.value?.summarySchema?.length>0?this.schemaForm.value?.summarySchema:void 0,viewSchema:this.schemaForm.value?.viewSchema[0]?.displayAs?this.schemaForm.value?.viewSchema:void 0,accessType:this.accessTypeValue?.value?.name};if(Object.assign(t,i?{status:i}:{status:1}),"string"==typeof this.file){const o="uploads"+t?.image.split("uploads")[1];t={...t,image:o},this.dashboard.updateSubModule(this.transportService.subModuleID?.value,t).pipe((0,f.R)(this.destroy$)).subscribe(r=>{r?(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1),this.transportService.saveDraftLocally({}),this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.routeToBasedOnPreviousPage()):(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1))})}else this.media.uploadMedia(this.file).pipe((0,f.R)(this.destroy$)).subscribe(o=>{o.hasErrors()?(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1)):(t={...t,image:o?.data?.fileUrl},this.dashboard.updateSubModule(this.transportService.subModuleID?.value,t).pipe((0,f.R)(this.destroy$)).subscribe(r=>{r?(this.isCreatingSubModule.next(!1),this.transportService.saveDraftLocally({}),this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.routeToBasedOnPreviousPage()):(this.isCreatingSubModule.next(!1),this.isSavingAsDraft.next(!1))}))});(0,d.cl)(d.MX.editmoduleId),(0,d.cl)(d.MX.editmoduleSlug)}routeToBasedOnPreviousPage(){this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(i=>{Object.keys(i).length>0?this.router.navigate(["/dashboard/home"]):this.router.navigate(["/modules",(0,d.rV)(d.MX.moduleSlug)||""],{queryParams:{moduleID:(0,d.rV)(d.MX.moduleID)||""}})})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}Ue.\u0275fac=function(i){return new(i||Ue)(e.Y36(c.qu),e.Y36(ne.e),e.Y36(ae.R),e.Y36(a.F0),e.Y36(q.s),e.Y36(a.gz),e.Y36(X.T),e.Y36(Qt.s),e.Y36(A.RO),e.Y36(M))},Ue.\u0275cmp=e.Xpm({type:Ue,selectors:[["ng-component"]],decls:115,vars:49,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52","pb-44"],[1,"text-xl","font-semibold","text-center"],[1,"text-lg","font-semibold","bg-[#EAE4D8]","px-2","py-2","rounded-md","mt-2"],[1,"block","pt-5",3,"formGroup"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-6","mt-3","mb-5"],[1,"block","pb-1"],[1,"text-xs","text-red-400"],["required","","formControlName","title","type","text",1,"form-control",3,"ngClass"],[3,"ngTemplateOutlet","ngTemplateOutletContext"],["required","","formControlName","code","type","text",1,"form-control",3,"ngClass"],[1,"col-span-6","mt-3","mb-3"],["required","","formControlName","description","type","text","rows","6",1,"form-control",3,"ngClass"],["for","dropzone-file",1,"flex","flex-col","items-center","justify-center","w-full","h-[9.85rem]","border-2","border-gray-300","border-dashed","rounded-md","cursor-pointer","bg-gray-50","hover:bg-gray-100",3,"change"],[3,"inheritColor","size","showLoader","overlay"],["class","flex justify-center",4,"ngIf"],["class","flex justify-start",4,"ngIf"],["id","dropzone-file","type","file",1,"hidden"],[1,"my-7"],["required","","formControlName","companyId","type","text",1,"form-control",3,"ngClass"],[4,"ngFor","ngForOf"],["required","","formControlName","categoryId","type","text",1,"form-control",3,"ngClass"],[1,"grid","grid-cols-12","gap-3","my-8"],[1,"col-span-6"],[1,"block","pb-1","text-sm"],["formControlName","adminUsers",3,"approverList"],["formControlName","viewOnlyUsers",3,"approverList"],[1,"mt-12"],[1,"text-lg","font-semibold","bg-[#EAE4D8]","px-2","py-2","rounded-md","mb-3"],["formArrayName","workFlowId"],["tuiIconButton","","type","button","size","m","appearance","primary","icon","tuiIconPlusLarge",3,"click"],[1,"mb-5","mt-7"],[1,"flex","justify-between","bg-[#EAE4D8]","px-2","py-2","rounded-md","mb-3"],[1,"text-lg","font-semibold","mt-1.5"],["class","px-2.5 py-2 text-white bg-blue-500 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],[1,"mt-3","text-base","font-semibold","text-center"],[1,"flex","flex-col","w-full","px-5","mx-auto","mt-5","border","border-gray-400","border-dashed","rounded-md","bg-gray-50"],[4,"ngIf"],[1,"w-full","mx-auto","my-1"],[1,"text-xs","text-gray-500"],[1,"mt-7"],[1,"px-5","py-3","rounded-lg","bg-[#a58f81]","no-underline","text-white","cursor-pointer","hover:text-white",3,"click"],[1,"flex","justify-center","gap-2","mt-10"],["tuiButton","","type","button","size","m","appearance","primary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","secondary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],["formError",""],["template",""],["hint",""],["summarySchemaTemplate",""],["deltemplate",""],["defaultForm",""],[1,"flex","justify-center"],["alt","app_icon","width","100","height","100",1,"rounded-md",3,"src"],[1,"flex","justify-start"],[1,"mx-8","mt-1"],["src","../../../../../assets/windows.svg","width","32","height","32"],[1,"text-sm","text-gray-400","list-disc"],[3,"value"],[1,"text-base","font-semibold","mt-7"],[1,"grid","grid-cols-12","gap-3","my-4",3,"formGroupName"],[1,"col-span-3"],["formControlName","approverIds",3,"checkUsersLength","approverList"],["class","text-xs text-red-500",4,"ngIf"],["for","conditionSelect",1,"block","pb-1"],["formControlName","condition","aria-label","Default select example","id","conditionSelect",1,"h-10","mt-2","form-select","form-control",3,"change"],["value","or"],["value","none"],[1,"inline-flex","col-span-1","mt-8"],["direction","right",1,"mt-1","mr-4","-ml-2",3,"content"],[3,"contentTop","colorTop"],["tuiIconButton","","type","button","size","s","appearance","outline","icon","tuiIconMailLarge",3,"click"],[1,"col-span-4"],[1,"flex","justify-between","mt-8"],[1,"tui-space_bottom-3",3,"formControl","item"],[1,"mt-1","text-xxs","font-extralight"],[1,"col-span-1","mt-8"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2Large",3,"click"],[1,"text-xs","text-red-500"],["value","and"],[1,"col-span-1","mt-8","-ml-4"],[1,"px-2.5","py-2","text-white","bg-blue-500","rounded-md","cursor-pointer","hover:text-white",3,"click"],[1,"flex","justify-between","my-8"],["tuiTabs","","vertical","left",1,"w-32","mr-5"],["tuiTab","",3,"click"],["class","w-full well jsonviewer",4,"ngIf"],[1,"w-full","well","jsonviewer"],[1,"relative","flex","justify-end","gap-x-2"],[1,"absolute","z-10","flex","justify-end","-top-[30px]","right-1","gap-x-2"],["title","Add default data",1,"rounded-md","cursor-pointer","mt-[0.5px]",3,"click"],["aria-hidden","true",1,"text-green-500","hover:text-green-600","fa","fa-table","fa-2x"],["title","Edit Form",1,"rounded-md","cursor-pointer",3,"click"],["aria-hidden","true",1,"text-blue-500","hover:text-blue-600","fa","fa-pencil-square","fa-2x"],[1,"rounded-md","cursor-pointer",3,"click"],["aria-hidden","true",1,"text-red-500","fa","fa-trash","fa-2x","hover:text-red-600"],[3,"language","options","form","submission"],[1,"grid","grid-cols-12","gap-2"],["data-placeholder","",1,"h-8","col-span-12","my-3","overflow-hidden","bg-gray-200","rounded-md"],[1,"grid","grid-cols-12","col-span-12","gap-2"],["data-placeholder","",1,"col-span-6","mb-3","overflow-hidden","bg-gray-200","rounded-md","h-28"],["data-placeholder","",1,"h-8","col-span-6","my-3","overflow-hidden","bg-gray-200","rounded-md"],[1,"w-full","mt-1","text-left","fv-plugins-message-container","text-xxs","2xl:text-xs"],["role","alert",1,"text-red-400","fv-help-block","text-xxs","2xl:text-xs","2xl:mb-2"],[1,"text-lg","font-semibold","text-center"],[1,"mt-3","text-base","font-medium","text-gray-500"],[1,"flex","flex-col","justify-center","my-5"],[1,"b-form",3,"formControl","tuiTextfieldLabelOutside","searchChange"],[3,"items",4,"tuiDataList"],[1,"flex","justify-start","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["appearance","accent","tuiButton","","type","button","size","m",3,"click"],[3,"items"],[1,"text-base"],[1,"mt-2"],[1,"my-2"],[1,"mt-8","text-lg","font-semibold","text-center"],[1,"w-[80%]","mx-auto","my-8",3,"formGroup"],[1,"mb-2","font-medium"],["formControlName","summarySchema",3,"tuiTextfieldLabelOutside"],[1,"mt-1","text-xxs"],["formArrayName","viewSchema"],[1,"flex","justify-end","my-2"],["tuiIconButton","","type","button","size","s","appearance","primary","icon","tuiIconPlus",3,"click"],[1,"flex","justify-center","gap-2"],["tuiButton","","type","button","size","m","appearance","primary",3,"click"],[1,"grid","grid-cols-12","gap-2","mb-3",3,"formGroupName"],["formControlName","fieldKey",1,"col-span-3",3,"tuiTextfieldLabelOutside"],["formControlName","displayAs",1,"col-span-3",3,"tuiTextfieldLabelOutside"],["tuiTextfield","","type","text",3,"tuiTextfieldLabelOutside"],["formControlName","type",1,"col-span-3"],["placeholder","Specify data type","tuiTextfield",""],["formControlName","isDisplayedInGrid",1,"col-span-2","mt-3"],[1,"text-gray-400","text-xxs"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2",1,"col-span-1","mt-2",3,"click"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"],[1,"w-[90%]","mx-auto"],[3,"options","form","submission","change"]],template:function(i,t){if(1&i&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0)(2,"section")(3,"h3",1),e._uU(4,"Edit app"),e.qZA(),e.TgZ(5,"h4",2),e._uU(6,"App Details"),e.qZA()(),e.TgZ(7,"form",3)(8,"div",4)(9,"div",5)(10,"label",6),e._uU(11,"App Title "),e.TgZ(12,"span",7),e._uU(13,"*"),e.qZA()(),e._UZ(14,"input",8),e.GkF(15,9),e.qZA(),e.TgZ(16,"div",5)(17,"label",6),e._uU(18,"App Code "),e.TgZ(19,"span",7),e._uU(20,"*"),e.qZA()(),e._UZ(21,"input",10),e.GkF(22,9)(23,9),e.qZA()(),e.TgZ(24,"div",4)(25,"div",11)(26,"label",6),e._uU(27,"App Description"),e.TgZ(28,"span",7),e._uU(29,"*"),e.qZA()(),e._UZ(30,"textarea",12),e.GkF(31,9),e.qZA(),e.TgZ(32,"div",11)(33,"label",6),e._uU(34,"App Icon"),e.TgZ(35,"span",7),e._uU(36,"*"),e.qZA()(),e.TgZ(37,"label",13),e.NdJ("change",function(r){return t.onFileSelect(r)}),e.TgZ(38,"tui-loader",14),e.YNc(39,Rt,2,1,"div",15),e.YNc(40,Vt,8,0,"div",16),e.qZA(),e._UZ(41,"input",17),e.qZA()()(),e.TgZ(42,"div",18)(43,"label",6),e._uU(44,"Company Name "),e.TgZ(45,"span",7),e._uU(46,"*"),e.qZA()(),e.TgZ(47,"select",19),e.YNc(48,qt,3,2,"ng-container",20),e.qZA(),e.GkF(49,9),e.qZA(),e.TgZ(50,"div",18)(51,"label",6),e._uU(52,"Category Name "),e.TgZ(53,"span",7),e._uU(54,"*"),e.qZA()(),e.TgZ(55,"select",21),e.YNc(56,Kt,3,2,"ng-container",20),e.qZA(),e.GkF(57,9),e.qZA(),e.TgZ(58,"div",22)(59,"div",23)(60,"label",24),e._uU(61,"Admin users "),e.TgZ(62,"sup"),e._uU(63,"(optional)"),e.qZA()(),e.TgZ(64,"custom-multi-select",25),e.NdJ("approverList",function(r){return t.setAdminUsers(r)}),e.qZA()(),e.TgZ(65,"div",23)(66,"label",24),e._uU(67,"View Only users "),e.TgZ(68,"sup"),e._uU(69,"(optional)"),e.qZA()(),e.TgZ(70,"custom-multi-select",26),e.NdJ("approverList",function(r){return t.setViewUsers(r)}),e.qZA()()(),e.TgZ(71,"div",27)(72,"h4",28),e._uU(73,"Edit Workflow"),e.qZA(),e.ynx(74,29),e.YNc(75,Wt,6,4,"ng-container",20),e.BQk(),e.TgZ(76,"button",30),e.NdJ("click",function(){return t.addWorkflowStep()}),e.qZA()(),e.TgZ(77,"div",31)(78,"div",32)(79,"h4",33),e._uU(80,"Edit Form/s"),e.qZA(),e.YNc(81,jt,2,0,"a",34),e.qZA(),e.TgZ(82,"h4",35),e._uU(83,"Form/s Preview"),e.qZA(),e.TgZ(84,"div",36),e.YNc(85,nn,5,2,"ng-container",37),e.YNc(86,on,9,0,"ng-container",37),e.qZA(),e.TgZ(87,"div",38)(88,"p",39),e._uU(89,"The form you add will appear here"),e.qZA()()(),e.TgZ(90,"div",40)(91,"a",41),e.NdJ("click",function(){return t.saveDraft()}),e._uU(92),e.qZA()(),e.TgZ(93,"div",42)(94,"button",43),e.NdJ("click",function(){return t.saveSubModule()}),e.ALo(95,"async"),e._uU(96," Update "),e.qZA(),e.TgZ(97,"button",44),e.NdJ("click",function(){return t.saveSubModule(3)}),e.ALo(98,"async"),e._uU(99," Save as Draft "),e.qZA(),e.TgZ(100,"button",45),e.NdJ("click",function(){return t.cancelSubmodule()}),e._uU(101,"Cancel"),e.qZA()()()(),e._UZ(102,"app-footer"),e.YNc(103,rn,1,1,"ng-template",null,46,e.W1O),e.YNc(105,ln,13,2,"ng-template",null,47,e.W1O),e.YNc(107,un,16,0,"ng-template",null,48,e.W1O),e.YNc(109,_n,26,3,"ng-template",null,49,e.W1O),e.YNc(111,gn,9,0,"ng-template",null,50,e.W1O),e.YNc(113,fn,9,3,"ng-template",null,51,e.W1O)),2&i){const o=e.MAs(104);e.xp6(7),e.Q6J("formGroup",t.subModuleForm),e.xp6(7),e.Q6J("ngClass",null!=t.f.title&&t.f.title.invalid&&null!=t.f.title&&t.f.title.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(37,hn,t.f.title)),e.xp6(6),e.Q6J("ngClass",null!=t.f.code&&t.f.code.invalid&&null!=t.f.code&&t.f.code.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(39,bn,t.f.code)),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(41,vn,t.f.code)),e.xp6(7),e.Q6J("ngClass",null!=t.f.description&&t.f.description.invalid&&null!=t.f.description&&t.f.description.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(43,yn,t.f.description)),e.xp6(7),e.Q6J("inheritColor",!0)("size","l")("showLoader",!1)("overlay",!0),e.xp6(1),e.Q6J("ngIf",t.file),e.xp6(1),e.Q6J("ngIf",!t.file),e.xp6(7),e.Q6J("ngClass",null!=t.f.companyId&&t.f.companyId.invalid&&null!=t.f.companyId&&t.f.companyId.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngForOf",t.companyList),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(45,xn,t.f.companyId)),e.xp6(6),e.Q6J("ngClass",null!=t.f.categoryId&&t.f.categoryId.invalid&&null!=t.f.categoryId&&t.f.categoryId.dirty?"is-invalid":""),e.xp6(1),e.Q6J("ngForOf",t.categoryList),e.xp6(1),e.Q6J("ngTemplateOutlet",o)("ngTemplateOutletContext",e.VKq(47,Tn,t.f.categoryId)),e.xp6(18),e.Q6J("ngForOf",t.workflows.controls),e.xp6(6),e.Q6J("ngIf",(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)>0),e.xp6(4),e.Q6J("ngIf",(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)>0),e.xp6(1),e.Q6J("ngIf",0==(null==t.formComponents[0]||null==t.formComponents[0].components?null:t.formComponents[0].components.length)||0==(null==t.formComponents?null:t.formComponents.length)),e.xp6(6),e.hij(" ","Add form"," "),e.xp6(2),e.Q6J("showLoader",1==e.lcZ(95,33,t.isCreatingSubModule)),e.xp6(3),e.Q6J("showLoader",1==e.lcZ(98,35,t.isSavingAsDraft))}},dependencies:[n.mk,n.sg,n.O5,n.tP,$.G,de.c,ue.K3,ue.wU,se.MB,he.xT,N.eC,ye.gX,R.VT,C.uJ,C.OI,c._Y,c.YN,c.Kr,c.Fj,c.EJ,c.JJ,c.JL,c.Q7,c.oH,c.sg,c.u,c.x0,c.CE,be.v0,ke.k4,m,Fe.e,p.p_,p.uW,p.yu,h.V,Q.PZ,we.w,De.kM,ie.p,n.Ov]});var Cn=u(94813),wn=u(54004),Re=u(69952),Be=u(55314),Ve=u(78372),qe=u(71884),Pe=u(8276),Ke=u(91127),Se=u(44886),Ge=u(6110),Je=u(67155),Le=u(82176),Ye=u(87089),$e=u(6229),Sn=u(30243);function An(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",20),2&s){const t=e.oxw(2);e.Q6J("items",t.items)}}function In(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"filter",24),e.NdJ("applyStatus",function(r){e.CHM(t);const l=e.oxw(4);return e.KtG(l.sendFilterValue(r))})("resetFilters",function(r){e.CHM(t);const l=e.oxw(4);return e.KtG(l.resetFilterValues(r))}),e.qZA(),e.BQk()}if(2&s){const t=e.oxw(2).$implicit,o=e.oxw(2);e.xp6(1),e.Q6J("filterBy",null==t?null:t.key)("items",o.statusMenu)("searchEnabled",!1)}}function Mn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tui-svg",29),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(4),l=r.$implicit,g=r.index,ee=e.oxw(2);return e.KtG(ee.sortFields(null==l?null:l.searchKey,"asc",g))}),e.qZA()}}function Zn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"tui-svg",30),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(4),l=r.$implicit,g=r.index,ee=e.oxw(2);return e.KtG(ee.sortFields(null==l?null:l.searchKey,"desc",g))}),e.qZA()}}function Dn(s,i){if(1&s&&(e.ynx(0),e.YNc(1,Mn,1,0,"tui-svg",27),e.YNc(2,Zn,1,0,"tui-svg",28),e.BQk()),2&s){const t=e.oxw(3).$implicit;e.xp6(1),e.Q6J("ngIf",null==t?null:t.showUpIcon),e.xp6(1),e.Q6J("ngIf",null==t?null:t.showDownIcon)}}function kn(s,i){if(1&s&&(e.YNc(0,Dn,3,2,"ng-container",25),e._UZ(1,"br")(2,"input",26)),2&s){const t=e.oxw(2).$implicit;e.Q6J("ngIf","Now Pending With"!=(null==t?null:t.key)),e.xp6(2),e.Q6J("formControl",null==t?null:t.search)}}function On(s,i){if(1&s&&(e.TgZ(0,"th",22),e._uU(1),e.YNc(2,In,2,3,"ng-container",0),e.YNc(3,kn,3,2,"ng-template",null,23,e.W1O),e.qZA()),2&s){const t=e.MAs(4),o=e.oxw(),l=o.$implicit;e.Q6J("ngClass",o.first?"px-4 py-3 text-sm":"px-2 py-3 text-sm"),e.xp6(1),e.hij(" ",null==l?null:l.key,"\xa0 "),e.xp6(1),e.Q6J("ngIf","Submission Status"==(null==l?null:l.key))("ngIfElse",t)}}function Un(s,i){if(1&s&&(e.ynx(0),e.YNc(1,On,5,4,"th",21),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",1==(null==t||null==t.isVisible?null:t.isVisible.value))}}function En(s,i){1&s&&(e.ynx(0),e.TgZ(1,"th",31),e._uU(2," No submissions available! "),e.qZA(),e.BQk())}function Nn(s,i){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const t=e.oxw(3).$implicit,o=e.oxw(3);e.xp6(1),e.hij(" ",o.showStatus(null==t?null:t.submissionStatus)," ")}}function Fn(s,i){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const t=e.oxw(3).$implicit;e.xp6(1),e.hij(" ",1===(null==t?null:t.submissionStatus)||4===(null==t?null:t.submissionStatus)||2===(null==t?null:t.submissionStatus)?null==t||null==t.createdBy?null:t.createdBy.fullName:(null==t||null==t.summaryData||null==t.summaryData.lastActivityPerformedBy?null:t.summaryData.lastActivityPerformedBy.fullName)||""," ")}}function Pn(s,i){1&s&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function Ln(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.YNc(3,Pn,2,0,"span",25),e._uU(4," \xa0"),e.qZA(),e.BQk()),2&s){const t=i.$implicit,o=i.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!o)}}const Bn=function(){return[]};function Jn(s,i){if(1&s&&(e.ynx(0),e.YNc(1,Ln,5,2,"ng-container",15),e.BQk()),2&s){const t=e.oxw(3).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngForOf",o.getPendingOnUsers((null==t||null==t.summaryData?null:t.summaryData.pendingOnUsers)||e.DdM(1,Bn)))}}function Qn(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"td",41),e._UZ(2,"progress",42),e.TgZ(3,"span"),e._uU(4),e.ALo(5,"number"),e.qZA()(),e.BQk()),2&s){const t=e.oxw(3).$implicit,o=e.oxw(3);e.xp6(1),e.Q6J("ngClass",6==(null==t?null:t.submissionStatus)?"text-red-500":""),e.xp6(1),e.Q6J("color",o.changeProgressColor(null==t||null==t.summaryData?null:t.summaryData.progress))("value",null==t||null==t.summaryData?null:t.summaryData.progress),e.xp6(2),e.hij("",e.xi3(5,4,null==t||null==t.summaryData?null:t.summaryData.progress,"1.1-2")," %")}}function Rn(s,i){if(1&s&&(e.ynx(0),e._uU(1),e.BQk()),2&s){const t=e.oxw(2).$implicit,o=e.oxw().$implicit,r=e.oxw(3);e.xp6(1),e.hij(" ",r.bindValueFromSummaryData(null==o?null:o.summaryData,t.field)," ")}}const Vn=function(s,i,t){return{"text-red-500":s,"px-4":i,"px-2":t}};function qn(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"td",37),e.ynx(2,38),e.YNc(3,Nn,2,1,"ng-container",39),e.YNc(4,Fn,2,1,"ng-container",39),e.YNc(5,Jn,2,2,"ng-container",39),e.YNc(6,Qn,6,7,"ng-container",39),e.YNc(7,Rn,2,1,"ng-container",40),e.BQk(),e.qZA(),e.BQk()),2&s){const t=e.oxw(),o=t.first,r=t.$implicit,l=e.oxw().$implicit;e.xp6(1),e.Q6J("ngClass",e.kEZ(6,Vn,6==(null==l?null:l.submissionStatus),o,!o)),e.xp6(1),e.Q6J("ngSwitch",r.key),e.xp6(1),e.Q6J("ngSwitchCase","Submission Status"),e.xp6(1),e.Q6J("ngSwitchCase","Last Activity By"),e.xp6(1),e.Q6J("ngSwitchCase","Now Pending With"),e.xp6(1),e.Q6J("ngSwitchCase","Workflow progress")}}function Kn(s,i){if(1&s&&(e.ynx(0),e.YNc(1,qn,8,10,"ng-container",25),e.BQk()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("ngIf",null==t||null==t.isVisible?null:t.isVisible.value)}}function Gn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",46),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.editWorkflowRoute(null==r?null:r.id,null==r||null==r.formIds[0]?null:r.formIds[0].key))}),e._UZ(1,"i",47),e.qZA()}}function Yn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",48),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2).$implicit,l=e.oxw(3);return e.KtG(l.editWorkflowRoute(null==r?null:r.id,null==r||null==r.formIds[0]?null:r.formIds[0].key))}),e._UZ(1,"i",49),e.qZA()}}function $n(s,i){if(1&s&&(e.TgZ(0,"div",43),e.YNc(1,Gn,2,0,"a",44),e.ALo(2,"async"),e.ALo(3,"async"),e.ALo(4,"async"),e.ALo(5,"async"),e.ALo(6,"async"),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.YNc(10,Yn,2,0,"a",45),e.ALo(11,"async"),e.ALo(12,"async"),e.ALo(13,"async"),e.ALo(14,"async"),e.ALo(15,"async"),e.ALo(16,"async"),e.qZA()),2&s){const t=e.oxw().$implicit,o=e.oxw(3);let r,l;e.xp6(1),e.Q6J("ngIf",1==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&0==o.checkIfUserisAdmin(null==(r=e.lcZ(2,2,o.moduleData))?null:r.adminUsers)&&0==o.checkIfUserisViewOnly(null==(r=e.lcZ(3,4,o.moduleData))?null:r.viewOnlyUsers)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<100||0==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&1==o.checkIfUserisAdmin(null==(r=e.lcZ(4,6,o.moduleData))?null:r.adminUsers)&&0==o.checkIfUserisViewOnly(null==(r=e.lcZ(5,8,o.moduleData))?null:r.viewOnlyUsers)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<100||1==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&1==o.checkIfUserisAdmin(null==(r=e.lcZ(6,10,o.moduleData))?null:r.adminUsers)&&0==o.checkIfUserisViewOnly(null==(r=e.lcZ(7,12,o.moduleData))?null:r.viewOnlyUsers)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<100||0==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&0==o.checkIfUserisAdmin(null==(r=e.lcZ(8,14,o.moduleData))?null:r.adminUsers)&&0==o.checkIfUserisViewOnly(null==(r=e.lcZ(9,16,o.moduleData))?null:r.viewOnlyUsers)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<100&&1==o.userRoleCheckAdmin),e.xp6(9),e.Q6J("ngIf",0==o.checkIfUserisApprovedUser(null==t?null:t.workflowStatus)&&1==o.checkIfUserisViewOnly(null==(l=e.lcZ(11,18,o.moduleData))?null:l.viewOnlyUsers)&&0==o.checkIfUserisAdmin(null==(l=e.lcZ(12,20,o.moduleData))?null:l.adminUsers)&&0==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<=100||1==o.checkIfUserisApprovedUser(null==t?null:t.workflowStatus)&&0==o.checkIfUserisViewOnly(null==(l=e.lcZ(13,22,o.moduleData))?null:l.viewOnlyUsers)&&0==o.checkIfUserisAdmin(null==(l=e.lcZ(14,24,o.moduleData))?null:l.adminUsers)&&0==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&(null==t||null==t.summaryData?null:t.summaryData.progress)<=100||0==o.checkIfUserisApprovedUser(null==t?null:t.workflowStatus)&&0==o.checkIfUserisViewOnly(null==(l=e.lcZ(15,26,o.moduleData))?null:l.viewOnlyUsers)&&0==o.checkIfUserisAdmin(null==(l=e.lcZ(16,28,o.moduleData))?null:l.adminUsers)&&0==o.checkIfUserisActiveUser(null==t?null:t.workflowStatus)&&100==(null==t||null==t.summaryData?null:t.summaryData.progress)&&1==o.userRoleCheckAdmin)}}const Hn=function(s){return["/modules/edit-submission",s]};function zn(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"a",50),e.NdJ("click",function(){e.CHM(t);const r=e.oxw().$implicit,l=e.oxw(3);return e.KtG(l.setWorkflowID(null==r||null==r.formIds[0]?null:r.formIds[0].key))}),e._UZ(1,"i",51),e.qZA()}if(2&s){const t=e.oxw().$implicit;e.Q6J("routerLink",e.VKq(1,Hn,null==t?null:t.id))}}function Wn(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"tr",33),e.YNc(2,Kn,2,1,"ng-container",15),e.TgZ(3,"td",34),e.YNc(4,$n,17,30,"div",35),e.YNc(5,zn,2,3,"a",36),e.ALo(6,"async"),e.qZA()(),e.BQk()),2&s){const t=i.$implicit,o=e.oxw(3);let r;e.xp6(2),e.Q6J("ngForOf",o.tableHeaders),e.xp6(2),e.Q6J("ngIf",4!==(null==t?null:t.submissionStatus)&&2!==(null==t?null:t.status)),e.xp6(1),e.Q6J("ngIf",(null==o.currentUser?null:o.currentUser.id)==(null==t||null==t.createdBy?null:t.createdBy.id)&&4==(null==t?null:t.submissionStatus)&&5!==(null==t?null:t.submissionStatus)||o.checkIfUserIsFirstUser(null==t?null:t.workflowStatus)&&4==(null==t?null:t.submissionStatus)&&5!==(null==t?null:t.submissionStatus)||1==o.checkIfUserisAdmin(null==(r=e.lcZ(6,3,o.moduleData))?null:r.adminUsers)&&4==(null==t?null:t.submissionStatus)&&5!==(null==t?null:t.submissionStatus))}}function jn(s,i){if(1&s&&e.YNc(0,Wn,7,5,"ng-container",32),2&s){const t=e.oxw(2);e.Q6J("ngForOf",t.tableDataValue)("ngForTrackBy",t.trackByFn)}}function Xn(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"div",4)(2,"div",5)(3,"div",6)(4,"tui-hosted-dropdown",7),e.NdJ("openChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.open=r)}),e._UZ(5,"button",8),e.qZA()(),e.TgZ(6,"div",6)(7,"label",9),e._uU(8,"Data to display"),e.qZA(),e.TgZ(9,"tui-select",10),e._UZ(10,"input",11),e.YNc(11,An,1,1,"tui-data-list-wrapper",12),e.qZA()()(),e.TgZ(12,"table",13)(13,"thead",14)(14,"tr"),e.YNc(15,Un,2,1,"ng-container",15),e.TgZ(16,"th",16),e._uU(17," Actions "),e.qZA()()(),e.TgZ(18,"tbody"),e.YNc(19,En,3,0,"ng-container",0),e.YNc(20,jn,1,2,"ng-template",null,17,e.W1O),e.qZA()(),e.TgZ(22,"div",18)(23,"tui-pagination",19),e.NdJ("indexChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.goToPage(r))}),e.qZA()()(),e.BQk()}if(2&s){const t=i.ngIf,o=e.MAs(21),r=e.oxw(),l=e.MAs(4),g=e.MAs(6);e.xp6(4),e.Q6J("content",l)("open",r.open),e.xp6(1),e.Q6J("tuiHint",g),e.xp6(4),e.Q6J("formControl",r.showSchema)("tuiTextfieldLabelOutside",!0),e.xp6(6),e.Q6J("ngForOf",r.tableHeaders),e.xp6(4),e.Q6J("ngIf",0==(null==r.tableDataValue?null:r.tableDataValue.length))("ngIfElse",o),e.xp6(4),e.Q6J("length",(null==t?null:t.totalPages)||1)("index",(null==t?null:t.page)-1||0)}}function ei(s,i){1&s&&e._UZ(0,"app-table-loader")}function ti(s,i){if(1&s&&(e.TgZ(0,"div",57),e._UZ(1,"tui-checkbox",58),e.TgZ(2,"p",59),e._uU(3),e.qZA()()),2&s){const t=i.$implicit;e.xp6(1),e.Q6J("formControl",null==t?null:t.isVisible),e.xp6(2),e.Oqu(null==t?null:t.key)}}function ni(s,i){if(1&s&&(e.TgZ(0,"div",52)(1,"p",53),e._uU(2,"Toggle table columns:"),e.qZA(),e.YNc(3,ti,4,2,"div",54),e.TgZ(4,"p",55)(5,"span",56),e._uU(6,"Note"),e.qZA(),e._uU(7,": Select upto 4 keys to be displayed simultaneously for a better "),e.qZA()()),2&s){const t=e.oxw();e.xp6(3),e.Q6J("ngForOf",t.tableHeaders)}}function ii(s,i){1&s&&(e.TgZ(0,"strong",60),e._uU(1,"Toggle table columns"),e.qZA())}class Ae{constructor(i,t,o,r,l){this.workflowService=i,this.auth=t,this.dashboard=o,this.router=r,this.activatedRoute=l,this.subscriptions=[],this.adminUsers=[],this.createdByUsers=[],this.destroy$=new x.x,this.searchValue=new c.NI,this.items=["Display default","Display via View Schema"],this.open=!1,this.statusMenu=[{name:"Created",status:"idle",icon:""},{name:"Completed",status:"idle",icon:""},{name:"In Progress",status:"idle",icon:""},{name:"Draft",status:"idle",icon:""},{name:"Cancelled",status:"idle",icon:""},{name:"Deleted",status:"idle",icon:""}],this.page=1,this.limit=7,this.remarks=new c.NI(""),this.showSchema=new c.NI("Display default"),this.showUpIcon=!0,this.showDownIcon=!1,this.tableHeaders=[{key:"Submission Status",searchKey:"submissionStatus",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Last Activity By",searchKey:"lastActivityPerformedBy",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Now Pending With",searchKey:"pendingOnUsers",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Workflow progress",searchKey:"progress",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"number",search:new c.NI(null)}],this.currentUser=this.auth.currentUserValue,this.userRoleCheckAdmin=this.auth.checkIfRolesExist("sysAdmin"),this.activatedRoute.queryParams.subscribe(g=>{g.moduleID&&(this.submoduleId=g.moduleID,this.fetchDataAndPopulate())}),this.showSchema.valueChanges.pipe((0,f.R)(this.destroy$)).subscribe(g=>{"Display default"==g&&(this.tableHeaders=[{key:"Submission Status",searchKey:"submissionStatus",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Last Activity By",searchKey:"lastActivityPerformedBy",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Now Pending With",searchKey:"pendingOnUsers",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"text",search:new c.NI(null)},{key:"Workflow progress",searchKey:"progress",isVisible:new c.NI(!0),showUpIcon:!0,showDownIcon:!1,type:"number",search:new c.NI(null)}],this.fetchDataAndPopulate()),"Display via View Schema"==g&&this.subscriptions.push(this.dashboard.getSubModuleByID(this.submoduleId).subscribe(ee=>{this.submoduleData=ee;let xe=this.submoduleData?.viewSchema?.map((re,V)=>({key:re?.displayAs,field:re?.fieldKey,formKey:re?.formKey,searchKey:re.fieldKey,isVisible:new c.NI(V<4),showUpIcon:!0,showDownIcon:!1,type:re?.type,search:new c.NI(null)}));this.tableHeaders=xe,this.tableHeaders.forEach(re=>{re.search&&re.search.valueChanges.pipe((0,Ve.b)(400),(0,qe.x)(),(0,f.R)(this.destroy$)).subscribe(V=>{let P;if(V){if(["lastActivityPerformedBy","pendingOnUsers"].includes(re?.searchKey)&&(P={summaryData:{[re?.searchKey]:{fullName:V}}}),"progress"==re?.searchKey&&(P={summaryData:{[re?.searchKey]:Number(V)}}),!["lastActivityPerformedBy","pendingOnUsers","progress"].includes(re?.searchKey))if("Number"==re?.type){let _e=[];_e.push({key:re?.field,value:Number(re?.search?.value)}),P={summaryData:{forms:_e}}}else{let _e=[];_e.push({key:re?.field,value:re?.search?.value}),P={summaryData:{forms:_e}}}}else P={};this.sendSearchCallForFilters(P)})})}))})}setWorkflowID(i){(0,d.LS)(d.MX.formKey,i)}fetchDataAndPopulate(){this.subscriptions.push(this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).subscribe(i=>{this.submissionData=i,this.tableDataValue=i?.results?.map(t=>({...t,isVisible:!0})),this.createdByUsers=i?.results?.map(t=>t?.subModuleId?.createdBy),this.tableHeaders.forEach(t=>{t.search&&t.search.valueChanges.pipe((0,Ve.b)(400),(0,qe.x)()).subscribe(o=>{let r;o?(["lastActivityPerformedBy","pendingOnUsers"].includes(t?.searchKey)&&(r={summaryData:{[t?.searchKey]:{fullName:o}}}),"progress"==t?.searchKey&&(r={summaryData:{[t?.searchKey]:Number(o)}}),["lastActivityPerformedBy","pendingOnUsers","progress"].includes(t?.searchKey)||(r={summaryData:{[t?.searchKey]:o}})):r={},this.sendSearchCallForFilters(r)})})}))}sendSearchCallForFilters(i){this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,void 0,void 0,i).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results?.map(o=>({...o,isVisible:!0})),this.createdByUsers=t?.results?.map(o=>o?.subModuleId?.createdBy)})}fetchSummaryDataForValues(i,t){this.subscriptions.push(this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).subscribe(o=>{this.summaryData=o.results[i]?.summaryData,this.bindValueFromSummaryData(this.summaryData,t)}))}checkIfUserisAdmin(i){return i?.map(t=>t?.id).includes(this.currentUser?.id)}checkIfUserIsFirstUser(i){if("inProgress"==i[0]?.status)return i[0]?.activeUsers?.includes(this.currentUser?.id)}checkIfUserisViewOnly(i){return i?.map(t=>t?.id).includes(this.currentUser?.id)}changeProgressColor(i){return i<=49?"#F15B41":i>49&&i<75?"#F9B71A":i>=75?"#32de84":"#fff"}showStatus(i){return 1===i?"Created":3===i?"Completed":2===i?"In Progress":4===i?"Draft":5===i?"Cancelled":6===i?"Deleted":"Rejected"}checkIfUserisPartofWorkflow(i){return i?.map(t=>t?._id)?.includes(this.currentUser?.id)}checkIfUserisActiveUser(i){return i?.flatMap(t=>"inProgress"==t?.status?t.activeUsers:null)?.filter(t=>t).includes(this.currentUser?.id)}checkIfUserisApprovedUser(i){return i?.flatMap(t=>t.approvedUsers)?.includes(this.currentUser?.id)}checkIfUserisCreator(){return this.createdByUsers?.includes(this.currentUser?.id)}getPendingOnUsers(i){return i?.map(t=>t?.fullName)}bindValueFromSummaryData(i,t){const o=this.tableHeaders.find(r=>r.field===t);if(o){let r=o?.key.split(" ")?.map(l=>l.toLowerCase()).join("-");return i[r]}return""}sendFilterValue(i){switch(i?.sortType){case"Created":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,1).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Completed":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,3).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"In Progress":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,2).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Draft":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,4).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Cancelled":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,5).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Deleted":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,6).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Sort by Ascending":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,"latest").pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Sort by Descending":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,"oldest").pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}}searchViaFilter(i){console.log(i)}sortFields(i,t,o){"asc"==t&&(this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,i,"asc").pipe((0,f.R)(this.destroy$)).subscribe(r=>{this.submissionData=r,this.tableDataValue=r?.results?.map(l=>({...l,isVisible:!0})),this.createdByUsers=r?.results?.map(l=>l?.subModuleId?.createdBy)}),this.tableHeaders[o].showUpIcon=!1,this.tableHeaders[o].showDownIcon=!0),"desc"==t&&(this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,i).pipe((0,f.R)(this.destroy$)).subscribe(r=>{this.submissionData=r,this.tableDataValue=r?.results?.map(l=>({...l,isVisible:!0})),this.createdByUsers=r?.results?.map(l=>l?.subModuleId?.createdBy)}),this.tableHeaders[o].showUpIcon=!0,this.tableHeaders[o].showDownIcon=!1)}resetFilterValues(i){i&&this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}trackByFn(i,t){return t?.id}addSubmissionRoute(){this.router.navigate([`/modules/${(0,d.rV)(d.MX.moduleSlug)}/add-submission`,this.submoduleId])}editWorkflowRoute(i,t){(0,d.LS)(d.MX.formKey,t),(0,d.LS)(d.MX.formID,i),this.router.navigate(["/modules",(0,d.rV)(d.MX.moduleSlug),t,i])}goToPage(i){this.page=i+1,this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).pipe((0,f.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe(),this.subscriptions.forEach(i=>i.unsubscribe())}}function oi(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",9)(1,"a",10),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(2);return e.KtG(r.addSubmissionRoute())}),e._uU(2,"+ Add submission"),e.qZA()()}}function si(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"app-table-view",3),e.NdJ("emitPagination",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.sendPagination(r))})("emitDeleteEvent",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.itemDeleted(r))})("emitPageChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.fetchFreshData(r))}),e.qZA(),e.TgZ(2,"div",4),e._UZ(3,"hr"),e.qZA(),e.TgZ(4,"div",5)(5,"div",6),e.YNc(6,oi,3,0,"div",7),e.ALo(7,"async"),e.ALo(8,"async"),e.ALo(9,"async"),e.ALo(10,"async"),e.ALo(11,"async"),e.qZA(),e._UZ(12,"app-submission-table",8),e.qZA(),e.BQk()}if(2&s){const t=i.ngIf,o=e.oxw();let r;e.xp6(1),e.Q6J("moduleData",o.moduleData)("tableData",t),e.xp6(5),e.Q6J("ngIf",(null==(r=e.lcZ(7,4,o.moduleData))||null==r.formIds?null:r.formIds.length)>0&&(1==o.userRoleCheckAdmin&&1==o.checkIfAdminUserIsOnFirstStep(null==(r=e.lcZ(8,6,o.moduleData))||null==r.workFlowId||null==r.workFlowId.stepIds[0]?null:r.workFlowId.stepIds[0].approverIds)||o.checkIfUserisAdmin(null==(r=e.lcZ(9,8,o.moduleData))?null:r.adminUsers)||1==o.userRoleCheckSys||0==(null==o.currentUser||null==o.currentUser.roles?null:o.currentUser.roles.length)||0==o.disableModify(null==(r=e.lcZ(10,10,o.moduleData))?null:r.accessType,null==(r=e.lcZ(11,12,o.moduleData))?null:r.adminUsers))),e.xp6(6),e.Q6J("moduleData",o.moduleData)}}function ri(s,i){1&s&&e._UZ(0,"app-table-loader")}Ae.\u0275fac=function(i){return new(i||Ae)(e.Y36($e.C),e.Y36(ne.e),e.Y36(q.s),e.Y36(a.F0),e.Y36(a.gz))},Ae.\u0275cmp=e.Xpm({type:Ae,selectors:[["app-submission-table"]],inputs:{submissionData:"submissionData",moduleData:"moduleData"},standalone:!0,features:[e.jDz],decls:7,vars:2,consts:[[4,"ngIf","ngIfElse"],["noData",""],["dropdown",""],["hint",""],[1,"relative","overflow-x-auto","rounded-lg","shadow-lg","border","border-[#a58f81]"],[1,"text-sm","text-white","bg-[#a58f81]","px-4","py-5","w-full","flex","justify-between"],[1,"w-1/3"],["tuiDropdownAlign","left",3,"content","open","openChange"],["tuiIconButton","","type","button","size","m","appearance","custom","icon","tuiIconMenuLarge","tuiHintDirection","right",1,"tui-space_left-3","tui-space_top-2","border","border-[#a58f81]","bg-white",3,"tuiHint"],[1,"font-medium","text-base","mb-1"],[3,"formControl","tuiTextfieldLabelOutside"],["tuiTextfield","","placeholder","Choose data to display"],[3,"items",4,"tuiDataList"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"text-xs","text-white","uppercase","bg-[#a58f81]"],[4,"ngFor","ngForOf"],["scope","col",1,"px-6","py-3","text-sm","mb-1"],["showSubmissions",""],[1,"pt-10","pb-6"],[3,"length","index","indexChange"],[3,"items"],[3,"ngClass",4,"ngIf"],[3,"ngClass"],["otherFilters",""],[3,"filterBy","items","searchEnabled","applyStatus","resetFilters"],[4,"ngIf"],["type","text",1,"form-control",3,"formControl"],["new","","src","tuiIconArrowUp","class","cursor-pointer -ml-2 -mt-1",3,"click",4,"ngIf"],["new","","src","tuiIconArrowDown","class","cursor-pointer -ml-2 -mt-1",3,"click",4,"ngIf"],["new","","src","tuiIconArrowUp",1,"cursor-pointer","-ml-2","-mt-1",3,"click"],["new","","src","tuiIconArrowDown",1,"cursor-pointer","-ml-2","-mt-1",3,"click"],["colspan","12","role","row",1,"px-5","py-10","text-lg","text-center"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","border-b","border-gray-300"],[1,"px-5","py-4"],["style","all: unset;",4,"ngIf"],["title","Edit Submission","class","px-2 py-1 ml-2 text-xs font-medium text-white no-underline bg-blue-400 rounded-md cursor-pointer hover:text-white",3,"routerLink","click",4,"ngIf"],[1,"py-4",3,"ngClass"],[3,"ngSwitch"],[4,"ngSwitchCase"],[4,"ngSwitchDefault"],[1,"flex","justify-between","px-2","py-4",3,"ngClass"],["tuiProgressBar","","max","100","size","s",1,"w-9/12","mt-1.5",3,"color","value"],[2,"all","unset"],["title","Perform Workflow Action","class","px-2 py-1 ml-2 text-xs font-medium text-white no-underline bg-green-400 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],["title","View Submission","class","px-2 py-1 ml-2 text-xs font-medium text-white no-underline bg-green-400 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],["title","Perform Workflow Action",1,"px-2","py-1","ml-2","text-xs","font-medium","text-white","no-underline","bg-green-400","rounded-md","cursor-pointer","hover:text-white",3,"click"],["aria-hidden","true",1,"fa","fa-pencil"],["title","View Submission",1,"px-2","py-1","ml-2","text-xs","font-medium","text-white","no-underline","bg-green-400","rounded-md","cursor-pointer","hover:text-white",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg"],["title","Edit Submission",1,"px-2","py-1","ml-2","text-xs","font-medium","text-white","no-underline","bg-blue-400","rounded-md","cursor-pointer","hover:text-white",3,"routerLink","click"],["aria-hidden","true",1,"fa","fa-edit","fa-lg"],[1,"flex","flex-col","items-start","justify-center","gap-y-4","rounded-lg","shadow-lg","px-3","py-3"],[1,"font-semibold","text-base"],["class","flex gap-x-2 mt-4",4,"ngFor","ngForOf"],[1,"text-xxs","mt-2","invisible"],[1,"underline"],[1,"flex","gap-x-2","mt-4"],[1,"mt-0.5",3,"formControl"],[1,"capitalize"],[1,"text-sm"]],template:function(i,t){if(1&i&&(e.YNc(0,Xn,24,10,"ng-container",0),e.YNc(1,ei,1,0,"ng-template",null,1,e.W1O),e.YNc(3,ni,8,1,"ng-template",null,2,e.W1O),e.YNc(5,ii,2,0,"ng-template",null,3,e.W1O)),2&i){const o=e.MAs(2);e.Q6J("ngIf",t.submissionData)("ngIfElse",o)}},dependencies:[n.ez,n.mk,n.sg,n.O5,n.RF,n.n9,n.ED,n.Ov,n.JJ,Ge.z,Je.V5,Je.iv,Le.i,Le.r,Be.X,c.UX,c.Fj,c.JJ,c.oH,be.fN,be.v0,a.Bz,a.rH,Ye.x,Ye.f,ue.Qf,se.MB,he.cn,he.xT,Pe.EI,Pe.PN,N.zX,N.eC,ye.gX,C.Jy,C.uJ,C.OI,Ke.jh,Ke.o1,Sn.Ek,Se.go,Se.D,Se.xn,Se.t6,Se.DM]});class Ee{constructor(i,t,o,r,l){this.dashBoardService=i,this.activatedRoute=t,this.transport=o,this.router=r,this.auth=l,this.limit=7,this.page=1,this.searchValue=new c.NI,this.destroy$=new x.x,this.currentUser=this.auth.currentUserValue,this.userRoleCheckAdmin=this.auth.checkIfRolesExist("admin"),this.userRoleCheckUser=this.auth.checkIfRolesExist("user"),this.userRoleCheckSys=this.auth.checkIfRolesExist("sysAdmin"),this.activatedRoute.params.pipe((0,Cn.j)("name"),(0,wn.U)(g=>((0,d.LS)(d.MX.moduleSlug,g),this.moduleSlug=g,g)),(0,f.R)(this.destroy$)).subscribe(g=>{this.subModuleData=this.dashBoardService.getSubModuleByModuleSlug(g,this.limit,this.page)}),this.activatedRoute.queryParams.pipe((0,f.R)(this.destroy$)).subscribe(g=>{g.moduleID&&((0,d.LS)(d.MX.moduleID,g.moduleID),this.transport.moduleID.next(g.moduleID),this.moduleData=this.dashBoardService.getSubModuleByID(g.moduleID))})}disableModify(i,t){return!!("disabled"==i||t?.length>0&&t?.map(o=>o?.id).includes(this.currentUser?.id))}addSubmissionRoute(){this.router.navigate([`/modules/${(0,d.rV)(d.MX.moduleSlug)}/add-submission`,this.transport.moduleID?.value])}checkIfUserisAdmin(i){return i?.map(t=>t?.id).includes(this.currentUser?.id)}fetchFreshData(i){i&&(this.subModuleData=this.dashBoardService.getSubModuleByModuleSlug((0,d.rV)(d.MX.moduleSlug),this.limit,1),this.moduleData=this.dashBoardService.getSubModuleByID((0,d.rV)(d.MX.moduleID)))}itemDeleted(i){1==i&&(this.subModuleData=this.dashBoardService.getSubModuleByModuleSlug(this.moduleSlug,this.limit,this.page))}sendPagination(i){i&&(this.page=i,this.subModuleData=this.dashBoardService.getSubModuleByModuleSlug(this.moduleSlug,this.limit,this.page))}checkIfAdminUserIsOnFirstStep(i){return i?.map(t=>t?.id)?.includes(this.currentUser?.id)}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}Ee.\u0275fac=function(i){return new(i||Ee)(e.Y36(q.s),e.Y36(a.gz),e.Y36(ae.R),e.Y36(a.F0),e.Y36(ne.e))},Ee.\u0275cmp=e.Xpm({type:Ee,selectors:[["ng-component"]],decls:7,vars:4,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-48","mb-10"],[4,"ngIf","ngIfElse"],["noData",""],[3,"moduleData","tableData","emitPagination","emitDeleteEvent","emitPageChange"],[1,"mt-8"],[1,"my-8"],[1,"flex","justify-end","mb-5"],["class","mt-2 cursor-pointer",4,"ngIf"],[3,"moduleData"],[1,"mt-2","cursor-pointer"],[1,"px-6","py-3","rounded-md","bg-[#a58f81]","text-white","no-underline","hover:text-white","text-base",3,"click"]],template:function(i,t){if(1&i&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0),e.YNc(2,si,13,14,"ng-container",1),e.ALo(3,"async"),e.YNc(4,ri,1,0,"ng-template",null,2,e.W1O),e.qZA(),e._UZ(6,"app-footer")),2&i){const o=e.MAs(5);e.xp6(2),e.Q6J("ngIf",e.lcZ(3,2,t.subModuleData))("ngIfElse",o)}},dependencies:[n.O5,$.G,de.c,Re.x,Be.X,Ae,n.Ov]});class Ie{resolve(i){return(0,d.rV)(d.MX.moduleSlug)}}Ie.\u0275fac=function(i){return new(i||Ie)},Ie.\u0275prov=e.Yz7({token:Ie,factory:Ie.\u0275fac,providedIn:"root"});var He=u(35601),Qe=u(29093),ai=u(82210);function li(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",23),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw();return e.KtG(g.activeIndex=l)}),e._uU(2),e.qZA(),e.BQk()}if(2&s){const t=i.$implicit;e.xp6(2),e.Oqu(t)}}function ui(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",25)(1,"div",26)(2,"a",27),e.NdJ("click",function(){e.CHM(t);const r=e.oxw(),l=r.index,g=r.$implicit,ee=e.oxw();return e.KtG(ee.sendFormForEdit(l,null==g?null:g._id,null==g?null:g.key))}),e._UZ(3,"i",28),e.qZA()(),e.TgZ(4,"formio",29,30),e.NdJ("change",function(r){e.CHM(t);const l=e.oxw().index,g=e.oxw();return e.KtG(g.onChange(r,l))}),e.qZA()()}if(2&s){const t=e.oxw().$implicit,o=e.oxw();e.xp6(4),e.Q6J("submission",t||o.formValues[o.activeIndex])("options",o.options)("form",t)}}function ci(s,i){if(1&s&&(e.ynx(0),e.YNc(1,ui,6,3,"div",24),e.BQk()),2&s){const t=i.index,o=e.oxw();e.xp6(1),e.Q6J("ngIf",1==o.userRoleCheck&&o.activeIndex==t)}}function di(s,i){1&s&&(e.TgZ(0,"span",52),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function mi(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"p",34),e._uU(2),e.qZA(),e.TgZ(3,"div",35)(4,"div",36)(5,"label",37),e._uU(6),e.TgZ(7,"span",38),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"custom-multi-select",39),e.NdJ("checkUsersLength",function(r){const g=e.CHM(t).index,ee=e.oxw(2);return e.KtG(ee.countUsers(r,g))})("approverList",function(r){const g=e.CHM(t).index,ee=e.oxw(2);return e.KtG(ee.getApproverList(r,g))}),e.qZA(),e.YNc(10,di,2,0,"span",40),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"div",36)(13,"label",41),e._uU(14,"Condition "),e.TgZ(15,"span",38),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"select",42),e.NdJ("change",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.validateSelection(l))}),e.TgZ(18,"option",43),e._uU(19,"AND"),e.qZA(),e.TgZ(20,"option",44),e._uU(21,"OR"),e.qZA(),e.TgZ(22,"option",45),e._uU(23,"NONE"),e.qZA()()(),e.TgZ(24,"div",46),e._UZ(25,"tui-tooltip",47),e.TgZ(26,"tui-badged-content",48)(27,"button",49),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2),ee=e.MAs(36);return e.KtG(g.openEmailNotifyModal(ee,g.workflows,l))}),e.qZA()()(),e.TgZ(28,"div",50)(29,"button",51),e.NdJ("click",function(){const l=e.CHM(t).index,g=e.oxw(2);return e.KtG(g.removeWorkflowStep(l))}),e.qZA()()(),e.BQk()}if(2&s){const t=i.index,o=i.first,r=e.oxw(2),l=e.MAs(38);let g;e.xp6(2),e.hij("Step ",0===t?"1":t+1,""),e.xp6(1),e.Q6J("formGroupName",t),e.xp6(3),e.hij("",o?"Creators":"Approvers"," "),e.xp6(4),e.Q6J("ngIf",e.lcZ(11,7,r.showError)&&t===r.errorIndex),e.xp6(15),e.Q6J("content",l),e.xp6(1),e.Q6J("contentTop",null==(g=r.workflows.at(t).get("emailNotifyTo"))||null==g.value?null:g.value.length)("colorTop","green")}}function pi(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"div",31)(1,"h4",1),e._uU(2,"Modify submodule workflow"),e.qZA(),e.ynx(3,32),e.YNc(4,mi,30,9,"ng-container",5),e.BQk(),e.TgZ(5,"button",33),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.addWorkflowStep())}),e.qZA()()}if(2&s){const t=e.oxw();e.Q6J("formGroup",t.workflowForm),e.xp6(4),e.Q6J("ngForOf",t.workflows.controls)}}function _i(s,i){if(1&s&&(e.TgZ(0,"ul",65)(1,"li",66),e._uU(2),e.qZA()()),2&s){const t=i.$implicit;e.xp6(2),e.Oqu(t)}}function gi(s,i){1&s&&e._UZ(0,"i",67)}function fi(s,i){if(1&s&&(e.TgZ(0,"div",58)(1,"div",59)(2,"p",60),e._uU(3),e.qZA(),e.YNc(4,_i,3,1,"ul",61),e.TgZ(5,"div",62),e._uU(6),e.qZA()(),e.TgZ(7,"div",63),e.YNc(8,gi,1,0,"i",64),e.qZA()()),2&s){const t=e.oxw(),o=t.index,r=t.$implicit,l=t.last;e.xp6(3),e.hij("Step ",o+1,""),e.xp6(1),e.Q6J("ngForOf",null==r?null:r.approvers),e.xp6(2),e.hij(" ",null==r?null:r.condition," "),e.xp6(2),e.Q6J("ngIf",!l)}}function hi(s,i){1&s&&(e.ynx(0),e.YNc(1,fi,9,4,"div",57),e.BQk())}function bi(s,i){if(1&s){const t=e.EpF();e.ynx(0),e.TgZ(1,"tui-island",53)(2,"h4",54),e._uU(3,"Workflow Steps"),e.qZA(),e.TgZ(4,"tui-carousel",55),e.NdJ("indexChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.carouselIndex=r)}),e.YNc(5,hi,2,0,"ng-container",5),e.qZA(),e.TgZ(6,"tui-pagination",56),e.NdJ("indexChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.carouselIndex=r)}),e.qZA()(),e.BQk()}if(2&s){const t=e.oxw();e.xp6(4),e.Q6J("draggable",!0)("itemsCount",3)("index",t.carouselIndex),e.xp6(1),e.Q6J("ngForOf",t.items),e.xp6(1),e.Q6J("length",(null==t.items?null:t.items.length)>2?(null==t.items?null:t.items.length)-2:null==t.items?null:t.items.length)("index",t.carouselIndex)}}function vi(s,i){1&s&&(e.ynx(0),e.TgZ(1,"p",68),e._uU(2,"Approval logs are empty!"),e.qZA(),e.BQk())}function yi(s,i){if(1&s&&(e.ynx(0),e.TgZ(1,"div",69)(2,"p",70),e._uU(3,"Performed by: \xa0 "),e.TgZ(4,"span",71),e._uU(5),e.qZA()(),e.TgZ(6,"p",72),e._uU(7,"Action: \xa0 "),e.TgZ(8,"span",73),e._uU(9),e.qZA()(),e.TgZ(10,"p",74),e._uU(11," Approved On: "),e.TgZ(12,"span",71),e._uU(13),e.ALo(14,"date"),e.qZA()(),e.TgZ(15,"p",70),e._uU(16,"Comments: "),e.TgZ(17,"span",71),e._uU(18),e.qZA()()(),e.BQk()),2&s){const t=i.$implicit;e.xp6(4),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-gray-600"),e.xp6(1),e.Oqu(null!=t&&t.onBehalfOf?(null==t||null==t.onBehalfOf?null:t.onBehalfOf.fullName)+" on behalf of "+(null==t||null==t.performedById?null:t.performedById.fullName):null==t||null==t.performedById?null:t.performedById.fullName),e.xp6(3),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-gray-600"),e.xp6(1),e.Oqu(null==t?null:t.approvalStatus),e.xp6(3),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-gray-600"),e.xp6(1),e.hij("\xa0",e.xi3(14,8,null==t?null:t.approvedOn,"medium"),""),e.xp6(4),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-gray-600"),e.xp6(1),e.hij("\xa0",null==t?null:t.remarks,"")}}function xi(s,i){if(1&s&&e._UZ(0,"tui-data-list-wrapper",83),2&s){const t=e.oxw(2);e.Q6J("items",t.userListForEmail)}}function Ti(s,i){if(1&s){const t=e.EpF();e.TgZ(0,"p",75),e._uU(1,"Email Notification Users"),e.qZA(),e.TgZ(2,"p",76),e._uU(3," Please specify the users you want to send the notification email to "),e.qZA(),e.TgZ(4,"div",77)(5,"tui-input-tag",78),e.NdJ("searchChange",function(r){e.CHM(t);const l=e.oxw();return e.KtG(l.onSearchChange(r))}),e._uU(6," Type to search and press Enter to select... "),e.YNc(7,xi,1,1,"tui-data-list-wrapper",79),e.qZA()(),e.TgZ(8,"div",80)(9,"button",81),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.validateEmails())}),e._uU(10," Confirm & Close "),e.qZA(),e.TgZ(11,"button",82),e.NdJ("click",function(){e.CHM(t);const r=e.oxw();return e.KtG(r.cancelEmailNotify())}),e._uU(12," Remove Users & Close "),e.qZA()()}if(2&s){const t=e.oxw();e.xp6(5),e.Q6J("formControl",null==t.currentFieldArray||null==t.currentFieldArray.controls[t.activeEmailIndex]?null:t.currentFieldArray.controls[t.activeEmailIndex].controls.emailNotifyTo)("tuiTextfieldLabelOutside",!0)}}function Ci(s,i){1&s&&(e.TgZ(0,"strong",84),e._uU(1,"How conditions work?"),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"ul",85)(4,"li")(5,"strong"),e._uU(6,"AND"),e.qZA(),e._uU(7," implies that every user of the step must provide approval"),e.qZA(),e.TgZ(8,"li",86)(9,"strong"),e._uU(10,"OR"),e.qZA(),e._uU(11," implies that any one of the users may provide approval"),e.qZA(),e.TgZ(12,"li")(13,"strong"),e._uU(14,"NONE"),e.qZA(),e._uU(15," implies that there is only one user per step and hence no conditon is necessary"),e.qZA()())}class Ne{constructor(i,t,o,r,l,g,ee,xe,re){this.auth=i,this.notif=t,this.router=o,this.fb=r,this.dashboard=l,this.workflowService=g,this.dialogs=ee,this.activatedRoute=xe,this.location=re,this.formTabs=[],this.activeIndex=0,this.options={disableAlerts:!0,noDefaultSubmitButton:!0},this.items=[],this.activeItemIndex=0,this.limit=10,this.page=0,this.destroy$=new x.x,this.search$=new x.x,this.userListForEmail=[],this.saveDialogSubscription=[],this.creatingSubmission=new x.x,this.carouselIndex=0,this.errorIndex=0,this.showError=new x.x,this.formSubmission=new k.X([]),this.formValues=[],this.approvalLogs=[],this.currentUser=this.auth.currentUserValue,this.userRoleCheck=this.auth.checkIfRolesExist("sysAdmin"),this.initWorkflowForm(),this.activatedRoute.params.pipe((0,f.R)(this.destroy$)).subscribe(V=>{this.subModuleId=V.id,this.fetchAndPopulateData(this.subModuleId)}),this.search$.pipe((0,L.w)(V=>this.dashboard.getAllUsersForListing(this.limit,this.page,V))).subscribe(V=>{V&&(this.userListForEmail=V?.results?.map(P=>P?.email))}),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,f.R)(this.destroy$)).subscribe(V=>{V&&(this.userListForEmail=V?.results?.map(P=>P?.email))})}ngOnInit(){const i=(0,d.rV)(d.MX.navHierarchy);i.forEach(t=>{t.routerLink=`/modules/${t.code}?moduleID=${(0,d.rV)(d.MX.moduleID)}`}),this.dashboard.items=[...i,{caption:(0,d.rV)(d.MX.formKey)||"Edit Submission",routerLink:`/modules/${(0,d.rV)(d.MX.moduleSlug)}/${(0,d.rV)(d.MX.formKey)||"Edit Submission"}`}]}fetchAndPopulateData(i){this.workflowService.getWorkflowSubmission(i).pipe((0,f.R)(this.destroy$)).subscribe(t=>{if(t){this.subModuleData=t,this.workFlowId=t?.workFlowId?._id,this.approvalLogs=t?.approvalLog,this.forms=t?.formIds?.map(r=>(r.components?.map(l=>{l?.permissions?.length>0&&l?.permissions?.map(g=>{this.currentUser?.id==g?.id&&(l.disabled=1!=g.canEdit,l.hidden=0==g.canView)})}),{...r,components:r?.components?.map(l=>(l?.label&&"Submit"==l?.label&&(l.hidden=!0),l)),formDataId:t?.formDataIds?.map(l=>{if(l.formId==r?._id)return l?._id}).filter(l=>l)[0],data:t?.formDataIds?.map(l=>{if(l.formId==r?._id)return l?.data}).filter(l=>l)[0]})),this.formTabs=t?.formIds?.map(r=>r.title),this.items=t?.workFlowId?.stepIds?.map(r=>({approvers:r?.approverIds?.map(l=>l?.fullName),condition:r?.condition,emailNotifyTo:r?.emailNotifyToId?.notifyUsers||[]}));const o=t?.workFlowId?.stepIds?.map(r=>({id:r?.id,approverIds:r?.approverIds?.map(l=>({name:l?.fullName,id:l?._id,control:new c.NI(!0)})),condition:r?.condition,emailNotifyTo:r?.emailNotifyToId?.notifyUsers||[],emailNotifyToId:r?.emailNotifyToId?.id}));delete this.subModuleData?.workFlowId,Object.assign(this.subModuleData,{workFlowId:o}),this.initWorkflowForm(o)}})}checkApprovalLogs(){return this.approvalLogs?.map(i=>i?.approvalStatus)?.includes("approved")||this.approvalLogs?.map(i=>i?.approvalStatus)?.includes("created")}initWorkflowForm(i){this.workflowForm=this.fb.group(i?{workflows:this.fb.array(i?.map(t=>this.fb.group({id:t.id,condition:[t.condition,c.kI.required],approverIds:[t.approverIds,c.kI.required],emailNotifyTo:[t.emailNotifyTo||[],c.kI.required],emailNotifyToId:t?.emailNotifyToId})))}:{workflows:this.fb.array([this.fb.group({condition:["",c.kI.required],approverIds:[[],c.kI.required],emailNotifyTo:[[],c.kI.required]})])})}get workflows(){return this.workflowForm.controls.workflows}addWorkflowStep(){const i=this.fb.group({approverIds:[[],c.kI.required],condition:[{value:"",disabled:""},c.kI.required],emailNotifyTo:[[],c.kI.required]});this.workflows.push(i)}removeWorkflowStep(i){this.workflows.removeAt(i)}getApproverList(i,t){this.workflows.at(t)?.get("approverIds")?.setValue(i)}sendFormForEdit(i,t,o){if(t){let r=this.workflows?.value?.flatMap(l=>l?.approverIds?.map(g=>({id:g.id,name:g.name})));if(0==r.length)return this.notif.displayNotification("Please create a default workflow before adding forms","Default Workflow","warning");(0,d.LS)(d.MX.formKey,o),(0,d.LS)(d.MX.approvers,r),this.router.navigate(["/forms/edit-form"],{queryParams:{id:t}})}}dataSubmitValidation(){return!(0==this.workflows?.length||this.workflows.controls.map(i=>0==i.get("approverIds")?.value.length).includes(!0)||!0===this.workflows.controls.map(i=>i.get("condition")?.value).includes(""))}openEmailNotifyModal(i,t,o){this.activeEmailIndex=o,this.currentFieldArray=t,this.saveDialogSubscription.push(this.dialogs.open(i,{dismissible:!1,closeable:!1}).subscribe())}onSearchChange(i){this.search$.next(i)}validateEmails(){let i=this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.value;i=i.map(t=>!!/\S+@\S+\.\S+/.test(t)),i.includes(!1)?this.notif.displayNotification("Please provide valid email addresses","Email Notify","warning"):this.saveDialogSubscription.forEach(t=>t.unsubscribe())}cancelEmailNotify(){this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.setValue([]),this.saveDialogSubscription.forEach(i=>i.unsubscribe())}countUsers(i,t){return this.errorIndex=t,i<2?(this.workflows.at(t)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info"),this.showError.next(!1)):i>=2&&"none"==this.workflows.at(t)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}validateSelection(i){return this.errorIndex=i,this.workflows.at(i)?.get("approverIds")?.value?.length<2?(this.workflows.at(i)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info"),this.showError.next(!1)):this.workflows.at(i)?.get("approverIds")?.value?.length>=2&&"none"==this.workflows.at(i)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}cancelSubmission(){this.router.navigate(["/modules",(0,d.rV)(d.MX.moduleSlug)||""],{queryParams:{moduleID:(0,d.rV)(d.MX.moduleID)||""}})}onChange(i,t){if(i?.data&&i?.changed&&i?.data?.file&&i?.data?.file?.forEach(o=>{o.url=o?.data?.baseUrl.split("v1")[0]+o?.data?.fileUrl}),i?.data&&i?.changed&&i?.isModified){const o=this.subModuleData?.formDataIds[this.activeIndex]?._id;this.formValues[this.activeIndex]={...i,id:o};const r=this.formValues?.map(l=>({_id:l?.id,data:l?.data}));this.formSubmission.next(r)}}editSubmission(i){if(!this.formioComponent.submission)return this.notif.displayNotification("Please provide valid submission data","Create Submission","warning");if(this.formioComponent.submission&&0==this.formioComponent.submission?.isValid)return this.notif.displayNotification("Form submission is invalid","Create Submission","warning");if(0==this.dataSubmitValidation())return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create Submission","warning");if(this.workflows.controls.map(o=>o.get("approverIds")?.value.length>1&&o.get("condition")?.value).includes("none"))return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create Submission","warning");this.creatingSubmission.next(!0);const t={workFlowId:this.workFlowId,formDataIds:this.formSubmission?.value,submissionStatus:i||1,type:"edit",steps:this.workflows?.value?.map(o=>({id:o?.id?o?.id:void 0,approverIds:o?.approverIds?.map(r=>r.id?r.id:r),condition:o?.condition,emailNotifyTo:o?.emailNotifyTo||[],emailNotifyToId:o?.emailNotifyToId?o?.emailNotifyToId:void 0}))};this.workflowService.updateSubmissionWorkflow(this.subModuleId,t).pipe((0,f.R)(this.destroy$)).subscribe(o=>{o&&(this.creatingSubmission.next(!0),this.location.back())})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}Ne.\u0275fac=function(i){return new(i||Ne)(e.Y36(ne.e),e.Y36(X.T),e.Y36(a.F0),e.Y36(c.qu),e.Y36(q.s),e.Y36($e.C),e.Y36(A.RO),e.Y36(a.gz),e.Y36(n.Ye))},Ne.\u0275cmp=e.Xpm({type:Ne,selectors:[["ng-component"]],viewQuery:function(i,t){if(1&i&&e.Gf(ke.k4,5),2&i){let o;e.iGM(o=e.CRH())&&(t.formioComponent=o.first)}},decls:39,vars:13,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52","pb-44"],[1,"text-lg","font-semibold"],[1,"flex","flex-col","w-full","px-5","mx-auto","mt-5","border","border-gray-400","border-dashed","rounded-md","bg-gray-50"],[1,"flex","justify-between","my-8","relative"],["tuiTabs","","vertical","left",1,"w-32","mr-5"],[4,"ngFor","ngForOf"],[3,"activeItemIndex","activeItemIndexChange"],["tuiTab",""],["src","tuiIconEye",1,"tui-space_right-2"],["src","tuiIconEdit",1,"tui-space_right-2"],["class","mt-12",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-end","gap-5","mt-8"],["tuiButton","","type","button","size","m","appearance","primary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","secondary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"my-4"],[1,"mb-5","text-lg","font-semibold"],[1,"grid","grid-cols-12"],[1,"col-span-12","w-[97.5%]"],["size","l",1,"w-full","shadow-lg"],["template",""],["hint",""],["tuiTab","",3,"click"],["class","w-full well jsonviewer",4,"ngIf"],[1,"w-full","well","jsonviewer"],[1,"absolute","-top-8","right-1","z-10"],["title","Edit Form",1,"rounded-md","cursor-pointer",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-square","fa-2x","text-blue-500","hover:text-blue-600"],[3,"submission","options","form","change"],["formioComponent",""],[1,"mt-12",3,"formGroup"],["formArrayName","workflows"],["tuiIconButton","","type","button","size","m","appearance","primary","icon","tuiIconPlusLarge",3,"click"],[1,"text-base","font-semibold","mt-7"],[1,"grid","grid-cols-12","gap-3","my-4",3,"formGroupName"],[1,"col-span-4"],[1,"block","pb-1"],[1,"text-xs","text-red-400"],["formControlName","approverIds",3,"checkUsersLength","approverList"],["class","text-xs text-red-500",4,"ngIf"],["for","conditionSelect",1,"block","pb-1"],["formControlName","condition","aria-label","Default select example","id","conditionSelect",1,"h-10","form-select","form-control",3,"change"],["value","and"],["value","or"],["value","none"],[1,"inline-flex","col-span-1","mt-8"],["direction","right",1,"mt-1","mr-4","-ml-2",3,"content"],[3,"contentTop","colorTop"],["tuiIconButton","","type","button","size","s","appearance","outline","icon","tuiIconMailLarge",3,"click"],[1,"col-span-1","mt-8","-ml-8"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2Large",3,"click"],[1,"text-xs","text-red-500"],["size","l",1,"w-[97.5%]","my-4","shadow-lg","border","border-[#F15B41]","px-5","mx-auto"],[1,"mb-5","text-base","font-semibold","text-gray-700"],[3,"draggable","itemsCount","index","indexChange"],["size","s",1,"my-5","pagination",3,"length","index","indexChange"],["class","flex justify-between w-full",4,"tuiItem"],[1,"flex","justify-between","w-full"],[1,"relative","w-full","px-4","py-4","text-left","border","border-gray-200","rounded-md","bg-gray-50"],[1,"mb-2","text-lg","font-semibold","text-gray-700"],["class","px-5",4,"ngFor","ngForOf"],[1,"absolute","top-0","right-0","px-3","py-1","text-sm","font-semibold","bg-gray-200","rounded-b-none","text-slate-700","rounded-r-md"],[1,"ml-4","mt-7"],["class","fa fa-long-arrow-right fa-lg","aria-hidden","true",4,"ngIf"],[1,"px-5"],[1,"list-disc"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-lg"],[1,"py-5","text-base","font-semibold","text-center","text-gray-500"],[1,"grid","grid-cols-12","py-3","border-b","border-gray-300","gap-x-3"],[1,"col-span-3","font-normal"],[1,"font-semibold",3,"ngClass"],[1,"col-span-2","font-normal"],[1,"font-semibold","capitalize",3,"ngClass"],[1,"col-span-4","font-normal"],[1,"text-lg","font-semibold","text-center"],[1,"mt-3","text-base","font-medium","text-gray-500"],[1,"flex","flex-col","justify-center","my-5"],[1,"b-form",3,"formControl","tuiTextfieldLabelOutside","searchChange"],[3,"items",4,"tuiDataList"],[1,"flex","justify-start","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["appearance","accent","tuiButton","","type","button","size","m",3,"click"],[3,"items"],[1,"text-base"],[1,"mt-2"],[1,"my-2"]],template:function(i,t){1&i&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0)(2,"p",1),e._uU(3,"Forms"),e.qZA(),e.TgZ(4,"div",2)(5,"section",3)(6,"nav",4),e.YNc(7,li,3,1,"ng-container",5),e.qZA(),e.YNc(8,ci,2,1,"ng-container",5),e.qZA()(),e.TgZ(9,"tui-tabs",6),e.NdJ("activeItemIndexChange",function(r){return t.activeItemIndex=r}),e.TgZ(10,"button",7),e._UZ(11,"tui-svg",8),e._uU(12," Approval Workflow "),e.qZA(),e.TgZ(13,"button",7),e._UZ(14,"tui-svg",9),e._uU(15," Modify Workflow "),e.qZA()(),e.YNc(16,pi,6,2,"div",10),e.YNc(17,bi,7,6,"ng-container",11),e.TgZ(18,"div",12)(19,"button",13),e.NdJ("click",function(){return t.editSubmission()}),e.ALo(20,"async"),e._uU(21," Update Submission "),e.qZA(),e.TgZ(22,"button",14),e.NdJ("click",function(){return t.editSubmission(4)}),e.ALo(23,"async"),e._uU(24," Save as Draft "),e.qZA(),e.TgZ(25,"button",15),e.NdJ("click",function(){return t.cancelSubmission()}),e._uU(26," Cancel "),e.qZA()(),e.TgZ(27,"section",16)(28,"p",17),e._uU(29,"Approval Logs"),e.qZA(),e.TgZ(30,"div",18)(31,"div",19)(32,"tui-island",20),e.YNc(33,vi,3,0,"ng-container",11),e.YNc(34,yi,19,11,"ng-container",5),e.qZA()()()()(),e.YNc(35,Ti,13,2,"ng-template",null,21,e.W1O),e.YNc(37,Ci,16,0,"ng-template",null,22,e.W1O)),2&i&&(e.xp6(7),e.Q6J("ngForOf",t.formTabs),e.xp6(1),e.Q6J("ngForOf",t.forms),e.xp6(1),e.Q6J("activeItemIndex",t.activeItemIndex),e.xp6(7),e.Q6J("ngIf",1==t.activeItemIndex),e.xp6(1),e.Q6J("ngIf",0==t.activeItemIndex),e.xp6(2),e.Q6J("showLoader",e.lcZ(20,9,t.creatingSubmission)),e.xp6(3),e.Q6J("showLoader",e.lcZ(23,11,t.creatingSubmission)),e.xp6(11),e.Q6J("ngIf",0==(null==t.approvalLogs?null:t.approvalLogs.length)),e.xp6(1),e.Q6J("ngForOf",t.approvalLogs))},dependencies:[n.mk,n.sg,n.O5,$.G,he.xT,N.eC,ye.gX,c.YN,c.Kr,c.EJ,c.JJ,c.JL,c.oH,c.sg,c.u,c.x0,c.CE,be.v0,ke.k4,Fe.e,p.H9,p.p_,p.uW,p.yu,ai.w,He.h,Qe.VF,Qe.EB,Le.r,h.V,Q.PZ,we.w,Pe.PN,n.Ov,n.uU]});const wi=[{path:"",component:J,resolve:{breadcrumb:Ie},children:[{path:":name",component:Ee,canActivate:[Jt.v]},{path:"add-module/:id",component:Oe,data:{breadcrumb:"Add App"}},{path:"edit-module/:id",component:Ue,data:{breadcrumb:"Edit App"}},{path:"edit-submission/:id",component:Ne,data:{breadcrumb:"Edit Submission"}},{path:":name",data:{preload:!0},loadChildren:()=>u.e(169).then(u.bind(u,99169)).then(s=>s.WorkflowsModule)},{path:"",component:J}]}];class Me{}Me.\u0275fac=function(i){return new(i||Me)},Me.\u0275mod=e.oAB({type:Me}),Me.\u0275inj=e.cJS({imports:[a.Bz.forChild(wi),a.Bz]});var Si=u(14375);class Ze{}Ze.\u0275fac=function(i){return new(i||Ze)},Ze.\u0275mod=e.oAB({type:Ze}),Ze.\u0275inj=e.cJS({imports:[n.ez,Me,$.G,de.c,Re.x,Si.N,ue.Qf,he.cn,N.zX,R.lm,C.Jy,c.UX,c.u5,be.fN,ke.XI,b,Ge.z,Fe.e,p.$$,He.y,Qe.Xj,Le.i,Je.V5,h.f,Q.cB,Be.X,we.Q,Se.go,De.dS,Ae,Pe.EI,Q.cB,ye.pc,ie.s]})},6229:(ge,oe,u)=>{u.d(oe,{C:()=>U});var n=u(34782),a=u(54004),d=u(61005),e=u(94650),J=u(80529),c=u(22603);class U extends d.s{constructor(k,x){super(k),this.http=k,this.notif=x}getWorkflowSubmission(k){return this.get(`/submissions/${k}`).pipe((0,n.d)(),(0,a.U)(x=>{if(!x.hasErrors())return x.data;x.errors[0].code&&![401,403].includes(x.errors[0].code)&&this.notif.displayNotification("Failed to fetch workflow","Get Submodule workflow","error")}))}getSubmissionFromSubModule(k,x,f,L,E,ne,ae){const q={subModuleId:k,limit:x,page:f,sortKey:E||void 0,sortBy:ne||void 0,submissionStatus:L||void 0};return null==q.submissionStatus&&delete q.submissionStatus,null==q.sortKey&&delete q.sortKey,null==q.sortBy&&delete q.sortBy,this.post("/submissions",ae||{},q).pipe((0,n.d)(),(0,a.U)(X=>X.hasErrors()?X.errors[0].code&&![401,403].includes(X.errors[0].code)?this.notif.displayNotification(X.errors[0]?.error?.message||"Failed to fetch submissions","Get Submissions","error"):void 0:X.data))}updateSubmissionWorkflow(k,x){return this.patch(`/submissions/${k}`,x).pipe((0,n.d)(),(0,a.U)(f=>f.hasErrors()?f.errors[0].code&&![401,403].includes(f.errors[0].code)?this.notif.displayNotification(f.errors[0]?.error?.message,"Update Submission","error"):void 0:(this.notif.displayNotification("Action complete. Submission updated","Update Submission","success"),f.data)))}addNewSubmission(k){return this.post("/submissions/create",k).pipe((0,n.d)(),(0,a.U)(x=>x.hasErrors()?x.errors[0].code&&![401,403].includes(x.errors[0].code)?this.notif.displayNotification(x.errors[0]?.error?.message,"Create Submission","error"):void 0:(this.notif.displayNotification("Submission created successfully","Create Submission","success"),x.data)))}updateFormsData(k,x){return this.patch(`/formsData/${x}`,k).pipe((0,n.d)(),(0,a.U)(f=>f.hasErrors()?f.errors[0].code&&![401,403].includes(f.errors[0].code)?this.notif.displayNotification(f.errors[0]?.error?.message,"Update Forms Data","error"):void 0:(this.notif.displayNotification("Form data updated successfully","Update Forms data","success"),f.data)))}updateMultipleFormsData(k){return this.patch("/formsData/multiple",k).pipe((0,n.d)(),(0,a.U)(x=>x.hasErrors()?x.errors[0].code&&![401,403].includes(x.errors[0].code)?this.notif.displayNotification(x.errors[0]?.error?.message,"Update Forms Data","error"):void 0:(this.notif.displayNotification("Form data updated successfully","Update Forms data","success"),x.data)))}updateWorkflowStep(k,x){return this.patch(`/submissions/workflow/${x}`,k).pipe((0,n.d)(),(0,a.U)(f=>f.hasErrors()?f.errors[0].code&&![401,403].includes(f.errors[0].code)?this.notif.displayNotification(f.errors[0]?.error?.message,"Update Workflow Step","error"):void 0:(this.notif.displayNotification(f?.data?.message,"Update Workflow Step","success"),f.data)))}}U.\u0275fac=function(k){return new(k||U)(e.LFG(J.eN),e.LFG(c.T))},U.\u0275prov=e.Yz7({token:U,factory:U.\u0275fac,providedIn:"root"})},55314:(ge,oe,u)=>{u.d(oe,{X:()=>e});var n=u(36895),a=u(94650);function d(J,c){1&J&&(a.ynx(0),a.TgZ(1,"tr",12)(2,"td",13),a._UZ(3,"span",14),a.qZA(),a.TgZ(4,"td",13),a._UZ(5,"span",14)(6,"br")(7,"span",15),a.qZA(),a.TgZ(8,"td",13),a._UZ(9,"span",14),a.qZA(),a.TgZ(10,"td",13),a._UZ(11,"span",14),a.qZA(),a.TgZ(12,"td",13),a._UZ(13,"span",16)(14,"br")(15,"span",15),a.qZA(),a.TgZ(16,"td",13),a._UZ(17,"span",17),a.qZA()(),a.BQk())}class e{constructor(){this.Arr=Array,this.num=6}}e.\u0275fac=function(c){return new(c||e)},e.\u0275cmp=a.Xpm({type:e,selectors:[["app-table-loader"]],standalone:!0,features:[a.jDz],decls:25,vars:1,consts:[["role","status",1,"w-full","animate-pulse","flex","justify-between"],[1,"my-4"],[1,"h-3","bg-gray-200","rounded-full","w-48","mb-4"],[1,"h-3","bg-gray-200","rounded-full","w-[360px]","my-2.5"],[1,"sr-only"],[1,"h-10","bg-gray-200","rounded-md","w-32","mt-8"],[1,"rounded-lg","shadow-lg"],[1,"w-full","mt-10"],[1,"text-center","border-b-2","border-gray-300","border-dotted","bg-[#eae4d8]"],[1,"py-2"],[1,"inline-block","py-1","mt-2","mb-2","bg-gray-300","border-2","rounded-sm","px-14"],[4,"ngFor","ngForOf"],[1,"z-50","h-16","text-center","bg-white","border-b-2","border-gray-300","border-dotted","rounded-lg","animate-pulse"],[1,"shadow-lg"],[1,"z-50","inline-block","px-16","py-2","mt-2","mb-2","bg-gray-300","rounded-sm"],[1,"z-50","inline-block","px-10","py-1","mt-1","mb-1","bg-gray-300","rounded-sm"],[1,"z-50","inline-block","px-16","py-2","mt-1","mb-1","bg-gray-300","rounded-sm"],[1,"z-50","inline-block","px-12","py-4","mt-2","mb-2","bg-gray-300","rounded-2xl"]],template:function(c,U){1&c&&(a.TgZ(0,"div",0)(1,"div",1),a._UZ(2,"div",2)(3,"div",2)(4,"div",3),a.TgZ(5,"span",4),a._uU(6,"Loading..."),a.qZA()(),a.TgZ(7,"div",1),a._UZ(8,"div",5),a.qZA()(),a.TgZ(9,"div",6)(10,"table",7)(11,"thead",8)(12,"th",9),a._UZ(13,"span",10),a.qZA(),a.TgZ(14,"th",9),a._UZ(15,"span",10),a.qZA(),a.TgZ(16,"th",9),a._UZ(17,"span",10),a.qZA(),a.TgZ(18,"th",9),a._UZ(19,"span",10),a.qZA(),a.TgZ(20,"th",9),a._UZ(21,"span",10),a.qZA(),a.TgZ(22,"th",9),a._UZ(23,"span",10),a.qZA()(),a.YNc(24,d,18,0,"ng-container",11),a.qZA()()),2&c&&(a.xp6(24),a.Q6J("ngForOf",U.Arr(U.num).fill(1)))},dependencies:[n.ez,n.sg],changeDetection:0})},6110:(ge,oe,u)=>{u.d(oe,{z:()=>ue});var n=u(94650),a=u(36895),d=u(91127),e=u(39367),J=u(44886),c=u(71115),U=u(56772),A=u(86679),k=u(77579),x=u(61135),f=u(78372),L=u(71884),E=u(82722),ne=u(90433),ae=u(60117);function q(N,R){if(1&N&&(n.TgZ(0,"div",7)(1,"tui-input",10)(2,"p",11),n._uU(3,"Search here..."),n.qZA(),n._UZ(4,"input",12),n.qZA()()),2&N){const C=n.oxw(2);n.xp6(1),n.Q6J("formControl",C.searchValue)("tuiTextfieldCleaner",!0)}}function X(N,R){if(1&N){const C=n.EpF();n.TgZ(0,"li",16),n.NdJ("click",function(){n.CHM(C);const te=n.oxw(2),le=te.index,O=te.$implicit,H=n.oxw(2);return n.KtG(H.setFilterAndApplyActive({index:le,sortType:O.name,applyOn:H.filterBy}))}),n.TgZ(1,"div",17)(2,"span"),n._uU(3),n.qZA(),n._UZ(4,"i",18),n.qZA()()}if(2&N){const C=n.oxw(2).$implicit;n.Q6J("ngClass","active"===C.status?"bg-blue-100 hover:bg-blue-100":"bg-white hover:bg-gray-100"),n.xp6(3),n.Oqu(C.name),n.xp6(1),n.Q6J("ngClass",C.icon)}}function K(N,R){if(1&N&&(n.ynx(0),n.YNc(1,X,5,3,"li",15),n.BQk()),2&N){const C=n.oxw(3);n.xp6(1),n.Q6J("ngIf",1==C.showSortCategories)}}function I(N,R){if(1&N){const C=n.EpF();n.TgZ(0,"li",16),n.NdJ("click",function(){n.CHM(C);const te=n.oxw(),le=te.index,O=te.$implicit,H=n.oxw(2);return n.KtG(H.setFilterAndApplyActive({index:le,sortType:O.name,applyOn:H.filterBy}))}),n.TgZ(1,"div",17)(2,"span"),n._uU(3),n.qZA(),n._UZ(4,"i",18),n.qZA()()}if(2&N){const C=n.oxw().$implicit;n.Q6J("ngClass","active"===C.status?"bg-blue-100 hover:bg-blue-100":"bg-white hover:bg-gray-100"),n.xp6(3),n.Oqu(C.name),n.xp6(1),n.Q6J("ngClass",C.icon)}}function Z(N,R){if(1&N&&(n.ynx(0),n.YNc(1,K,2,1,"ng-container",13),n.YNc(2,I,5,3,"ng-template",null,14,n.W1O),n.BQk()),2&N){const C=R.$implicit,Y=n.MAs(3);n.xp6(1),n.Q6J("ngIf","Sort by Ascending"==(null==C?null:C.name)||"Sort by Descending"==(null==C?null:C.name))("ngIfElse",Y)}}function M(N,R){if(1&N){const C=n.EpF();n.TgZ(0,"div",19)(1,"a",20),n.NdJ("click",function(){n.CHM(C);const te=n.oxw(2);return n.KtG(te.resetFilterValue())}),n._uU(2,"Reset Filters"),n.qZA()()}}function $(N,R){if(1&N&&(n.TgZ(0,"div",4)(1,"h4",5),n._uU(2),n.qZA(),n.YNc(3,q,5,2,"div",6),n.TgZ(4,"ul",7),n.YNc(5,Z,4,2,"ng-container",8),n.qZA(),n.YNc(6,M,3,0,"div",9),n.qZA()),2&N){const C=n.oxw();n.xp6(2),n.hij("Filter by ",C.filterBy,""),n.xp6(1),n.Q6J("ngIf",1==C.searchEnabled),n.xp6(2),n.Q6J("ngForOf",C.items)("ngForTrackBy",C.trackByFn),n.xp6(1),n.Q6J("ngIf",!0===C.isFilterApplied)}}function de(N,R){if(1&N&&(n.TgZ(0,"p"),n._uU(1),n.qZA()),2&N){const C=n.oxw();n.xp6(1),n.Oqu(C.isFilterApplied?"This filter is currently active":"Apply filters")}}class ue{constructor(){this.open=!1,this.destroy$=new k.x,this.searchEnabled=!0,this.showSortCategories=!0,this.disabled=!1,this.applyStatus=new n.vpe,this.resetFilters=new n.vpe,this.sendSearchToTable=new n.vpe,this.isFilterApplied=!1,this.previousFilterValues=new x.X([]),this.searchValue=new ne.NI,this.searchValue.valueChanges.pipe((0,f.b)(400),(0,L.x)(),(0,E.R)(this.destroy$)).subscribe(R=>{this.sendSearchToTable.emit(R||null)})}searchTableData(R,C){this.sendSearchToTable.emit({search:R,searchBy:C}),this.isFilterApplied=!0}setFilterAndApplyActive(R){1!=this.disabled&&(this.applyStatus.emit(R),this.items?.some(C=>C.name===R.sortType)&&(this.items.forEach(C=>{C.status=R.sortType===C.name?"active":"idle"}),this.isFilterApplied=!0))}areArraysEqual(R,C){if(R.length!==C.length)return!1;const Y=R.slice().sort((le,O)=>le.id-O.id),te=C.slice().sort((le,O)=>le.id-O.id);for(let le=0;le<Y.length;le++){const O=Y[le],H=te[le];for(let W in O)if(O[W]!==H[W])return!1}return!0}resetFilterValue(){this.isFilterApplied=!1,this.items.forEach(R=>R.status="idle"),this.resetFilters.emit("reset")}trackByFn(R,C){return C}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}ue.\u0275fac=function(R){return new(R||ue)},ue.\u0275cmp=n.Xpm({type:ue,selectors:[["filter"]],inputs:{items:"items",searchEnabled:"searchEnabled",showSortCategories:"showSortCategories",filterBy:"filterBy",disabled:"disabled"},outputs:{applyStatus:"applyStatus",resetFilters:"resetFilters",sendSearchToTable:"sendSearchToTable"},standalone:!0,features:[n.jDz],decls:6,vars:4,consts:[[3,"content","open","openChange"],["tuiIconButton","","tuiHintDirection","right","size","xs","icon","tuiIconFilter",3,"tuiHint","appearance"],["dropdown",""],["tooltip",""],[1,"px-5","py-3","w-80"],[1,"text-sm","font-semibold","my-3"],["class","my-3",4,"ngIf"],[1,"my-3"],[4,"ngFor","ngForOf","ngForTrackBy"],["class","cursor-pointer mt-5 mb-3 text-center",4,"ngIf"],["tuiTextfieldIconLeft","tuiIconSearchLarge",1,"w-full",3,"formControl","tuiTextfieldCleaner"],[1,"mt-2"],["tuiTextfield","","placeholder","Type to start searching..."],[4,"ngIf","ngIfElse"],["otherFilter",""],["class","px-2 py-3 my-1 text-sm rounded-lg cursor-pointer",3,"ngClass","click",4,"ngIf"],[1,"px-2","py-3","my-1","text-sm","rounded-lg","cursor-pointer",3,"ngClass","click"],[1,"flex","justify-between"],["aria-hidden","true",3,"ngClass"],[1,"cursor-pointer","mt-5","mb-3","text-center"],[1,"px-3","py-2","rounded-md","bg-[#ac2224]","text-white","text-sm","no-underline","hover:text-white",3,"click"]],template:function(R,C){if(1&R&&(n.TgZ(0,"tui-hosted-dropdown",0),n.NdJ("openChange",function(te){return C.open=te}),n._UZ(1,"button",1),n.YNc(2,$,7,5,"ng-template",null,2,n.W1O),n.qZA(),n.YNc(4,de,2,1,"ng-template",null,3,n.W1O)),2&R){const Y=n.MAs(3),te=n.MAs(5);n.Q6J("content",Y)("open",C.open),n.xp6(1),n.Q6J("tuiHint",te)("appearance",C.isFilterApplied?"primary":"secondary")}},dependencies:[a.ez,a.mk,a.sg,a.O5,d.jh,d.o1,e.fN,e.v0,U.zX,A.Qf,A.K3,A.wU,ae.MB,J.go,J.D,J.xn,J.t6,J.DM,ne.UX,ne.JJ,ne.oH,c.cn,c.be,c.aR],changeDetection:0})},14375:(ge,oe,u)=>{u.d(oe,{N:()=>f});var n=u(94650),a=u(36895),d=u(86679),e=u(90433),J=u(77579),c=u(78372),U=u(71884),A=u(82722),k=u(71115),x=u(60117);class f{constructor(){this.searchValue=new e.NI,this.destroy$=new J.x,this.searchStr=new n.vpe,this.searchValue.valueChanges.pipe((0,c.b)(400),(0,U.x)(),(0,A.R)(this.destroy$)).subscribe(E=>{this.searchStr.emit(E||null)})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}f.\u0275fac=function(E){return new(E||f)},f.\u0275cmp=n.Xpm({type:f,selectors:[["app-search-bar"]],outputs:{searchStr:"searchStr"},standalone:!0,features:[n.jDz],decls:4,vars:2,consts:[["tuiTextfieldIconLeft","tuiIconSearchLarge",1,"shadow-md",3,"formControl","tuiTextfieldCleaner"],[1,"mt-2"],["tuiTextfield","","placeholder","Type to start searching..."]],template:function(E,ne){1&E&&(n.TgZ(0,"tui-input",0)(1,"p",1),n._uU(2,"Search by app title"),n.qZA(),n._UZ(3,"input",2),n.qZA()),2&E&&n.Q6J("formControl",ne.searchValue)("tuiTextfieldCleaner",!0)},dependencies:[a.ez,d.Qf,d.K3,d.wU,x.MB,e.UX,e.JJ,e.oH,e.u5,k.cn,k.be,k.aR],changeDetection:0})},69952:(ge,oe,u)=>{u.d(oe,{x:()=>fe});var n=u(94650),a=u(36895),d=u(14375),e=u(19132),J=u(82176),c=u(80311),U=u(87819),A=u(39367),k=u(44886),x=u(13675),f=u(1163),L=u(4266),E=u(77579),ne=u(61135),ae=u(82722),q=u(59835),X=u(46954),K=u(20696),I=u(15274);const Z=["preview"],M=function(S){return["/modules/add-module",S]};function $(S,y){if(1&S&&(n.TgZ(0,"a",10),n._uU(1,"+ Add app "),n.qZA()),2&S){const _=n.oxw(2);n.Q6J("routerLink",n.VKq(1,M,_.moduleId))}}function de(S,y){if(1&S&&(n.TgZ(0,"span",11),n.ALo(1,"async"),n._uU(2," You can add new apps by clicking on this button "),n.qZA()),2&S){const _=n.oxw(2);n.Q6J("ngClass",0==(null==_.tableData||null==_.tableData.results?null:_.tableData.results.length)&&0==n.lcZ(1,1,_.showEmptyMessage)?"visible":"invisible")}}function ue(S,y){if(1&S&&(n.ynx(0),n.TgZ(1,"div",7),n.YNc(2,$,2,3,"a",8),n.YNc(3,de,3,3,"span",9),n.qZA(),n.BQk()),2&S){const _=y.ngIf,D=n.oxw();n.xp6(2),n.Q6J("ngIf",D.currentUser.id==(null==_?null:_.createdBy)||D.checkIfUserisAdmin(null==_?null:_.adminUsers)||1==D.userRoleCheck),n.xp6(1),n.Q6J("ngIf",D.currentUser.id==(null==_?null:_.createdBy)||D.checkIfUserisAdmin(null==_?null:_.adminUsers)||1==D.userRoleCheck)}}function N(S,y){1&S&&(n.ynx(0),n.TgZ(1,"div",12),n._UZ(2,"img",13),n.qZA(),n.TgZ(3,"p",14),n._uU(4," No results found! "),n.qZA(),n.BQk())}function R(S,y){1&S&&(n.ynx(0),n._UZ(1,"p"),n.BQk())}function C(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"a",29),n.NdJ("click",function(){n.CHM(_);const G=n.oxw(2).$implicit,ce=n.oxw(2);return n.KtG(ce.setSubmoduleSlug(null==G?null:G.code,null==G?null:G.id))}),n._UZ(1,"i",30),n.qZA()}}const Y=function(S){return["/modules/edit-module",S]};function te(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"a",31),n.NdJ("click",function(){n.CHM(_);const G=n.oxw(2).$implicit,ce=n.oxw(2);return n.KtG(ce.setEditSlug(null==G?null:G.code,null==G?null:G.id,null==G?null:G.title))}),n._UZ(1,"i",32),n.qZA()}if(2&S){const _=n.oxw(2).$implicit;n.Q6J("routerLink",n.VKq(1,Y,null==_?null:_.id))}}function le(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"a",33),n.NdJ("click",function(){n.CHM(_);const G=n.oxw(2).$implicit,ce=n.oxw(2),ve=n.MAs(13);return n.KtG(ce.showDialog(null==G?null:G.id,ve))}),n._UZ(1,"i",34),n.qZA()}}function O(S,y){if(1&S&&(n.ynx(0),n.TgZ(1,"div",18)(2,"div",19)(3,"div",20),n._UZ(4,"img",21),n.qZA(),n.TgZ(5,"div",22)(6,"h3",23),n._uU(7),n.qZA(),n.TgZ(8,"p",24),n._uU(9),n.qZA()()(),n.TgZ(10,"div",25),n.YNc(11,C,2,0,"a",26),n.YNc(12,te,2,3,"a",27),n.YNc(13,le,2,0,"a",28),n.qZA()(),n.BQk()),2&S){const _=n.oxw().$implicit,D=n.oxw(2);n.xp6(4),n.Q6J("src",null==_?null:_.image,n.LSH),n.xp6(3),n.hij(" ",null==_?null:_.title," "),n.xp6(2),n.Oqu(null==_?null:_.description),n.xp6(2),n.Q6J("ngIf",3!==(null==_?null:_.status)),n.xp6(1),n.Q6J("ngIf",(null==D.currentUser?null:D.currentUser.id)==(null==_?null:_.createdBy)||1==D.userRoleCheck&&0==D.checkIfUserisViewOnly(null==_?null:_.viewOnlyUsers)||D.checkIfUserisAdmin(null==_?null:_.adminUsers)),n.xp6(1),n.Q6J("ngIf",(null==D.currentUser?null:D.currentUser.id)==(null==_?null:_.createdBy)||1==D.userRoleCheck&&0==D.checkIfUserisViewOnly(null==_?null:_.viewOnlyUsers)||D.checkIfUserisAdmin(null==_?null:_.adminUsers))}}function H(S,y){1&S&&(n.ynx(0),n._UZ(1,"tui-badge",36),n.BQk())}function W(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"a",29),n.NdJ("click",function(){n.CHM(_);const G=n.oxw(3).$implicit,ce=n.oxw(2);return n.KtG(ce.setSubmoduleSlug(null==G?null:G.code,null==G?null:G.id))}),n._UZ(1,"i",30),n.qZA()}}function me(S,y){if(1&S&&(n.TgZ(0,"a",37),n._UZ(1,"i",32),n.qZA()),2&S){const _=n.oxw(3).$implicit;n.Q6J("routerLink",n.VKq(1,Y,null==_?null:_.id))}}function w(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"a",33),n.NdJ("click",function(){n.CHM(_);const G=n.oxw(3).$implicit,ce=n.oxw(2),ve=n.MAs(13);return n.KtG(ce.showDialog(null==G?null:G.id,ve))}),n._UZ(1,"i",34),n.qZA()}}function j(S,y){if(1&S&&(n.ynx(0),n.TgZ(1,"div",18)(2,"div",19)(3,"div",20),n._UZ(4,"img",21),n.qZA(),n.TgZ(5,"div",22)(6,"h3",23),n._uU(7),n.YNc(8,H,2,0,"ng-container",2),n.qZA(),n.TgZ(9,"p",24),n._uU(10),n.qZA()()(),n.TgZ(11,"div",25),n.YNc(12,W,2,0,"a",26),n.YNc(13,me,2,3,"a",35),n.YNc(14,w,2,0,"a",28),n.qZA()(),n.BQk()),2&S){const _=n.oxw(2).$implicit,D=n.oxw(2);n.xp6(4),n.Q6J("src",null==_?null:_.image,n.LSH),n.xp6(3),n.hij(" ",null==_?null:_.title," "),n.xp6(1),n.Q6J("ngIf",3===(null==_?null:_.status)),n.xp6(2),n.Oqu(null==_?null:_.description),n.xp6(2),n.Q6J("ngIf",3!==(null==_?null:_.status)),n.xp6(1),n.Q6J("ngIf",(null==D.currentUser?null:D.currentUser.id)==(null==_?null:_.createdBy)),n.xp6(1),n.Q6J("ngIf",(null==D.currentUser?null:D.currentUser.id)==(null==_?null:_.createdBy))}}function T(S,y){if(1&S&&(n.ynx(0),n.YNc(1,j,15,7,"ng-container",2),n.BQk()),2&S){const _=n.oxw().$implicit,D=n.oxw(2);n.xp6(1),n.Q6J("ngIf",(null==D.currentUser?null:D.currentUser.id)==(null==_?null:_.createdBy))}}function B(S,y){if(1&S&&(n.ynx(0),n.YNc(1,O,14,6,"ng-container",2),n.YNc(2,T,2,1,"ng-container",2),n.BQk()),2&S){const _=y.$implicit;n.xp6(1),n.Q6J("ngIf",3!==(null==_?null:_.status)),n.xp6(1),n.Q6J("ngIf",3==(null==_?null:_.status))}}function z(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"div",38)(1,"tui-pagination",39),n.NdJ("indexChange",function(G){n.CHM(_);const ce=n.oxw(2);return n.KtG(ce.goToPage(G))}),n.qZA()()}if(2&S){const _=n.oxw(2);n.xp6(1),n.Q6J("length",(null==_.tableData?null:_.tableData.totalPages)||1)("index",(null==_.tableData?null:_.tableData.page)-1||0)}}function pe(S,y){if(1&S&&(n.TgZ(0,"section",15),n.YNc(1,B,3,2,"ng-container",16),n.qZA(),n.YNc(2,z,2,2,"div",17),n.ALo(3,"async")),2&S){const _=n.oxw();n.xp6(1),n.Q6J("ngForOf",null==_.tableData?null:_.tableData.results),n.xp6(1),n.Q6J("ngIf",0==n.lcZ(3,2,_.showEmptyMessage))}}function Te(S,y){if(1&S){const _=n.EpF();n.TgZ(0,"p",40),n._uU(1,"Delete App"),n.qZA(),n.TgZ(2,"p",41),n._uU(3,"Are you sure you want to delete this app?"),n.qZA(),n.TgZ(4,"div",42)(5,"button",43),n.NdJ("click",function(){const ce=n.CHM(_).$implicit;return n.oxw().deleteModule(),n.KtG(ce.complete())}),n._uU(6," Confirm "),n.qZA(),n.TgZ(7,"button",44),n.NdJ("click",function(){const ce=n.CHM(_).$implicit;return n.KtG(ce.complete())}),n._uU(8," Cancel "),n.qZA()()}}class fe{constructor(y,_,D,G,ce,ve,Ce){this.activatedRoute=y,this.dialogs=_,this.dashboardService=D,this.transport=G,this.auth=ce,this.router=ve,this.previewDialogService=Ce,this.tableColumns=["Title","Company Name","Status"],this.tableData=[],this.fetchingTableData=new E.x,this.filterMenuCompany=[{name:"Sort by Acsending",status:"idle",icon:"fa fa-sort-alpha-asc fa-lg",sortBy:"Company Name"},{name:"Sort by Descending",status:"idle",icon:"fa fa-sort-alpha-desc fa-lg",sortBy:"Company Name"},{name:"Sort by Latest",status:"idle",icon:"fa fa-calendar-check-o fa-lg",sortBy:"Company Name"},{name:"Sort by Oldest",status:"idle",icon:"fa fa-calendar-times-o fa-lg",sortBy:"Company Name"}],this.filterMenuSubmodule=[{name:"Sort by Acsending",status:"idle",icon:"fa fa-sort-alpha-asc fa-lg",sortBy:"Submodule Code"},{name:"Sort by Descending",status:"idle",icon:"fa fa-sort-alpha-desc fa-lg",sortBy:"Submodule Code"},{name:"Sort by Latest",status:"idle",icon:"fa fa-calendar-check-o fa-lg",sortBy:"Submodule Code"},{name:"Sort by Oldest",status:"idle",icon:"fa fa-calendar-times-o fa-lg",sortBy:"Submodule Code"}],this.filterMenuModule=[{name:"Sort by Acsending",status:"idle",icon:"fa fa-sort-alpha-asc fa-lg"},{name:"Sort by Descending",status:"idle",icon:"fa fa-sort-alpha-desc fa-lg"},{name:"Sort by Latest",status:"idle",icon:"fa fa-calendar-check-o fa-lg"},{name:"Sort by Oldest",status:"idle",icon:"fa fa-calendar-times-o fa-lg"}],this.statusMenu=[{name:"Draft",status:"idle",icon:""},{name:"Published",status:"idle",icon:""}],this.page=1,this.destroy$=new E.x,this.isFilterApplied=!1,this.showEmptyMessage=new ne.X(!1),this.emitDeleteEvent=new n.vpe,this.emitPagination=new n.vpe,this.emitFilters=new n.vpe,this.emitSearch=new n.vpe,this.emitPageChange=new n.vpe,this.currentUser=this.auth.currentUserValue,this.userRoleCheck=this.auth.checkIfRolesExist("sysAdmin"),this.activatedRoute.queryParams.subscribe(v=>this.moduleId=v.moduleID),this.activatedRoute.params.subscribe(v=>{this.transport.moduleCode.next(v.name),this.moduleCode=v.name})}showDialog(y,_){y&&(this.submoduleID=y,this.dialogs.open(_).subscribe())}deleteModule(){this.dashboardService.deleteSubModule(this.submoduleID).subscribe(y=>{this.emitDeleteEvent.emit(!0)})}showImage(y){this.currentImg=y,this.previewDialogService.open(this.preview).pipe((0,ae.R)(this.destroy$)).subscribe()}showStatus(y){return 1==y?"Published":3==y?"Draft":"Deleted"}splitURL(y){return y.split("/").at(-1)}checkIfUserisViewOnly(y){return y.includes(this.currentUser?.id)}checkIfUserisAdmin(y){return y?.map(_=>_?.id).includes(this.currentUser?.id)}goToPage(y){this.page=y+1,this.emitPagination.emit(this.page)}floorNumber(y){return Math.round(y)}getSortType(y){return"Sort by Latest"==y?.sortType?"latest":"Sort by Oldest"==y?.sortType?"oldest":"Sort by Descending"==y?.sortType?"desc":"asc"}sendFilters(y){if(y){this.fetchingTableData.next(!0);const _={field:"Submodule Code"==y?.applyOn?"subModuleCode":"companyName",sortByTime:1==["latest","oldest"].includes(this.getSortType(y))?this.getSortType(y):void 0,sortBy:1==["asc","desc"].includes(this.getSortType(y))?this.getSortType(y):void 0};null==_.sortBy&&delete _.sortBy,null==_.sortByTime&&delete _.sortByTime,this.dashboardService.getSubModuleByModuleSlug((0,L.rV)(L.MX.moduleSlug),7,this.page,_).pipe((0,ae.R)(this.destroy$)).subscribe(D=>{this.tableData=D,this.fetchingTableData.next(!1)})}}sendSearchValue(y){this.fetchingTableData.next(!0);const _={field:"subModuleTitle",search:y};null==_.search&&delete _.search,this.dashboardService.getSubModuleByModuleSlug((0,L.rV)(L.MX.moduleSlug),7,this.page,_).pipe((0,ae.R)(this.destroy$)).subscribe(D=>{0==D?.results?.length&&this.showEmptyMessage.next(!0),y||this.showEmptyMessage.next(!1),this.tableData=D,this.fetchingTableData.next(!1)})}resetFilterValues(y){this.fetchingTableData.next(!0),y&&this.dashboardService.getSubModuleByModuleSlug((0,L.rV)(L.MX.moduleSlug),7,this.page).pipe((0,ae.R)(this.destroy$)).subscribe(_=>{this.tableData=_,this.fetchingTableData.next(!1)})}setSubmoduleSlug(y,_){(0,L.LS)(L.MX.moduleSlug,y),(0,L.LS)(L.MX.moduleID,_),this.emitPageChange.emit({code:y,id:_}),this.router.navigate(["/modules",y],{queryParams:{moduleID:_||""}})}setEditSlug(y,_,D){(0,L.LS)(L.MX.editmoduleSlug,y),(0,L.LS)(L.MX.editmoduleTitle,D),(0,L.LS)(L.MX.editmoduleId,_)}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}fe.\u0275fac=function(y){return new(y||fe)(n.Y36(e.gz),n.Y36(f.RO),n.Y36(X.s),n.Y36(K.R),n.Y36(I.e),n.Y36(e.F0),n.Y36(q.iK))},fe.\u0275cmp=n.Xpm({type:fe,selectors:[["app-table-view"]],viewQuery:function(y,_){if(1&y&&n.Gf(Z,5),2&y){let D;n.iGM(D=n.CRH())&&(_.preview=D.first)}},inputs:{tableColumns:"tableColumns",tableData:"tableData",moduleData:"moduleData"},outputs:{emitDeleteEvent:"emitDeleteEvent",emitPagination:"emitPagination",emitFilters:"emitFilters",emitSearch:"emitSearch",emitPageChange:"emitPageChange"},standalone:!0,features:[n.jDz],decls:14,vars:14,consts:[[1,"flex","justify-between","mt-5","mb-2"],[1,"w-1/3","mb-2",3,"searchStr"],[4,"ngIf"],["size","xl",3,"overlay","showLoader"],[4,"ngIf","ngIfElse"],["showSubModules",""],["template",""],[1,"relative","mt-5","cursor-pointer"],["class","px-6 py-3 rounded-md bg-[#F15B41] text-white no-underline hover:text-white text-base",3,"routerLink",4,"ngIf"],["class","tooltiptext",3,"ngClass",4,"ngIf"],[1,"px-6","py-3","rounded-md","bg-[#F15B41]","text-white","no-underline","hover:text-white","text-base",3,"routerLink"],[1,"tooltiptext",3,"ngClass"],[1,"flex","items-center","justify-center"],["src","../../../assets/empty-box.svg","alt","empty_box","width","240","height","240"],[1,"px-5","text-lg","font-semibold","text-center","text-gray-500"],[1,"grid","grid-cols-12","gap-4"],[4,"ngFor","ngForOf"],["class","py-6",4,"ngIf"],[1,"bg-white","rounded-md","shadow-lg","h-auto","drop-shadow-lg","flex","flex-col","col-span-4","border-t-8","border-t-[#F15B41]"],[1,"flex","px-4","pt-5","pb-3","space-x-8"],[1,"flex","items-center","justify-center","border","border-gray-200","rounded-lg","w-[13rem]","h-[8rem]"],["alt","top_app_icon","loading","eager",1,"object-cover","w-full","h-full","rounded-lg",3,"src"],[1,"w-full","h-full"],[1,"mb-2","text-lg","font-semibold"],[1,"leading-6","line-clamp-4"],[1,"flex","items-center","justify-center","w-full","h-8","py-5","bg-gradient-to-r","from-orange-200","to-slate-200","rounded-br-md","rounded-bl-md"],["title","Apps and Submissions","class","px-2 py-1 text-white bg-green-500 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],["title","Edit","class","px-2 py-1 mx-2 text-white bg-blue-400 rounded-md cursor-pointer hover:text-white",3,"routerLink","click",4,"ngIf"],["title","Delete","class","px-2 py-1 text-white bg-red-500 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],["title","Apps and Submissions",1,"px-2","py-1","text-white","bg-green-500","rounded-md","cursor-pointer","hover:text-white",3,"click"],["aria-hidden","true",1,"fa","fa-sitemap","fa-lg"],["title","Edit",1,"px-2","py-1","mx-2","text-white","bg-blue-400","rounded-md","cursor-pointer","hover:text-white",3,"routerLink","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg"],["title","Delete",1,"px-2","py-1","text-white","bg-red-500","rounded-md","cursor-pointer","hover:text-white",3,"click"],["aria-hidden","true",1,"fa","fa-trash","fa-lg"],["title","Edit","class","px-2 py-1 mx-2 text-white bg-blue-400 rounded-md cursor-pointer hover:text-white",3,"routerLink",4,"ngIf"],["status","primary","value","Draft","size","s",1,"tui-space_left-1"],["title","Edit",1,"px-2","py-1","mx-2","text-white","bg-blue-400","rounded-md","cursor-pointer","hover:text-white",3,"routerLink"],[1,"py-6"],[3,"length","index","indexChange"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"],["tuiButton","","type","button","size","m",3,"click"]],template:function(y,_){if(1&y&&(n.TgZ(0,"div",0)(1,"app-search-bar",1),n.NdJ("searchStr",function(G){return _.sendSearchValue(G)}),n.qZA(),n.YNc(2,ue,4,2,"ng-container",2),n.ALo(3,"async"),n.qZA(),n.YNc(4,N,5,0,"ng-container",2),n.ALo(5,"async"),n.TgZ(6,"tui-loader",3),n.ALo(7,"async"),n.YNc(8,R,2,0,"ng-container",4),n.ALo(9,"async"),n.YNc(10,pe,4,4,"ng-template",null,5,n.W1O),n.qZA(),n.YNc(12,Te,9,0,"ng-template",null,6,n.W1O)),2&y){const D=n.MAs(11);n.xp6(2),n.Q6J("ngIf",n.lcZ(3,6,_.moduleData)),n.xp6(2),n.Q6J("ngIf",0==(null==_.tableData||null==_.tableData.results?null:_.tableData.results.length)&&1==n.lcZ(5,8,_.showEmptyMessage)),n.xp6(2),n.Q6J("overlay",!0)("showLoader",n.lcZ(7,10,_.fetchingTableData)),n.xp6(2),n.Q6J("ngIf",0==(null==_.tableData||null==_.tableData.results?null:_.tableData.results.length)&&0==n.lcZ(9,12,_.showEmptyMessage))("ngIfElse",D)}},dependencies:[a.ez,a.mk,a.sg,a.O5,a.Ov,d.N,e.Bz,e.rH,J.i,J.r,U.dS,U.kM,A.fN,A.v0,c.f,c.g,k.go,x.Q],styles:['.tooltiptext[_ngcontent-%COMP%]{width:170px;background-color:#6c86e2;color:#fff;text-align:center;border-radius:6px;padding:5px 2px;position:absolute;font-size:11px;z-index:1;top:-11px;right:110%}.tooltiptext[_ngcontent-%COMP%]:after{content:"";position:absolute;top:50%;left:100%;margin-top:-5px;border-width:5px;border-style:solid;border-color:transparent transparent transparent #6C86E2}'],changeDetection:0})},68341:(ge,oe,u)=>{u.d(oe,{Ii:()=>E,Mt:()=>X});var n=u(94650),a=u(8276),d=u(19040),e=u(91127),J=u(71115),c=u(89740),U=u(36895);function A(K,I){1&K&&n._UZ(0,"tui-svg",2),2&K&&n.Q6J("src",I.polymorpheusOutlet)}function k(K,I){1&K&&n.GkF(0)}const x={iconSmall:"tuiIconChevronDown",iconLarge:"tuiIconChevronDownLarge"},f=new n.OlP("[TUI_ARROW_OPTIONS]",{factory:()=>x}),E=new n.OlP("[TUI_ARROW_MODE]",{factory:()=>({interactive:q,disabled:q})}),q=new c.Al((()=>{class K{constructor(Z,M,$){this.dropdown=Z,this.textfieldSize=M,this.options=$}get rotated(){return this.dropdown.open}get arrowIcon(){return(0,d.R9)(this.textfieldSize.size)?this.options.iconLarge:this.options.iconSmall}}return K.\u0275fac=function(Z){return new(Z||K)(n.Y36(e.o1),n.Y36(J.kI),n.Y36(f))},K.\u0275cmp=n.Xpm({type:K,selectors:[["tui-arrow"]],hostVars:2,hostBindings:function(Z,M){2&Z&&n.ekj("_rotated",M.rotated)},decls:3,vars:4,consts:[[3,"src",4,"polymorpheusOutlet"],[4,"ngIf"],[3,"src"]],template:function(Z,M){1&Z&&(n.YNc(0,A,1,1,"tui-svg",0),n.YNc(1,k,1,0,"ng-container",1),n.ALo(2,"async")),2&Z&&(n.Q6J("polymorpheusOutlet",M.arrowIcon),n.xp6(1),n.Q6J("ngIf",n.lcZ(2,2,M.dropdown.openChange)))},dependencies:[a.PN,c.Li,U.O5,U.Ov],styles:["[_nghost-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:block;cursor:pointer;pointer-events:none}._rotated[_nghost-%COMP%]{transform:rotate(180deg)}"],changeDetection:0}),K})());let X=(()=>{class K{}return K.\u0275fac=function(Z){return new(Z||K)},K.\u0275mod=n.oAB({type:K}),K.\u0275inj=n.cJS({imports:[[U.ez,a.EI,c.wq]]}),K})()},29093:(ge,oe,u)=>{u.d(oe,{VF:()=>H,EB:()=>le,Xj:()=>me});var n=u(70655),a=u(94650),d=u(66307),e=u(47776);let J=(()=>{class w{constructor(T){this.tuiSwipe=T}}return w.\u0275fac=function(T){return new(T||w)(a.Y36(e.$D))},w.\u0275dir=a.lG2({type:w,selectors:[["","tuiSwipe",""]],outputs:{tuiSwipe:"tuiSwipe"},features:[a._Bn([e.$D])]}),w})(),c=(()=>{class w{}return w.\u0275fac=function(T){return new(T||w)},w.\u0275mod=a.oAB({type:w}),w.\u0275inj=a.cJS({}),w})();var U=u(38355),A=u(78535),k=u(71225),x=u(37414),f=u(82210),L=u(68923),E=u(36895),ne=u(39300),ae=u(59468),q=u(54004),X=u(18505),K=u(63900),I=u(80702),Z=u(9892),M=u(69751),$=u(61135),de=u(56451),ue=u(39841),N=u(17445),R=u(60515);function C(w,j){1&w&&a.GkF(0)}function Y(w,j){if(1&w){const T=a.EpF();a.TgZ(0,"fieldset",5),a.NdJ("waIntersectionObservee",function(z){const Te=a.CHM(T).index,fe=a.oxw();return a.KtG(fe.onIntersection(z[0],Te))}),a.GkF(1,6),a.qZA()}if(2&w){const T=j.$implicit,B=j.index,z=a.oxw();a.Q6J("disabled",z.isDisabled(B))("ngStyle",z.getStyle(z.itemsCount)),a.xp6(1),a.Q6J("ngTemplateOutlet",T)}}let te=(()=>{class w{constructor(T){this.elementRef=T,this.tuiCarouselScroll=(0,U.mL)(this.elementRef.nativeElement,"wheel").pipe((0,ne.h)(({deltaX:B})=>Math.abs(B)>20),(0,ae.p)(500),(0,q.U)(({deltaX:B})=>Math.sign(B)),(0,X.b)(()=>{this.elementRef.nativeElement.scrollLeft=10}))}}return w.\u0275fac=function(T){return new(T||w)(a.Y36(a.SBq))},w.\u0275dir=a.lG2({type:w,selectors:[["","tuiCarouselScroll",""]],outputs:{tuiCarouselScroll:"tuiCarouselScroll"}}),w})(),le=(()=>{class w extends M.y{constructor(T,B){super(z=>this.output$.subscribe(z)),this.elementRef=T,this.visible$=B,this.duration$=new $.X(0),this.running$=(0,de.T)((0,U.mL)(this.elementRef.nativeElement,"mouseenter").pipe((0,q.U)(A.Iy)),(0,U.mL)(this.elementRef.nativeElement,"touchstart").pipe((0,q.U)(A.Iy)),(0,U.mL)(this.elementRef.nativeElement,"touchend").pipe((0,q.U)(A.Ye)),(0,U.mL)(this.elementRef.nativeElement,"mouseleave").pipe((0,q.U)(A.Ye)),this.visible$),this.output$=(0,ue.a)([this.duration$,this.running$]).pipe((0,K.w)(([z,pe])=>z&&pe?(0,N.F)(z):R.E))}set duration(T){this.duration$.next(T)}set index(T){this.duration$.next(this.duration$.value)}}return w.\u0275fac=function(T){return new(T||w)(a.Y36(a.SBq),a.Y36(Z.de))},w.\u0275dir=a.lG2({type:w,selectors:[["tui-carousel"]],inputs:{duration:"duration",index:"index"},features:[a.qOj]}),w})(),O=(()=>{class w{constructor(T){this.tuiCarouselAutoscroll=T}}return w.\u0275fac=function(T){return new(T||w)(a.Y36(le))},w.\u0275dir=a.lG2({type:w,selectors:[["","tuiCarouselAutoscroll",""]],outputs:{tuiCarouselAutoscroll:"tuiCarouselAutoscroll"}}),w})(),H=(()=>{class w{constructor(T,B,z){this.changeDetectorRef=T,this.elementRef=B,this.isMobile=z,this.translate=0,this.draggable=!1,this.itemsCount=1,this.index=0,this.indexChange=new a.vpe,this.items=A.Mm,this.transitioned=!0}get transform(){return`translateX(${100*(this.transitioned?this.computedTranslate:this.translate)}%)`}onTransitioned(T){this.transitioned=T,T||(this.translate=this.computedTranslate)}getStyle(T){const B=100/T+"%";return{flexBasis:B,minWidth:B,maxWidth:B}}next(){this.updateIndex(this.index+1)}prev(){this.updateIndex(this.index-1)}isDisabled(T){return T<this.index||T>this.index+this.itemsCount}onIntersection({intersectionRatio:T},B){T&&1!==T&&!this.transitioned&&this.updateIndex(B-Math.floor(this.itemsCount/2))}onScroll(T){this.isMobile||this.updateIndex(this.index+T)}onPan(T){if(!this.computedDraggable)return;const{clientWidth:B}=this.elementRef.nativeElement;this.translate=(0,k.Ki)(T/B+this.translate,1-this.items.length/this.itemsCount,0)}onSwipe(T){"left"===T?this.next():"right"===T&&this.prev()}onAutoscroll(){this.updateIndex(this.index===this.items.length-1?0:this.index+1)}get computedTranslate(){return-this.index/this.itemsCount}get computedDraggable(){return this.isMobile||this.draggable}updateIndex(T){this.index=(0,k.Ki)(T,0,this.items.length-1),this.indexChange.emit(this.index),this.changeDetectorRef.markForCheck()}}return w.\u0275fac=function(T){return new(T||w)(a.Y36(a.sBO),a.Y36(a.SBq),a.Y36(x.fL))},w.\u0275cmp=a.Xpm({type:w,selectors:[["tui-carousel"]],contentQueries:function(T,B,z){if(1&T&&a.Suo(z,f.w,4,a.Rgc),2&T){let pe;a.iGM(pe=a.CRH())&&(B.items=pe)}},hostVars:4,hostBindings:function(T,B){1&T&&a.NdJ("touchstart",function(){return B.onTransitioned(!1)})("touchend",function(){return B.onTransitioned(!0)})("mousedown",function(){return B.onTransitioned(!1)})("mouseup.silent",function(){return B.onTransitioned(!0)},!1,a.evT),2&T&&a.ekj("_draggable",B.draggable)("_transitioned",B.transitioned)},inputs:{draggable:"draggable",itemsCount:"itemsCount",index:"index"},outputs:{indexChange:"indexChange"},decls:6,vars:6,consts:[[4,"ngIf"],[1,"t-scroller",3,"tuiCarouselScroll"],["waIntersectionRoot","","waIntersectionObserver","","waIntersectionThreshold","0,1","waIntersectionRootMargin","100px 1000000px 100px -51%",1,"t-wrapper"],[1,"t-items",3,"tuiPan","tuiSwipe","tuiCarouselAutoscroll"],["class","t-item",3,"disabled","ngStyle","waIntersectionObservee",4,"ngFor","ngForOf"],[1,"t-item",3,"disabled","ngStyle","waIntersectionObservee"],[3,"ngTemplateOutlet"]],template:function(T,B){1&T&&(a.YNc(0,C,1,0,"ng-container",0),a.ALo(1,"async"),a.TgZ(2,"div",1),a.NdJ("tuiCarouselScroll",function(pe){return B.onScroll(pe)}),a.TgZ(3,"div",2)(4,"div",3),a.NdJ("tuiPan",function(pe){return B.onPan(pe[0])})("tuiSwipe",function(pe){return B.onSwipe(pe.direction)})("tuiCarouselAutoscroll",function(){return B.onAutoscroll()}),a.YNc(5,Y,2,3,"fieldset",4),a.qZA()()()),2&T&&(a.Q6J("ngIf",a.lcZ(1,4,B.items.changes)),a.xp6(4),a.Udp("transform",B.transform),a.xp6(1),a.Q6J("ngForOf",B.items))},dependencies:[E.O5,te,I.Q7,I.Z7,d.g,J,O,E.sg,E.PC,I.AY,E.tP,E.Ov],styles:['[_nghost-%COMP%]{position:relative;display:block;overflow:hidden}._draggable[_nghost-%COMP%]{-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none}._draggable[_nghost-%COMP%]:hover{cursor:-webkit-grab;cursor:grab}._draggable[_nghost-%COMP%]:active{cursor:-webkit-grabbing;cursor:grabbing}.t-items[_ngcontent-%COMP%]{display:flex}._transitioned[_nghost-%COMP%]   .t-items[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out}.t-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;padding:var(--tui-carousel-padding, 0 1.25rem);flex:1;min-width:100%;max-width:100%;box-sizing:border-box;border:none;margin:0}.t-wrapper[_ngcontent-%COMP%]{position:-webkit-sticky;position:sticky;left:0;right:0;min-width:100%;overflow:hidden}.t-scroller[_ngcontent-%COMP%]{scrollbar-width:none;-ms-overflow-style:none;display:flex;overflow:auto;overscroll-behavior-x:none;padding-bottom:2rem;margin-bottom:-2rem}.t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar, .t-scroller[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:transparent;width:0;height:0}.t-scroller[_ngcontent-%COMP%]:before, .t-scroller[_ngcontent-%COMP%]:after{content:"";display:block;min-width:1rem}'],changeDetection:0}),(0,n.gn)([(0,L.TH)()],w.prototype,"draggable",void 0),(0,n.gn)([(0,L.TH)()],w.prototype,"itemsCount",void 0),(0,n.gn)([(0,L.TH)()],w.prototype,"index",void 0),(0,n.gn)([L.UM],w.prototype,"getStyle",null),w})(),me=(()=>{class w{}return w.\u0275fac=function(T){return new(T||w)},w.\u0275mod=a.oAB({type:w}),w.\u0275inj=a.cJS({imports:[[E.ez,I.$v,d.N,c,f.H]]}),w})()},35601:(ge,oe,u)=>{u.d(oe,{h:()=>c,y:()=>U});var n=u(70655),a=u(94650),d=u(68923),e=u(36895);const J=["*"];let c=(()=>{class A{constructor(){this.size="m",this.textAlign="left",this.hoverable=!1,this.transparent=!1}get sizeS(){return"s"===this.size}get sizeM(){return"m"===this.size}get sizeL(){return"l"===this.size}get textAlignLeft(){return"left"===this.textAlign}get textAlignCenter(){return"center"===this.textAlign}get textAlignRight(){return"right"===this.textAlign}}return A.\u0275fac=function(x){return new(x||A)},A.\u0275cmp=a.Xpm({type:A,selectors:[["tui-island"],["a","tuiIsland",""]],hostAttrs:[1,"tui-island"],hostVars:16,hostBindings:function(x,f){2&x&&a.ekj("tui-island_hoverable",f.hoverable)("tui-island_transparent",f.transparent)("tui-island_size_s",f.sizeS)("tui-island_size_m",f.sizeM)("tui-island_size_l",f.sizeL)("tui-island_text-align_left",f.textAlignLeft)("tui-island_text-align_center",f.textAlignCenter)("tui-island_text-align_right",f.textAlignRight)},inputs:{size:"size",textAlign:"textAlign",hoverable:"hoverable",transparent:"transparent"},ngContentSelectors:J,decls:1,vars:0,template:function(x,f){1&x&&(a.F$t(),a.Hsn(0))},styles:["[_nghost-%COMP%]{display:block}"],changeDetection:0}),(0,n.gn)([(0,d.TH)()],A.prototype,"size",void 0),(0,n.gn)([(0,d.TH)()],A.prototype,"textAlign",void 0),(0,n.gn)([(0,d.TH)()],A.prototype,"hoverable",void 0),(0,n.gn)([(0,d.TH)()],A.prototype,"transparent",void 0),A})(),U=(()=>{class A{}return A.\u0275fac=function(x){return new(x||A)},A.\u0275mod=a.oAB({type:A}),A.\u0275inj=a.cJS({imports:[[e.ez]]}),A})()},77975:(ge,oe,u)=>{u.d(oe,{VT:()=>G,Qp:()=>v,lm:()=>F});var n=u(70655),a=u(94650),d=u(93422),e=u(66437),J=u(77721),c=u(1054),U=u(78535),A=u(55753),k=u(39255),x=u(37414),f=u(68923),L=u(54227),E=u(90433),ne=u(91127),ae=u(71115),q=u(47846),X=u(31947),K=u(53861),I=u(8276),Z=u(79791);class de{constructor(b,p){this.item=b,this.stringify=p}toString(){return this.stringify(this.item)}}var ue=u(68341),N=u(4053),R=u(87377),C=u(15135),Y=u(36895),te=u(89740),le=u(74606),O=u(42973);let H=(()=>{class m extends le.TA{get size(){var p;return"l"===this.option.size||"l"===(null===(p=this.dataList)||void 0===p?void 0:p.size)&&!this.option.size?"l":"m"}get selected(){const{value:p}=this.option;return(0,A.Pc)(p)&&(0,A.Pc)(this.value)&&this.value.some(h=>this.matcher(h,p))}}return m.\u0275fac=function(){let b;return function(h){return(b||(b=a.n5z(m)))(h||m)}}(),m.\u0275cmp=a.Xpm({type:m,selectors:[["tui-multi-select-option"]],features:[a.qOj],decls:3,vars:5,consts:[[1,"t-checkbox",3,"size","value"],[3,"ngTemplateOutlet"]],template:function(p,h){1&p&&(a._UZ(0,"tui-primitive-checkbox",0),a.ALo(1,"async"),a.GkF(2,1)),2&p&&(a.Q6J("size",h.size)("value",a.lcZ(1,3,h.selected$)),a.xp6(2),a.Q6J("ngTemplateOutlet",h.context.$implicit))},dependencies:[O.r3,Y.tP,Y.Ov],styles:["@keyframes _ngcontent-%COMP%_retrigger{0%{left:1px}to{left:2px}}[_nghost-%COMP%]{display:flex;flex:1;align-items:center;overflow:hidden;animation:_ngcontent-%COMP%_retrigger 1s}.t-checkbox[_ngcontent-%COMP%]{margin-right:.75rem}"],changeDetection:0}),m})(),W=(()=>{class m{}return m.\u0275fac=function(p){return new(p||m)},m.\u0275mod=a.oAB({type:m}),m.\u0275inj=a.cJS({imports:[[Y.ez,O.fB]]}),m})();function me(m,b){if(1&m&&(a.ynx(0),a._uU(1),a.BQk()),2&m){const p=b.polymorpheusOutlet;a.xp6(1),a.hij(" ",p," ")}}const w=function(m){return{$implicit:m}};function j(m,b){if(1&m&&(a.TgZ(0,"div",6),a.YNc(1,me,2,1,"ng-container",7),a.qZA()),2&m){const p=a.oxw(),h=a.MAs(2);a.ekj("t-group_fullsize",h.labelOutside),a.xp6(1),a.Q6J("polymorpheusOutlet",p.valueContent)("polymorpheusOutletContext",a.VKq(4,w,p.value))}}function T(m,b){if(1&m&&(a.ynx(0),a._uU(1),a.BQk()),2&m){const p=b.polymorpheusOutlet;a.xp6(1),a.hij(" ",p," ")}}function B(m,b){if(1&m&&(a.TgZ(0,"div",9),a.YNc(1,T,2,1,"ng-container",10),a.qZA()),2&m){const p=a.oxw(2);a.xp6(1),a.Q6J("polymorpheusOutlet",p.arrow)}}function z(m,b){if(1&m&&a.YNc(0,B,2,1,"div",8),2&m){const p=a.oxw();a.Q6J("ngIf",p.arrow)}}const pe=["*"],y={expandable:!0,valueContent:""},_=new a.OlP("[TUI_MULTI_SELECT_OPTIONS]",{factory:()=>y});let G=(()=>{class m extends c.m6{constructor(p,h,Q,ie,se,he){super(p,h),this.arrowMode=Q,this.itemsHandlers=ie,this.options=se,this.controller=he,this.stringify=this.itemsHandlers.stringify,this.identityMatcher=this.itemsHandlers.identityMatcher,this.expandable=this.options.expandable,this.search="",this.placeholder="",this.editable=!0,this.disabledItemHandler=this.itemsHandlers.disabledItemHandler,this.valueContent=this.options.valueContent,this.rows=1/0,this.searchChange=new a.vpe,this.datalist="",this.open=!1,this.valueMapper=(ye,be,we)=>we?U.LZ:ye.map(De=>new de(De,be)),this.disabledItemHandlerWrapper=ye=>be=>(0,A.Aj)(be)||ye(be.item)}get size(){return this.controller.size}get arrow(){return this.interactive?this.arrowMode.interactive:this.arrowMode.disabled}get nativeFocusableElement(){var p,h;return null!==(h=null===(p=this.input)||void 0===p?void 0:p.nativeFocusableElement)&&void 0!==h?h:null}get focused(){var p,h;return!(null===(p=this.input)||void 0===p||!p.focused)||!(null===(h=this.hostedDropdown)||void 0===h||!h.focused)}get computedValue(){return this.computedGroup?U.LZ:this.value}get searchOrSpace(){return this.computedGroup?" ":this.searchString}get searchString(){return null===this.search?"":this.search}get computedGroup(){return!!this.valueContent&&this.value.length>0&&(!this.focused||!this.editable)}getStringifier(p){return({$implicit:h})=>p(h)}onSpace(p){this.editable||p.preventDefault(),this.readOnly||(this.open=!0)}handleOption(p){const{value:h,identityMatcher:Q}=this,ie=h.findIndex(se=>Q(se,p));this.updateValue(-1===ie?[...h,p]:h.filter((se,he)=>he!==ie)),this.updateSearch(null)}onEnter(p){const{value:h}=this,Q=this.accessor?this.accessor.getOptions():[];1===Q.length&&(p.preventDefault(),this.updateValue((0,A.jp)(h,Q[0])),this.updateSearch(null))}onClick({nativeFocusableElement:p}){var h;this.interactive&&p&&(0,k.V8)(p)&&(null===(h=this.hostedDropdown)||void 0===h||h.updateOpen(!this.open))}onInput(p){this.updateValue(p.map(({item:h})=>h))}onSearch(p){this.open=!0,this.updateSearch(p)}onActiveZone(p){this.updateFocused(p)}setDisabledState(){super.setDisabledState(),this.open=!1}updateSearch(p){this.search!==p&&(this.search=p,this.searchChange.emit(p))}}return m.\u0275fac=function(p){return new(p||m)(a.Y36(E.a5,10),a.Y36(a.sBO),a.Y36(ue.Ii),a.Y36(C.Ys),a.Y36(_),a.Y36(ae.Cs))},m.\u0275cmp=a.Xpm({type:m,selectors:[["tui-multi-select"]],contentQueries:function(p,h,Q){if(1&p&&(a.Suo(Q,X.Cc,5),a.Suo(Q,K.gX,5,a.Rgc)),2&p){let ie;a.iGM(ie=a.CRH())&&(h.accessor=ie.first),a.iGM(ie=a.CRH())&&(h.datalist=ie.first)}},viewQuery:function(p,h){if(1&p&&(a.Gf(ne.o1,5),a.Gf(N.PZ,5)),2&p){let Q;a.iGM(Q=a.CRH())&&(h.hostedDropdown=Q.first),a.iGM(Q=a.CRH())&&(h.input=Q.first)}},hostVars:3,hostBindings:function(p,h){2&p&&(a.uIk("data-size",h.size),a.ekj("_editable",h.editable))},inputs:{stringify:"stringify",identityMatcher:"identityMatcher",expandable:"expandable",search:"search",placeholder:"placeholder",editable:"editable",disabledItemHandler:"disabledItemHandler",valueContent:"valueContent",rows:"rows"},outputs:{searchChange:"searchChange"},features:[a._Bn([(0,x.FT)(m),(0,c.wB)(m),(0,X.oE)(m),ae.Y0],[R.yn]),a.qOj],ngContentSelectors:pe,decls:10,vars:28,consts:[[1,"t-hosted",3,"canOpen","content","open","openChange","tuiActiveZoneChange"],["automation-id","tui-multi-select__input",1,"t-input",3,"nativeId","tuiTextfieldIcon","disabled","disabledItemHandler","readOnly","inputHidden","pseudoHover","placeholder","pseudoFocus","pseudoInvalid","editable","expandable","search","rows","ngModel","ngModelChange","searchChange","keydown.space","keydown.enter","click.prevent"],["inputTag",""],[1,"t-wrapper"],["class","t-group",3,"t-group_fullsize",4,"ngIf"],["icon",""],[1,"t-group"],[4,"polymorpheusOutlet","polymorpheusOutletContext"],["tuiWrapper","","appearance","icon","automation-id","tui-multi-select__arrow","tuiPreventDefault","mousedown","class","t-arrow",4,"ngIf"],["tuiWrapper","","appearance","icon","automation-id","tui-multi-select__arrow","tuiPreventDefault","mousedown",1,"t-arrow"],[4,"polymorpheusOutlet"]],template:function(p,h){if(1&p){const Q=a.EpF();a.F$t(),a.TgZ(0,"tui-hosted-dropdown",0),a.NdJ("openChange",function(se){return h.open=se})("tuiActiveZoneChange",function(se){return h.onActiveZone(se)}),a.TgZ(1,"tui-input-tag",1,2),a.NdJ("ngModelChange",function(se){return h.onInput(se)})("searchChange",function(se){return h.onSearch(se)})("keydown.space",function(se){return h.onSpace(se)})("keydown.enter",function(se){return h.onEnter(se)})("click.prevent",function(){a.CHM(Q);const se=a.MAs(2);return a.KtG(h.onClick(se))}),a.ALo(3,"tuiMapper"),a.ALo(4,"tuiMapper"),a.Hsn(5),a.qZA(),a.TgZ(6,"div",3),a.YNc(7,j,2,6,"div",4),a.YNc(8,z,1,1,"ng-template",null,5,a.W1O),a.qZA()()}if(2&p){const Q=a.MAs(9);a.Q6J("canOpen",h.interactive)("content",h.datalist||"")("open",h.open),a.xp6(1),a.Q6J("nativeId",h.nativeId)("tuiTextfieldIcon",Q)("disabled",h.disabled)("disabledItemHandler",a.xi3(3,21,h.disabledItemHandler,h.disabledItemHandlerWrapper))("readOnly",h.readOnly)("inputHidden",!h.editable)("pseudoHover",h.pseudoHover)("placeholder",h.placeholder)("pseudoFocus",h.computedFocused)("pseudoInvalid",h.computedInvalid)("editable",!1)("expandable",h.expandable)("search",h.searchOrSpace)("rows",h.rows)("ngModel",a.Dn7(4,24,h.computedValue,h.valueMapper,h.stringify)),a.xp6(5),a.ekj("t-wrapper_disabled",h.disabled),a.xp6(1),a.Q6J("ngIf",h.computedGroup)}},dependencies:[ne.o1,N.PZ,d.e,ae.AW,E.JJ,E.On,Y.O5,te.Li,q.o,e.A,J.c],styles:["[_nghost-%COMP%]{position:relative;display:block;border-radius:var(--tui-radius-m)}._disabled[_nghost-%COMP%]{pointer-events:none}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-input[_ngcontent-%COMP%]{border-radius:inherit}[_nghost-%COMP%]:not(._editable):not(._readonly)   .t-input[_ngcontent-%COMP%]{cursor:pointer}.t-wrapper[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;pointer-events:none;justify-content:flex-end}.t-wrapper_disabled[_ngcontent-%COMP%]{opacity:var(--tui-disabled-opacity)}[data-size=s][_nghost-%COMP%]   .t-wrapper[_ngcontent-%COMP%]{height:var(--tui-height-s)}[data-size=m][_nghost-%COMP%]   .t-wrapper[_ngcontent-%COMP%]{height:var(--tui-height-m)}[data-size=l][_nghost-%COMP%]   .t-wrapper[_ngcontent-%COMP%]{height:var(--tui-height-l)}.t-group[_ngcontent-%COMP%]{display:flex;flex:1;align-items:center;padding:1.6875rem 0 .5625rem 1rem;overflow:hidden}.t-group_fullsize[_ngcontent-%COMP%]{padding-top:.0625rem;padding-bottom:0}[data-size=m][_nghost-%COMP%]   .t-group_fullsize.t-group_fullsize[_ngcontent-%COMP%]{padding-top:0}[data-size=m][_nghost-%COMP%]   .t-group[_ngcontent-%COMP%]{padding:1.1875rem 0 0 .75rem;font-size:.8125rem}.t-arrow[_ngcontent-%COMP%]{pointer-events:auto;cursor:pointer}"],changeDetection:0}),(0,n.gn)([(0,f.TH)()],m.prototype,"stringify",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"identityMatcher",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"expandable",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"search",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"placeholder",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"editable",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"disabledItemHandler",void 0),(0,n.gn)([(0,f.TH)()],m.prototype,"valueContent",void 0),(0,n.gn)([f.UM],m.prototype,"getStringifier",null),m})();const Ce=new te.Al(H);let v=(()=>{class m{}return m.\u0275fac=function(p){return new(p||m)},m.\u0275dir=a.lG2({type:m,selectors:[["","tuiMultiSelectGroup",""]],features:[a._Bn([(0,X.P7)(Ce),{provide:X.N1,deps:[E.a5,[new a.FiY,(0,a.Gpc)(()=>G)]],useFactory:(b,p)=>p||{handleOption:h=>{var Q;return null===(Q=b.control)||void 0===Q?void 0:Q.setValue((0,A.jp)(b.value||[],h))}}},{provide:E.JU,multi:!0,useValue:{writeValue:U.iD,registerOnChange:U.iD,registerOnTouched:U.iD}}])]}),m})(),F=(()=>{class m{}return m.\u0275fac=function(p){return new(p||m)},m.\u0275mod=a.oAB({type:m}),m.\u0275inj=a.cJS({imports:[[Y.ez,E.u5,te.wq,q.W,e.Z,d.A,ue.Mt,L.WD,J.I,I.EI,ne.jh,N.cB,W,Z.j,K.pc,ae.cn]]}),m})()},67155:(ge,oe,u)=>{u.d(oe,{V5:()=>K,iv:()=>L,vV:()=>q});var n=u(36895),a=u(94650),d=u(68923),e=u(58459),J=u(70655);const c=["tuiProgressBar",""],A=["tuiProgressLabel",""],k=[[["progress"]],[["tui-progress-circle"]],"*"],x=["progress","tui-progress-circle","*"];let L=(()=>{class I{constructor(){this.size="m"}}return I.\u0275fac=function(M){return new(M||I)},I.\u0275cmp=a.Xpm({type:I,selectors:[["progress","tuiProgressBar",""]],hostVars:3,hostBindings:function(M,$){2&M&&(a.uIk("data-size",$.size),a.Udp("--tui-progress-color",$.color))},inputs:{color:"color",size:"size"},attrs:c,decls:0,vars:0,template:function(M,$){},styles:["@keyframes _ngcontent-%COMP%_tuiIndeterminateAnimation{50%{background-position:left}}[_nghost-%COMP%]{-webkit-appearance:none;-moz-appearance:none;appearance:none;border:none;background-color:var(--tui-base-03);display:block;width:100%;color:var(--tui-primary);border-radius:var(--tui-radius-xs);overflow:hidden}[_nghost-%COMP%]::-webkit-progress-value{-webkit-transition:width var(--tui-duration) linear;transition:width var(--tui-duration) linear}[_nghost-%COMP%]::-webkit-progress-value{background:var(--tui-progress-color, currentColor)}[_nghost-%COMP%]::-moz-progress-bar{background:var(--tui-progress-color, currentColor)}[_nghost-%COMP%]::-webkit-progress-bar{background-color:var(--tui-base-03)}[data-size=m][_nghost-%COMP%]{height:1.5rem}[data-size=s][_nghost-%COMP%]{height:.5rem}[data-size=s][_nghost-%COMP%]::-webkit-progress-value{border-radius:var(--tui-radius-xs)}[data-size=s][_nghost-%COMP%]::-moz-progress-bar{border-radius:var(--tui-radius-xs)}[_nghost-%COMP%]:indeterminate{background:transparent;background-image:linear-gradient(to right,var(--tui-base-03) 0 45%,var(--tui-progress-color, currentColor) 45% 55%,var(--tui-base-03) 55% 100%);background-size:225%;background-position:right;animation:_ngcontent-%COMP%_tuiIndeterminateAnimation 3s infinite ease-in-out}[_nghost-%COMP%]:indeterminate::-webkit-progress-bar{background:transparent}[_nghost-%COMP%]:indeterminate::-webkit-progress-value{background:transparent}[_nghost-%COMP%]:indeterminate::-moz-progress-bar{background:transparent}label[tuiProgressLabel][_nghost-%COMP%]:not(:first-child), label[tuiProgressLabel]   [_nghost-%COMP%]:not(:first-child){position:absolute;top:0;left:0;width:100%;height:100%;background-color:transparent}label[tuiProgressLabel][_nghost-%COMP%]:not(:first-child)::-webkit-progress-bar, label[tuiProgressLabel]   [_nghost-%COMP%]:not(:first-child)::-webkit-progress-bar{background-color:transparent}"],changeDetection:0}),(0,J.gn)([(0,d.TH)()],I.prototype,"size",void 0),I})(),q=(()=>{class I{}return I.\u0275fac=function(M){return new(M||I)},I.\u0275cmp=a.Xpm({type:I,selectors:[["label","tuiProgressLabel",""]],attrs:A,ngContentSelectors:x,decls:4,vars:0,consts:[[1,"t-label"]],template:function(M,$){1&M&&(a.F$t(k),a.Hsn(0),a.Hsn(1,1),a.TgZ(2,"span",0),a.Hsn(3,2),a.qZA())},styles:["[_nghost-%COMP%]{position:relative;display:inline-block}.t-label[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%;display:flex;font:var(--tui-font-text-s);color:var(--tui-text-01);flex-direction:column;justify-content:center;align-items:center}"],changeDetection:0}),I})(),K=(()=>{class I{}return I.\u0275fac=function(M){return new(M||I)},I.\u0275mod=a.oAB({type:I}),I.\u0275inj=a.cJS({imports:[[n.ez,e.Ih]]}),I})()},74606:(ge,oe,u)=>{u.d(oe,{Q4:()=>te,TA:()=>Y,Ig:()=>le});var n=u(94650),a=u(90433),d=u(38355),e=u(78535),J=u(55753),c=u(1054),U=u(8276),A=u(70655),k=u(47776),x=u(68923),f=u(95825),L=u(5963),E=u(82722);let ne=(()=>{class O{constructor(W,me){this.elementRef=W,this.destroy$=me}set tuiScrollIntoView(W){W&&(0,L.H)(0).pipe((0,E.R)(this.destroy$)).subscribe(()=>{this.elementRef.nativeElement.dispatchEvent(new CustomEvent(f.fe,{bubbles:!0,detail:this.elementRef.nativeElement}))})}}return O.\u0275fac=function(W){return new(W||O)(n.Y36(n.SBq),n.Y36(k.a3,2))},O.\u0275dir=n.lG2({type:O,selectors:[["","tuiScrollIntoView",""]],inputs:{tuiScrollIntoView:"tuiScrollIntoView"},features:[n._Bn([k.a3])]}),(0,A.gn)([(0,x.NH)()],O.prototype,"tuiScrollIntoView",null),O})(),ae=(()=>{class O{}return O.\u0275fac=function(W){return new(W||O)},O.\u0275mod=n.oAB({type:O}),O.\u0275inj=n.cJS({}),O})();var q=u(31947),X=u(53861),K=u(89740),I=u(77579),Z=u(56451),M=u(60515),$=u(68675),de=u(54004),ue=u(71884),N=u(36895);function R(O,H){1&O&&n._UZ(0,"tui-svg",3),2&O&&n.Q6J("tuiScrollIntoView",!0)}function C(O,H){1&O&&n._UZ(0,"span",4)}let Y=(()=>{class O{constructor(W,me,w,j,T,B,z){this.context=W,this.host=me,this.elementRef=w,this.option=j,this.dataList=T,this.control=B,this.abstractControl=z,this.changeDetection$=new I.x,this.selected$=(0,Z.T)(this.changeDetection$,this.control.valueChanges||M.E,(0,d.mL)(this.elementRef.nativeElement,"animationstart")).pipe((0,$.O)(null),(0,de.U)(()=>this.selected),(0,ue.x)())}get matcher(){return this.host.identityMatcher||e.bg}ngDoCheck(){this.changeDetection$.next()}ngOnInit(){Promise.resolve().then(()=>{(0,J.Pc)(this.option.value)&&this.host.checkOption&&this.host.checkOption(this.option.value)})}get value(){var W,me;return null!==(me=null===(W=this.abstractControl)||void 0===W?void 0:W.value)&&void 0!==me?me:this.control.value}get selected(){return(0,J.Pc)(this.option.value)&&(0,J.Pc)(this.value)&&this.matcher(this.value,this.option.value)}}return O.\u0275fac=function(W){return new(W||O)(n.Y36(K.yf),n.Y36(q.N1),n.Y36(n.SBq),n.Y36(X.vK),n.Y36(X.qi,8),n.Y36(a.a5),n.Y36(c.M$,8))},O.\u0275cmp=n.Xpm({type:O,selectors:[["tui-select-option"]],decls:5,vars:5,consts:[[3,"ngTemplateOutlet"],["automation-id","tui-select-option__checkmark","src","tuiIconCheckLarge","class","t-checkmark",3,"tuiScrollIntoView",4,"ngIf","ngIfElse"],["dummy",""],["automation-id","tui-select-option__checkmark","src","tuiIconCheckLarge",1,"t-checkmark",3,"tuiScrollIntoView"],[1,"t-dummy"]],template:function(W,me){if(1&W&&(n.GkF(0,0),n.YNc(1,R,1,1,"tui-svg",1),n.ALo(2,"async"),n.YNc(3,C,1,0,"ng-template",null,2,n.W1O)),2&W){const w=n.MAs(4);n.Q6J("ngTemplateOutlet",me.context.$implicit),n.xp6(1),n.Q6J("ngIf",n.lcZ(2,3,me.selected$))("ngIfElse",w)}},dependencies:[U.PN,N.tP,N.O5,ne,N.Ov],styles:["@keyframes _ngcontent-%COMP%_retrigger{0%{left:1px}to{left:2px}}[_nghost-%COMP%]{display:flex;flex:1;align-items:center;max-width:100%;animation:_ngcontent-%COMP%_retrigger 1s}.t-checkmark[_ngcontent-%COMP%]{margin:0 -.375rem 0 auto;border-left:5px solid transparent}.t-dummy[_ngcontent-%COMP%]{width:1.5rem}"],changeDetection:0}),O})();const te=new K.Al(Y);let le=(()=>{class O{}return O.\u0275fac=function(W){return new(W||O)},O.\u0275mod=n.oAB({type:O}),O.\u0275inj=n.cJS({imports:[[N.ez,U.EI,ae]]}),O})()},21469:(ge,oe,u)=>{u.d(oe,{Jy:()=>Ce,OI:()=>ve,uJ:()=>ce});var n=u(94650),a=u(93422),d=u(1054),e=u(47776),J=u(39255),c=u(37414),U=u(68923),A=u(91127),k=u(60117),x=u(71115),f=u(47846),L=u(31947),E=u(53861),ne=u(96966),ae=u(56772),q=u(36895),X=u(70655),K=u(90433),I=u(68341),Z=u(74606),M=u(87377),$=u(15135),de=u(89740);function H(v,F){1&v&&(n.ynx(0),n.Hsn(1,2,["ngProjectAs","select",5,["select"]]),n.BQk())}function W(v,F){if(1&v&&n.YNc(0,H,2,0,"ng-container",6),2&v){const m=n.oxw();n.Q6J("ngIf",m.isMobile)}}function me(v,F){1&v&&n.GkF(0,7)}function w(v,F){1&v&&n._UZ(0,"div",10),2&v&&n.Q6J("textContent",F.polymorpheusOutlet)}const j=function(v,F){return{$implicit:v,active:F}};function T(v,F){if(1&v&&(n.TgZ(0,"div",8),n.YNc(1,w,1,1,"div",9),n.qZA()),2&v){const m=n.oxw();n.xp6(1),n.Q6J("polymorpheusOutlet",m.computedContent)("polymorpheusOutletContext",n.WLB(2,j,m.value,m.computedFocused))}}function B(v,F){1&v&&n.GkF(0)}function z(v,F){if(1&v&&(n.TgZ(0,"div",11),n.YNc(1,B,1,0,"ng-container",12),n.qZA()),2&v){const m=n.oxw();n.xp6(1),n.Q6J("polymorpheusOutlet",m.arrow)}}const pe=["*",[["input"]],[["select"]]],Te=["*","input","select"];let fe=(()=>{class v{constructor(m,b,p,h){this.host=m,this.control=b,this.elementRef=p,this.idService=h,this.datalist=null,this.host.process(this.elementRef.nativeElement)}get id(){return this.elementRef.nativeElement.id||this.idService.generate()}}return v.\u0275fac=function(m){return new(m||v)(n.Y36(L.S0),n.Y36(d.M$),n.Y36(n.SBq),n.Y36(e.ll))},v.\u0275dir=n.lG2({type:v,viewQuery:function(m,b){if(1&m&&n.Gf(E.gX,7,n.Rgc),2&m){let p;n.iGM(p=n.CRH())&&(b.datalist=p.first)}},hostVars:1,hostBindings:function(m,b){2&m&&n.Ikx("id",b.id)}}),v})();const _={valueContent:""},D=new n.OlP("[TUI_SELECT_OPTIONS]",{factory:()=>_});let ce=(()=>{class v extends d.F9{constructor(m,b,p,h,Q,ie,se){super(m,b),this.textfieldCleaner=p,this.arrowMode=h,this.itemsHandlers=Q,this.options=ie,this.isMobile=se,this.stringify=this.itemsHandlers.stringify,this.identityMatcher=this.itemsHandlers.identityMatcher,this.valueContent=this.options.valueContent,this.datalist=""}get arrow(){return this.interactive?this.arrowMode.interactive:this.arrowMode.disabled}get nativeFocusableElement(){return this.textfield?this.textfield.nativeFocusableElement:null}get focused(){return(0,J.V8)(this.nativeFocusableElement)||!!this.hostedDropdown&&this.hostedDropdown.focused}get nativeDropdownMode(){return!!this.nativeSelect&&this.isMobile}get computedValue(){return null===this.value?"":this.stringify(this.value)||" "}get computedContent(){return this.valueContent||this.computedValue}onValueChange(m){this.updateValue(m&&m||null)}onActiveZone(m){this.updateFocused(m)}onKeyDownDelete(){this.textfieldCleaner.cleaner&&this.updateValue(null)}handleOption(m){var b;this.focusInput(),this.updateValue(m),null===(b=this.hostedDropdown)||void 0===b||b.updateOpen(!1)}focusInput(m=!1){this.nativeFocusableElement&&this.nativeFocusableElement.focus({preventScroll:m})}}return v.\u0275fac=function(m){return new(m||v)(n.Y36(K.a5,10),n.Y36(n.sBO),n.Y36(x.Ym),n.Y36(I.Ii),n.Y36($.Ys),n.Y36(D),n.Y36(c.fL))},v.\u0275cmp=n.Xpm({type:v,selectors:[["tui-select"]],contentQueries:function(m,b,p){if(1&m&&(n.Suo(p,fe,7),n.Suo(p,E.gX,5,n.Rgc)),2&m){let h;n.iGM(h=n.CRH())&&(b.nativeSelect=h.first),n.iGM(h=n.CRH())&&(b.datalist=h.first)}},viewQuery:function(m,b){if(1&m&&(n.Gf(k.yc,5),n.Gf(A.o1,5)),2&m){let p;n.iGM(p=n.CRH())&&(b.textfield=p.first),n.iGM(p=n.CRH())&&(b.hostedDropdown=p.first)}},inputs:{stringify:"stringify",identityMatcher:"identityMatcher",valueContent:"valueContent"},features:[n._Bn([(0,c.FT)(v),(0,d.wB)(v),(0,L.oE)(v),(0,L.P7)(Z.Q4)],[M.yn]),n.qOj],ngContentSelectors:Te,decls:10,vars:15,consts:[[1,"t-hosted",3,"canOpen","content","tuiActiveZoneChange"],["automation-id","tui-select__textfield",1,"t-textfield",3,"tuiTextfieldIcon","editable","pseudoFocus","pseudoHover","pseudoActive","invalid","nativeId","readOnly","disabled","focusable","value","valueChange","keydown.delete.prevent","keydown.backspace.prevent"],["select",""],["ngProjectAs","select",5,["select"],4,"ngTemplateOutlet"],["ngProjectAs","tuiContent","automation-id","tui-select__value","class","t-value",5,["tuiContent"],4,"ngIf"],["icon",""],[4,"ngIf"],["ngProjectAs","select",5,["select"]],["ngProjectAs","tuiContent","automation-id","tui-select__value",5,["tuiContent"],1,"t-value"],["class","t-primitive-value",3,"textContent",4,"polymorpheusOutlet","polymorpheusOutletContext"],[1,"t-primitive-value",3,"textContent"],["tuiWrapper","","appearance","icon",1,"t-icon"],[4,"polymorpheusOutlet"]],template:function(m,b){if(1&m&&(n.F$t(pe),n.TgZ(0,"tui-hosted-dropdown",0),n.NdJ("tuiActiveZoneChange",function(h){return b.onActiveZone(h)}),n.TgZ(1,"tui-primitive-textfield",1),n.NdJ("valueChange",function(h){return b.onValueChange(h)})("keydown.delete.prevent",function(){return b.onKeyDownDelete()})("keydown.backspace.prevent",function(){return b.onKeyDownDelete()}),n.Hsn(2),n.Hsn(3,1,["ngProjectAs","input",5,["input"]]),n.YNc(4,W,1,1,"ng-template",null,2,n.W1O),n.YNc(6,me,1,0,"ng-container",3),n.YNc(7,T,2,5,"div",4),n.qZA(),n.YNc(8,z,2,1,"ng-template",null,5,n.W1O),n.qZA()),2&m){const p=n.MAs(5),h=n.MAs(9);n.Q6J("canOpen",b.interactive&&!b.nativeDropdownMode)("content",b.datalist||""),n.xp6(1),n.Q6J("tuiTextfieldIcon",b.arrow?h:"")("editable",!1)("pseudoFocus",b.computedFocused)("pseudoHover",b.pseudoHover)("pseudoActive",b.pseudoActive)("invalid",b.computedInvalid)("nativeId",b.nativeId)("readOnly",b.readOnly)("disabled",b.computedDisabled)("focusable",b.computedFocusable)("value",b.computedValue),n.xp6(5),n.Q6J("ngTemplateOutlet",p),n.xp6(1),n.Q6J("ngIf",null!==b.value)}},dependencies:[A.o1,k.yc,a.e,k.B1,x.AW,q.O5,q.tP,de.Li,f.o],styles:["[_nghost-%COMP%]{display:block;border-radius:var(--tui-radius-m);text-align:left}[_nghost-%COMP%]:not(._readonly)     input:not(:disabled){cursor:pointer}._readonly[_nghost-%COMP%]     input{cursor:default}.t-hosted[_ngcontent-%COMP%]{display:block;border-radius:inherit}.t-textfield[_ngcontent-%COMP%]{border-radius:inherit;text-align:inherit}.t-value[_ngcontent-%COMP%]{display:flex;width:100%;align-items:center}.t-primitive-value[_ngcontent-%COMP%]{white-space:nowrap;overflow:hidden;text-overflow:ellipsis}"],changeDetection:0}),(0,X.gn)([(0,U.TH)()],v.prototype,"stringify",void 0),(0,X.gn)([(0,U.TH)()],v.prototype,"identityMatcher",void 0),(0,X.gn)([(0,U.TH)()],v.prototype,"valueContent",void 0),v})(),ve=(()=>{class v extends ne.D1{get readOnly(){return!0}get value(){return this.host.computedValue}onValueChange(m){this.host.onValueChange(m)}}return v.\u0275fac=function(){let F;return function(b){return(F||(F=n.n5z(v)))(b||v)}}(),v.\u0275dir=n.lG2({type:v,selectors:[["tui-select"]],features:[n._Bn([(0,L.cp)(v)]),n.qOj]}),v})(),Ce=(()=>{class v{}return v.\u0275fac=function(m){return new(m||v)},v.\u0275mod=n.oAB({type:v}),v.\u0275inj=n.cJS({imports:[[q.ez,de.wq,a.A,k.KW,A.jh,Z.Ig,I.Mt,f.W,x.cn,ae.zX,E.pc]]}),v})()},94813:(ge,oe,u)=>{u.d(oe,{j:()=>a});var n=u(54004);function a(...d){const e=d.length;if(0===e)throw new Error("list of properties cannot be empty.");return(0,n.U)(J=>{let c=J;for(let U=0;U<e;U++){const A=c?.[d[U]];if(!(typeof A<"u"))return;c=A}return c})}}}]);