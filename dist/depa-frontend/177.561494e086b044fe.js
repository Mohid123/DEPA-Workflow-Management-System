"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[177],{21177:(G,C,s)=>{s.r(C),s.d(C,{FormsModule:()=>p});var h=s(36895),c=s(19132),t=s(94650);class v{}v.\u0275fac=function(e){return new(e||v)},v.\u0275cmp=t.Xpm({type:v,selectors:[["app-forms"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},dependencies:[c.lC]});var l=s(90433),T=s(77579),x=s(82722),b=s(20696),I=s(22603),D=s(94051),y=s(60101),u=s(75809),F=s(39367),S=s(56546);const Z=["json"],N=["code"];function w(i,e){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",4),t.NdJ("click",function(){const m=t.CHM(o).index,a=t.oxw();return a.activeIndex=m,t.KtG(a.onJsonView())}),t._UZ(2,"i",5),t._uU(3),t.qZA(),t.BQk()}if(2&i){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function J(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"section",6)(1,"div",7)(2,"div",8)(3,"label",9),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.qZA()(),t.TgZ(6,"form-builder",11),t.NdJ("change",function(n){t.CHM(o);const m=t.oxw();return t.KtG(m.onChange(n))}),t.qZA(),t.TgZ(7,"div",12)(8,"button",13),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.submitFormData())}),t._uU(9," Submit Form "),t.qZA(),t.TgZ(10,"button",14),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.cancelFormData())}),t._uU(11," Cancel "),t.qZA()()()}if(2&i){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("form",o.form)}}function B(i,e){if(1&i&&(t.TgZ(0,"section",6)(1,"div",15),t._UZ(2,"formio",16),t.qZA()()),2&i){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function M(i,e){1&i&&(t.TgZ(0,"section",6)(1,"div",15)(2,"pre",17),t._UZ(3,"code",18),t.qZA()()())}class g{constructor(e,o,r,n,m){this.transportService=e,this.notif=o,this.router=r,this.activatedRoute=n,this.formService=m,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode}),this.formDisplayType=new l.NI("form"),this.destroy$=new T.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.editMode=this.transportService.isFormEdit.value,this.activatedRoute.queryParams?.subscribe(a=>{a.key&&this.formService.getFormByKey(a.key).pipe((0,x.R)(this.destroy$)).subscribe(d=>{d&&(this.form=d,this.formTitleControl.setValue(d?.title))}),!0===this.editMode?(this.form=this.transportService.sendFormDataForEdit.value,this.formTitleControl.setValue(this.transportService.sendFormDataForEdit.value.title),this.formTitleControl.disable()):this.form={title:this.formTitleControl?.value,key:"",display:this.formDisplayType.value,components:[]}})}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,this.formValue=e.form}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value)return this.notif.displayNotification("Please provide a title for your form","Create Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("You have not created a form!","Create Form","warning");if(this.form.title=this.formTitleControl?.value,this.form.display=this.formDisplayType?.value,this.form.key=this.formTitleControl?.value?.replace(" ","-"),0==this.editMode)if(this.transportService.formBuilderData.value[0].components?.length>0){const e=[...this.transportService.formBuilderData.value,this.form];this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}else this.transportService.sendFormBuilderData([this.form]),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value]);else{const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){if(0==this.editMode)this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value]);else{const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.router.navigate(["/modules/add-submodule",this.transportService.moduleID?.value])}}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}g.\u0275fac=function(e){return new(e||g)(t.Y36(b.R),t.Y36(I.T),t.Y36(c.F0),t.Y36(c.gz),t.Y36(D.s))},g.\u0275cmp=t.Xpm({type:g,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(Z,7),t.Gf(N,7)),2&e){let r;t.iGM(r=t.CRH())&&(o.jsonElement=r.first),t.iGM(r=t.CRH())&&(o.codeElement=r.first)}},decls:7,vars:5,consts:[[1,"py-5","mt-40"],["tuiMobileTabs","",1,"flex","justify-center","mx-2","lg:mx-20","md:mx-10",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","w-8/12","grid-cols-12","gap-3","px-1","mx-auto","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],[3,"form","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t._UZ(0,"app-header"),t.TgZ(1,"section",0)(2,"tui-tabs",1),t.YNc(3,w,4,3,"ng-container",2),t.qZA()(),t.YNc(4,J,12,2,"section",3),t.YNc(5,B,3,2,"section",3),t.YNc(6,M,4,0,"section",3)),2&e&&(t.xp6(2),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[h.sg,h.O5,y.k4,y.hd,u.H9,u.p_,u.yu,F.v0,S.G,l.Fj,l.JJ,l.oH]});const E=["json"],j=["code"];function A(i,e){if(1&i){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",4),t.NdJ("click",function(){const m=t.CHM(o).index,a=t.oxw();return a.activeIndex=m,t.KtG(a.onJsonView())}),t._UZ(2,"i",5),t._uU(3),t.qZA(),t.BQk()}if(2&i){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function U(i,e){if(1&i){const o=t.EpF();t.TgZ(0,"section",6)(1,"div",7)(2,"div",8)(3,"label",9),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.qZA()(),t.TgZ(6,"form-builder",11),t.NdJ("change",function(n){t.CHM(o);const m=t.oxw();return t.KtG(m.onChange(n))}),t.qZA(),t.TgZ(7,"div",12)(8,"button",13),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.submitFormData())}),t._uU(9," Submit Form "),t.qZA(),t.TgZ(10,"button",14),t.NdJ("click",function(){t.CHM(o);const n=t.oxw();return t.KtG(n.cancelFormData())}),t._uU(11," Cancel "),t.qZA()()()}if(2&i){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("form",o.form)}}function k(i,e){if(1&i&&(t.TgZ(0,"section",6)(1,"div",15),t._UZ(2,"formio",16),t.qZA()()),2&i){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function Q(i,e){1&i&&(t.TgZ(0,"section",6)(1,"div",15)(2,"pre",17),t._UZ(3,"code",18),t.qZA()()())}class _{constructor(e,o,r,n,m){this.notif=e,this.router=o,this.activatedRoute=r,this.formService=n,this.transportService=m,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode}),this.formDisplayType=new l.NI("form"),this.destroy$=new T.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.activatedRoute?.queryParams?.subscribe(a=>{a.id?(this.editFormID=a.id,this.formService.getFormById(a.id).pipe((0,x.R)(this.destroy$)).subscribe(d=>{d&&(this.form=d,this.formTitleControl.setValue(d?.title))})):this.form={title:this.formTitleControl?.value,key:null,display:this.formDisplayType.value||null,components:[]}})}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,this.formValue=e.form}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value)return this.notif.displayNotification("Please provide a title for your form","Edit Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("Your form cannot be empty!","Edit Form","warning");const e={title:this.formTitleControl?.value,key:this.form?.key??this.formTitleControl?.value?.replace(" ","-"),display:this.form?.display??this.formDisplayType.value,components:this.form?.components};this.editFormID?this.formService.updateForm(this.editFormID,e).pipe((0,x.R)(this.destroy$)).subscribe(o=>{o&&setTimeout(()=>this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}}),1200)}):(Object.assign(e,{subModuleId:this.transportService.subModuleID?.value}),this.formService.createForm(e).pipe((0,x.R)(this.destroy$)).subscribe(o=>{o&&setTimeout(()=>this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}}),1200)}))}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){this.router.navigate(["/modules/edit-submodule",this.transportService.subModuleID?.value],{queryParams:{moduleCode:this.transportService?.moduleCode?.value,moduleID:this.transportService?.moduleID?.value}})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}_.\u0275fac=function(e){return new(e||_)(t.Y36(I.T),t.Y36(c.F0),t.Y36(c.gz),t.Y36(D.s),t.Y36(b.R))},_.\u0275cmp=t.Xpm({type:_,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(E,7),t.Gf(j,7)),2&e){let r;t.iGM(r=t.CRH())&&(o.jsonElement=r.first),t.iGM(r=t.CRH())&&(o.codeElement=r.first)}},decls:6,vars:5,consts:[[1,"py-5"],["tuiMobileTabs","",1,"mx-2","lg:mx-20","md:mx-10","flex","justify-center",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","grid-cols-12","gap-3","w-8/12","mx-auto","px-1","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],[3,"form","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t.TgZ(0,"section",0)(1,"tui-tabs",1),t.YNc(2,A,4,3,"ng-container",2),t.qZA()(),t.YNc(3,U,12,2,"section",3),t.YNc(4,k,3,2,"section",3),t.YNc(5,Q,4,0,"section",3)),2&e&&(t.xp6(1),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[h.sg,h.O5,y.k4,y.hd,u.H9,u.p_,u.yu,F.v0,l.Fj,l.JJ,l.oH]});const R=[{path:"",component:v,children:[{path:"form-builder",component:g,data:{breadcrumb:"Form builder"}},{path:"edit-form",component:_,data:{breadcrumb:"Edit-Form"}},{path:"",redirectTo:"form-builder",pathMatch:"full"}]}];class f{}f.\u0275fac=function(e){return new(e||f)},f.\u0275mod=t.oAB({type:f}),f.\u0275inj=t.cJS({imports:[c.Bz.forChild(R),c.Bz]});var Y=s(77915);class p{}p.\u0275fac=function(e){return new(e||p)},p.\u0275mod=t.oAB({type:p}),p.\u0275inj=t.cJS({imports:[h.ez,f,y.XI,u.$$,F.fN,S.G,l.UX,Y.e]})}}]);