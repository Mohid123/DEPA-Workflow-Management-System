"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[765],{22765:(Nt,G,a)=>{a.r(G),a.d(G,{WorkflowsModule:()=>T});var p=a(36895),f=a(19132),e=a(94650);class w{}w.\u0275fac=function(o){return new(o||w)},w.\u0275cmp=e.Xpm({type:w,selectors:[["app-workflows"]],decls:1,vars:0,template:function(o,t){1&o&&e._UZ(0,"router-outlet")},dependencies:[f.lC]});var u=a(90433),H=a(1163),be=a(39646),g=a(77579),O=a(61135),d=a(82722),K=a(94813),x=a(54004),E=a(63900),we=a(95698),Z=a(34782),xe=a(61005),ve=a(80529),Q=a(22603);class _ extends xe.s{constructor(o,t){super(o),this.http=o,this.notif=t}getWorkflowSubmission(o){return this.get(`/submissions/${o}`).pipe((0,Z.d)(),(0,x.U)(t=>{if(!t.hasErrors())return t.data;t.errors[0].code&&![401,403].includes(t.errors[0].code)&&this.notif.displayNotification("Failed to fetch workflow","Get Submodule workflow","error")}))}getSubmissionFromSubModule(o,t,i,s,r){const l={subModuleId:o,limit:t,page:i,sortBy:r||void 0,submissionStatus:s||void 0};return null==l.submissionStatus&&delete l.submissionStatus,null==l.sortBy&&delete l.sortBy,this.get("/submissions",l).pipe((0,Z.d)(),(0,x.U)(m=>m.hasErrors()?m.errors[0].code&&![401,403].includes(m.errors[0].code)?this.notif.displayNotification("Failed to fetch workflow","Get Submodule workflow","error"):void 0:m.data))}updateSubmissionWorkflow(o,t){return this.patch(`/submissions/${o}`,t).pipe((0,Z.d)(),(0,x.U)(i=>i.hasErrors()?i.errors[0].code&&![401,403].includes(i.errors[0].code)?this.notif.displayNotification(i.errors[0]?.error?.message,"Update Submission","error"):void 0:(this.notif.displayNotification("Descision made, Workflow updated.","Update Submission","success"),i.data)))}addNewSubmission(o){return this.post("/submissions",o).pipe((0,Z.d)(),(0,x.U)(t=>t.hasErrors()?t.errors[0].code&&![401,403].includes(t.errors[0].code)?this.notif.displayNotification(t.errors[0]?.error?.message,"Create Submission","error"):void 0:(this.notif.displayNotification("Submission created successfully","Create Submission","success"),t.data)))}updateFormsData(o,t){return this.patch(`/formsData/${t}`,o).pipe((0,Z.d)(),(0,x.U)(i=>i.hasErrors()?i.errors[0].code&&![401,403].includes(i.errors[0].code)?this.notif.displayNotification(i.errors[0]?.error?.message,"Update Forms Data","error"):void 0:(this.notif.displayNotification("Form data updated successfully","Update Forms data","success"),i.data)))}}_.\u0275fac=function(o){return new(o||_)(e.LFG(ve.eN),e.LFG(Q.T))},_.\u0275prov=e.Yz7({token:_,factory:_.\u0275fac,providedIn:"root"});var L=a(15274),D=a(56546),W=a(5754),Y=a(60101),N=a(67155),q=a(35601),F=a(70655),X=a(68702),ee=a(79982),te=a(88261),oe=a(80063),ne=a(1054),ye=a(39255),ke=a(37414),P=a(68923);let Ce=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({}),n})();var J=a(87819),I=a(8276),ie=a(47846),Te=a(82302),se=a(89740);const Ze=["focusableElement"];function Ie(n,o){if(1&n&&e._UZ(0,"tui-loader",7),2&n){const t=e.oxw();e.Q6J("size",t.loaderSize)("inheritColor",!0)("showLoader",t.checked)}}function Ae(n,o){1&n&&e._UZ(0,"tui-svg",10),2&n&&e.Q6J("src",o.polymorpheusOutlet)}const re=function(n){return{$implicit:n}};function Ue(n,o){if(1&n&&(e.TgZ(0,"span",8),e.YNc(1,Ae,1,1,"tui-svg",9),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("polymorpheusOutlet",t.iconOn)("polymorpheusOutletContext",e.VKq(2,re,t.size))}}function Se(n,o){if(1&n&&e._UZ(0,"tui-loader",7),2&n){const t=e.oxw();e.Q6J("size",t.loaderSize)("inheritColor",!0)("showLoader",!t.checked)}}function Me(n,o){1&n&&e._UZ(0,"tui-svg",12),2&n&&e.Q6J("src",o.polymorpheusOutlet)}function Oe(n,o){if(1&n&&(e.TgZ(0,"span",8),e.YNc(1,Me,1,1,"tui-svg",11),e.qZA()),2&n){const t=e.oxw();e.xp6(1),e.Q6J("polymorpheusOutlet",t.iconOff)("polymorpheusOutletContext",e.VKq(2,re,t.size))}}const ae={icons:{toggleOff:({$implicit:n})=>"m"===n?"tuiIconToggleOff":"tuiIconToggleOffLarge",toggleOn:({$implicit:n})=>"m"===n?"tuiIconToggleOn":"tuiIconToggleOnLarge"},singleColor:!1,showIcons:!1,size:"m"},le=new e.OlP("[TUI_TOGGLE_OPTIONS]",{factory:()=>ae});let De=(()=>{class n extends ne.M${constructor(t,i,s,r){super(t,i),this.modeDirective=s,this.options=r,this.singleColor=this.options.singleColor,this.showIcons=this.options.showIcons,this.showLoader=!1,this.size=this.options.size}get iconOn(){return this.options.icons.toggleOn}get iconOff(){return this.options.icons.toggleOff}get nativeFocusableElement(){return this.focusableElement?this.focusableElement.nativeElement:null}get focused(){return(0,ye.V8)(this.nativeFocusableElement)}get appearance(){return this.singleColor||this.checked?"primary":"secondary"}get sizeM(){return"m"===this.size}get checked(){return this.value}get loaderSize(){return this.sizeM?"xs":"s"}get hostMode(){return this.modeDirective?this.modeDirective.mode:null}onChecked(t){this.updateValue(t)}onFocused(t){this.updateFocused(t)}onFocusVisible(t){this.updateFocusVisible(t)}getFallbackValue(){return!1}}return n.\u0275fac=function(t){return new(t||n)(e.Y36(u.a5,10),e.Y36(e.sBO),e.Y36(Te.w,8),e.Y36(le))},n.\u0275cmp=e.Xpm({type:n,selectors:[["tui-toggle"]],viewQuery:function(t,i){if(1&t&&e.Gf(Ze,5),2&t){let s;e.iGM(s=e.CRH())&&(i.focusableElement=s.first)}},hostVars:4,hostBindings:function(t,i){2&t&&(e.uIk("data-size",i.size)("data-mode",i.hostMode),e.ekj("_checked",i.checked))},inputs:{singleColor:"singleColor",showIcons:"showIcons",showLoader:"showLoader",size:"size"},features:[e._Bn([(0,ke.FT)(n),(0,ne.wB)(n)]),e.qOj],decls:9,vars:16,consts:[["tuiWrapper","",3,"appearance","readOnly","disabled","focus","hover","active","invalid"],[1,"t-toggle"],["class","t-loader",3,"size","inheritColor","showLoader",4,"ngIf"],["class","t-icon-wrapper",4,"ngIf"],[1,"t-circle"],["type","checkbox","role","switch","automation-id","tui-toggle__checkbox",1,"t-checkbox",3,"id","disabled","tuiChecked","tuiFocusable","tuiCheckedChange","tuiFocusedChange","tuiFocusVisibleChange"],["focusableElement",""],[1,"t-loader",3,"size","inheritColor","showLoader"],[1,"t-icon-wrapper"],["automation-id","tui-toggle__check-icon","class","t-icon",3,"src",4,"polymorpheusOutlet","polymorpheusOutletContext"],["automation-id","tui-toggle__check-icon",1,"t-icon",3,"src"],["automation-id","tui-toggle__cancel-icon","class","t-icon t-icon_off",3,"src",4,"polymorpheusOutlet","polymorpheusOutletContext"],["automation-id","tui-toggle__cancel-icon",1,"t-icon","t-icon_off",3,"src"]],template:function(t,i){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e.YNc(2,Ie,1,3,"tui-loader",2),e.YNc(3,Ue,2,4,"span",3),e._UZ(4,"div",4),e.YNc(5,Se,1,3,"tui-loader",2),e.YNc(6,Oe,2,4,"span",3),e.qZA(),e.TgZ(7,"input",5,6),e.NdJ("tuiCheckedChange",function(r){return i.onChecked(r)})("tuiFocusedChange",function(r){return i.onFocused(r)})("tuiFocusVisibleChange",function(r){return i.onFocusVisible(r)}),e.qZA()()),2&t&&(e.Q6J("appearance",i.appearance)("readOnly",i.readOnly)("disabled",i.computedDisabled)("focus",i.computedFocusVisible)("hover",i.pseudoHover)("active",i.pseudoActive)("invalid",i.computedInvalid),e.xp6(2),e.Q6J("ngIf",i.showLoader),e.xp6(1),e.Q6J("ngIf",i.showIcons&&!i.showLoader),e.xp6(2),e.Q6J("ngIf",i.showLoader),e.xp6(1),e.Q6J("ngIf",i.showIcons&&!i.showLoader),e.xp6(1),e.Q6J("id",i.id)("disabled",i.disabled)("tuiChecked",i.checked)("tuiFocusable",i.focusable),e.uIk("aria-checked",i.value))},dependencies:[J.kM,I.PN,ie.o,p.O5,se.Li,X.t,ee.t,te.U,oe.q],styles:["[_nghost-%COMP%]{position:relative;display:inline-block;vertical-align:middle;overflow:hidden;border-radius:6.25rem}[data-size=m][_nghost-%COMP%]{width:2rem;height:1rem}[data-size=l][_nghost-%COMP%]{width:3rem;height:1.5rem}.t-checkbox[_ngcontent-%COMP%]{padding:0;margin:0;border:0;border-radius:inherit;background:none;font-size:inherit;line-height:inherit;font-weight:inherit;color:inherit;caret-color:currentColor;outline:none;-webkit-appearance:none;-moz-appearance:none;appearance:none;word-break:keep-all;-webkit-text-fill-color:currentColor;position:absolute;top:0;left:0;height:100%;width:100%;opacity:0;cursor:pointer}.t-checkbox[_ngcontent-%COMP%]:-webkit-autofill, .t-checkbox[_ngcontent-%COMP%]:-webkit-autofill:hover, .t-checkbox[_ngcontent-%COMP%]:-webkit-autofill:focus{caret-color:var(--tui-base-09);border-radius:inherit;color:inherit!important;background-color:transparent!important;-webkit-text-fill-color:var(--tui-text-01)!important;border-color:var(--tui-autofill);-webkit-box-shadow:0 0 0 100rem var(--tui-autofill) inset!important}._disabled[_nghost-%COMP%]   .t-checkbox[_ngcontent-%COMP%]{pointer-events:none;cursor:default}.t-toggle[_ngcontent-%COMP%]{transition-property:transform;transition-duration:var(--tui-duration, .3s);transition-timing-function:ease-in-out;display:flex;align-items:center;justify-content:center}[data-size=m][_nghost-%COMP%]   .t-toggle[_ngcontent-%COMP%]{width:3rem;height:1rem;transform:translate(-1rem)}[data-size=l][_nghost-%COMP%]   .t-toggle[_ngcontent-%COMP%]{width:4.5rem;height:1.5rem;transform:translate(-1.5rem)}._checked[_nghost-%COMP%]   .t-toggle[_ngcontent-%COMP%]{transform:translate(0)}.t-circle[_ngcontent-%COMP%]{margin:.125rem 0;flex-shrink:0;border-radius:100%;background-color:var(--tui-base-01)}._disabled[_nghost-%COMP%]   .t-circle_light[_ngcontent-%COMP%]{opacity:.24}[data-size=m][_nghost-%COMP%]   .t-circle[_ngcontent-%COMP%]{width:.75rem;height:.75rem}[data-size=l][_nghost-%COMP%]   .t-circle[_ngcontent-%COMP%]{width:1rem;height:1rem}._disabled[_nghost-%COMP%]   .t-circle[_ngcontent-%COMP%]{background-color:var(--tui-base-01)}[_nghost-%COMP%]:not(._checked)   .t-loader[_ngcontent-%COMP%]{color:var(--tui-base-06)}[_nghost-%COMP%]:not(._checked)._disabled   .t-loader[_ngcontent-%COMP%]{color:var(--tui-base-05)}[_nghost-%COMP%]:not(._checked)[data-mode=onDark]   .t-loader[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}[_nghost-%COMP%]:not(._checked)[data-mode=onDark]._disabled   .t-loader[_ngcontent-%COMP%]{color:var(--tui-clear-inverse-active)}[_nghost-%COMP%]:not(._checked)[data-mode=onLight]   .t-loader[_ngcontent-%COMP%]{color:var(--tui-text-03)}[_nghost-%COMP%]:not(._checked)[data-mode=onLight]._disabled   .t-loader[_ngcontent-%COMP%]{color:var(--tui-clear-active)}[data-size=m][_nghost-%COMP%]   .t-loader[_ngcontent-%COMP%]{width:.75rem;margin:0 .2rem;transform:scale(.75)}[data-size=l][_nghost-%COMP%]   .t-loader[_ngcontent-%COMP%]{width:1rem;margin:0 .25rem}.t-icon-wrapper[_ngcontent-%COMP%]{display:flex}.t-icon[_ngcontent-%COMP%]{opacity:.8}.t-icon_off[_ngcontent-%COMP%]{color:var(--tui-base-06)}._disabled[_nghost-%COMP%]   .t-icon_off[_ngcontent-%COMP%]{color:var(--tui-base-05)}[data-mode=onDark][_nghost-%COMP%]   .t-icon_off[_ngcontent-%COMP%]{color:var(--tui-text-03-night)}[data-mode=onDark]._disabled[_nghost-%COMP%]   .t-icon_off[_ngcontent-%COMP%]{color:var(--tui-clear-inverse-active)}[data-mode=onLight][_nghost-%COMP%]   .t-icon_off[_ngcontent-%COMP%]{color:var(--tui-text-03)}[data-mode=onLight]._disabled[_nghost-%COMP%]   .t-icon_off[_ngcontent-%COMP%]{color:var(--tui-clear-active)}[data-size=m][_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{width:1rem;height:1rem;transform:scale(.75)}[data-size=l][_nghost-%COMP%]   .t-icon[_ngcontent-%COMP%]{margin:0 .125rem;width:1.5rem;height:1.5rem}[_nghost-%COMP%]:hover   .t-icon[_ngcontent-%COMP%]{opacity:1}"],changeDetection:0}),(0,F.gn)([(0,P.TH)()],n.prototype,"singleColor",void 0),(0,F.gn)([(0,P.TH)()],n.prototype,"showIcons",void 0),(0,F.gn)([(0,P.TH)()],n.prototype,"showLoader",void 0),(0,F.gn)([(0,P.TH)()],n.prototype,"size",void 0),n})(),Ne=(()=>{class n{}return n.\u0275fac=function(t){return new(t||n)},n.\u0275mod=e.oAB({type:n}),n.\u0275inj=e.cJS({imports:[[p.ez,te.F,ee.u,Ce,oe.c,X.S,ie.W,I.EI,J.dS,se.wq]]}),n})();var ue=a(80311),b=a(75809),B=a(39367);class v{}function Fe(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",22),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.activeIndex=r)}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}v.\u0275fac=function(o){return new(o||v)},v.\u0275cmp=e.Xpm({type:v,selectors:[["app-workflow-skeleton"]],standalone:!0,features:[e.jDz],decls:21,vars:0,consts:[[1,"h-3","bg-gray-200","rounded-sm","w-48","mb-4","animate-pulse"],[1,"h-48","bg-gray-200","rounded-md","w-full","mb-4","animate-pulse","px-20","py-6"],[1,"h-2","bg-gray-300","rounded-sm","w-64","mb-4","animate-pulse"],[1,"h-8","bg-gray-300","rounded-sm","w-full","mb-4","animate-pulse"],[1,"h-3","bg-gray-300","rounded-sm","w-48","mb-4","mt-7","animate-pulse"],[1,"flex","flex-col","justify-center","items-center","align-middle"],[1,"h-44","bg-gray-200","rounded-md","w-140","mb-4","animate-pulse","px-12","py-7"],[1,"h-6","bg-gray-300","rounded-full","w-28","mb-4","animate-pulse"],[1,"h-3","bg-gray-300","rounded-sm","w-68","mb-4","animate-pulse"],[1,"h-3","bg-gray-300","rounded-sm","w-48","my-4","animate-pulse"],[1,"flex","justify-between"],[1,"w-28","h-28","bg-white","border-8","rounded-full","block","border-gray-300"],[1,"h-40","bg-gray-200","rounded-lg","w-full","mb-4","animate-pulse","ml-4"]],template:function(o,t){1&o&&(e._UZ(0,"div",0),e.TgZ(1,"div",1),e._UZ(2,"div",2)(3,"div",3)(4,"br")(5,"div",2)(6,"div",3),e.qZA(),e._UZ(7,"div",4),e.TgZ(8,"div",5)(9,"div",6),e._UZ(10,"div",7)(11,"div",8)(12,"div",8),e.qZA(),e.TgZ(13,"div",6),e._UZ(14,"div",7)(15,"div",8)(16,"div",8),e.qZA()(),e._UZ(17,"div",9),e.TgZ(18,"div",10),e._UZ(19,"div",11)(20,"div",12),e.qZA())},dependencies:[p.ez],changeDetection:0});const Pe=function(){return{disableAlerts:!0}};function Je(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",24)(1,"formio",25),e.NdJ("submit",function(s){e.CHM(t);const r=e.oxw(3);return e.KtG(r.updateFormData(s))}),e.qZA()()}if(2&n){const t=e.oxw().$implicit,i=e.oxw(2);e.xp6(1),e.Q6J("readOnly",1==i.checkIfAllApproved()||0==i.checkIfLoggedInUserIsPartOfActiveUsers()||0==i.checkIfUserIsInEditUsers())("options",e.DdM(4,Pe))("submission",t)("form",t)}}function Ve(n,o){if(1&n&&(e.ynx(0),e.YNc(1,Je,2,5,"div",23),e.BQk()),2&n){const t=o.index,i=e.oxw(2);e.xp6(1),e.Q6J("ngIf",i.activeIndex==t)}}function Ee(n,o){1&n&&(e.ynx(0),e.TgZ(1,"tui-badge",29),e._UZ(2,"tui-svg",30),e.qZA(),e._UZ(3,"hr",31),e.BQk()),2&n&&(e.xp6(1),e.Q6J("value","Pending"))}function Qe(n,o){1&n&&(e.ynx(0),e.TgZ(1,"tui-badge",32),e._UZ(2,"tui-svg",33),e.qZA(),e._UZ(3,"hr",31),e.BQk()),2&n&&(e.xp6(1),e.Q6J("value","Active"))}function Le(n,o){1&n&&(e.ynx(0),e.TgZ(1,"tui-badge",34),e._UZ(2,"tui-svg",35),e.qZA(),e._UZ(3,"hr",31),e.BQk()),2&n&&(e.xp6(1),e.Q6J("value","Rejected"))}function We(n,o){1&n&&(e.ynx(0),e.TgZ(1,"tui-badge",36),e._UZ(2,"tui-svg",37),e.qZA(),e._UZ(3,"hr",31),e.BQk()),2&n&&(e.xp6(1),e.Q6J("value","Approved"))}function Ye(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"span"),e._uU(2,"Reject \xa0 "),e.TgZ(3,"tui-toggle",44),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,r=e.oxw(3),l=e.MAs(8);return e.KtG(r.showDialog(s,l))}),e.ALo(4,"async"),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw(5);e.xp6(3),e.Q6J("showIcons",!0)("showLoader",e.lcZ(4,3,t.showLoader))("formControl",t.reject)}}function qe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",43)(1,"span"),e._uU(2,"Approve \xa0 "),e.TgZ(3,"tui-toggle",44),e.NdJ("click",function(){e.CHM(t);const s=e.oxw().$implicit,r=e.oxw(3),l=e.MAs(8);return e.KtG(r.showDialog(s,l))}),e.ALo(4,"async"),e.qZA()(),e.YNc(5,Ye,5,5,"ng-container",21),e.qZA()}if(2&n){const t=e.oxw(2),i=t.$implicit,s=t.index,r=e.oxw(2);e.xp6(3),e.Q6J("showIcons",!0)("showLoader",e.lcZ(4,4,r.showLoader))("formControl",r.approve),e.xp6(2),e.Q6J("ngIf",0==r.hideRejectButton(null==i?null:i.condition,s,null==i?null:i.approverIds)&&(null==r.approvalLogs?null:r.approvalLogs.length)>0)}}function Be(n,o){if(1&n&&(e.TgZ(0,"p",45),e._uU(1),e.qZA()),2&n){const t=e.oxw(2).$implicit;e.xp6(1),e.Oqu(null==t?null:t.condition)}}function je(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"li",38)(2,"div",39)(3,"span",40),e._uU(4),e.qZA(),e.YNc(5,qe,6,6,"div",41),e.qZA()(),e.YNc(6,Be,2,1,"p",42),e.BQk()),2&n){const t=o.$implicit,i=o.last,s=e.oxw().$implicit,r=e.oxw(2);e.xp6(4),e.Oqu(null==t?null:t.name),e.xp6(1),e.Q6J("ngIf",(null==r.currentUser?null:r.currentUser.fullName)===(null==t?null:t.name)&&1==r.checkIfUserisStillActive(null==r.currentUser?null:r.currentUser.fullName)&&0==r.checkIfUserRejected(null==s?null:s.approverIds)&&0==r.userApprovedCheckResult()&&"inProgress"==(null==s?null:s.status)),e.xp6(1),e.Q6J("ngIf",!i)}}function $e(n,o){1&n&&e._UZ(0,"i",46)}function Re(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tui-island",26),e.YNc(2,Ee,4,1,"ng-container",21),e.YNc(3,Qe,4,1,"ng-container",21),e.YNc(4,Le,4,1,"ng-container",21),e.YNc(5,We,4,1,"ng-container",21),e.TgZ(6,"ul",27),e.YNc(7,je,7,3,"ng-container",8),e.qZA()(),e.YNc(8,$e,1,0,"i",28),e.BQk()),2&n){const t=o.$implicit,i=o.last;e.xp6(1),e.Q6J("hoverable",!0)("ngClass","approved"==(null==t?null:t.status)?"border border-green-600":"rejected"==(null==t?null:t.status)?"border border-red-600":"inProgress"==(null==t?null:t.status)?"border border-blue-600":"border border-yellow-600"),e.xp6(1),e.Q6J("ngIf","pending"==(null==t?null:t.status)),e.xp6(1),e.Q6J("ngIf","inProgress"==(null==t?null:t.status)),e.xp6(1),e.Q6J("ngIf","rejected"==(null==t?null:t.status)),e.xp6(1),e.Q6J("ngIf","approved"==(null==t?null:t.status)),e.xp6(2),e.Q6J("ngForOf",null==t?null:t.approverIds),e.xp6(1),e.Q6J("ngIf",!i)}}function ze(n,o){1&n&&(e.ynx(0),e.TgZ(1,"p",47),e._uU(2,"Approval logs are empty!"),e.qZA(),e.BQk())}function Ge(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"div",48)(2,"p",49),e._uU(3,"Performed by: \xa0 "),e.TgZ(4,"span",50),e._uU(5),e.qZA()(),e.TgZ(6,"p",49),e._uU(7,"Decision: \xa0 "),e.TgZ(8,"span",51),e._uU(9),e.qZA()(),e.TgZ(10,"p",52),e._uU(11," Approved On: "),e.TgZ(12,"span",50),e._uU(13),e.ALo(14,"date"),e.qZA()(),e.TgZ(15,"p",52),e._uU(16,"Comments: "),e.TgZ(17,"span",50),e._uU(18),e.qZA()()(),e.BQk()),2&n){const t=o.$implicit;e.xp6(4),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-red-500"),e.xp6(1),e.Oqu(null==t||null==t.performedById?null:t.performedById.fullName),e.xp6(3),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-red-500"),e.xp6(1),e.Oqu(null==t?null:t.approvalStatus),e.xp6(3),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-red-500"),e.xp6(1),e.hij("\xa0",e.xi3(14,8,null==t?null:t.approvedOn,"medium"),""),e.xp6(4),e.Q6J("ngClass","approved"==(null==t?null:t.approvalStatus)?"text-green-500":"text-red-500"),e.xp6(1),e.hij("\xa0",null==t?null:t.remarks,"")}}function He(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"p",4),e._uU(2,"Forms"),e.qZA(),e.TgZ(3,"div",5)(4,"section",6)(5,"nav",7),e.YNc(6,Fe,3,1,"ng-container",8),e.qZA(),e.YNc(7,Ve,2,1,"ng-container",8),e.qZA()(),e.TgZ(8,"section",9)(9,"p",10),e._uU(10,"Approval Workflow"),e.qZA(),e.TgZ(11,"div",11),e.YNc(12,Re,9,8,"ng-container",8),e.qZA()(),e.TgZ(13,"section",12)(14,"p",10),e._uU(15,"Workflow Progress & Approval Logs"),e.qZA(),e.TgZ(16,"div",13)(17,"div",14)(18,"label",15)(19,"span",16),e._uU(20,"COMPLETED"),e.qZA(),e.TgZ(21,"span",17),e._uU(22),e.ALo(23,"number"),e.ALo(24,"async"),e.qZA(),e._UZ(25,"tui-progress-circle",18),e.ALo(26,"async"),e.ALo(27,"async"),e.qZA()(),e.TgZ(28,"div",19)(29,"tui-island",20),e.YNc(30,ze,3,0,"ng-container",21),e.YNc(31,Ge,19,11,"ng-container",8),e.qZA()()()(),e.BQk()),2&n){const t=e.oxw();e.xp6(6),e.Q6J("ngForOf",t.formTabs),e.xp6(1),e.Q6J("ngForOf",t.formWithWorkflow),e.xp6(5),e.Q6J("ngForOf",t.workflowUsers),e.xp6(10),e.hij("",e.xi3(23,9,e.lcZ(24,12,t.workflowProgress),"1.2-2"),"%"),e.xp6(3),e.Q6J("max",t.max)("value",e.lcZ(26,14,t.workflowProgress))("color",t.changeProgressColor(e.lcZ(27,16,t.workflowProgress))),e.xp6(5),e.Q6J("ngIf",0==(null==t.approvalLogs?null:t.approvalLogs.length)),e.xp6(1),e.Q6J("ngForOf",t.approvalLogs)}}function Ke(n,o){1&n&&e._UZ(0,"app-workflow-skeleton")}function Xe(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p",53),e._uU(1,"You have chosen to "),e.TgZ(2,"span",54),e._uU(3),e.qZA(),e._uU(4," this step. "),e.qZA(),e.TgZ(5,"p",55),e._uU(6,"Please add your comments below (if any) and send your decision"),e.qZA(),e.TgZ(7,"div",56)(8,"label",57),e._uU(9,"Comments"),e.qZA(),e._UZ(10,"textarea",58),e.qZA(),e.TgZ(11,"div",59)(12,"button",60),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.sendDecisionData())}),e.ALo(13,"async"),e._uU(14," Send "),e.qZA(),e.TgZ(15,"button",61),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().cancelDecision(),e.KtG(r.complete())}),e._uU(16," Cancel "),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(2),e.Q6J("ngClass",1==(null==t.approve?null:t.approve.value)?"text-green-500":"text-red-500"),e.xp6(1),e.Oqu(1==(null==t.approve?null:t.approve.value)?"Approve":"Reject"),e.xp6(7),e.Q6J("formControl",t.remarks),e.xp6(2),e.Q6J("showLoader",e.lcZ(13,4,t.savingDecision))}}class A{constructor(o,t,i,s){this.dialogs=o,this.activatedRoute=t,this.workflowService=i,this.auth=s,this.max=100,this.value$=(0,be.of)(25),this.destroy$=new g.x,this.activeIndex=0,this.workflowUsers=[],this.approvalLogs=[],this.approve=new u.NI(!1),this.reject=new u.NI(!1),this.remarks=new u.NI(""),this.showLoader=new g.x,this.formTabs=[],this.workflowProgress=new O.X(0),this.saveDialogSubscription=[],this.decisionData=new O.X(null),this.savingDecision=new g.x,this.approvedUsers=[],this.activeUsers=[],this.formAllowedForEditUsers=[],this.loadingData=new g.x,this.currentUser=this.auth.currentUserValue,this.fetchData(),this.approve.valueChanges.pipe((0,d.R)(this.destroy$)).subscribe(r=>{!0===r&&(this.reject.disable(),this.showLoader.next(!0),setTimeout(()=>this.showLoader.next(!1),1e3)),!1===r&&this.reject.disabled&&this.reject.enable()}),this.reject.valueChanges.pipe((0,d.R)(this.destroy$)).subscribe(r=>{!0===r&&(this.approve.disable(),this.showLoader.next(!0),setTimeout(()=>this.showLoader.next(!1),1e3)),!1===r&&this.approve.disabled&&this.approve.enable()})}fetchData(){this.loadingData.next(!0),this.activatedRoute.params.pipe((0,K.j)("id"),(0,x.U)(o=>this.workflowID=o),(0,E.w)(o=>this.workflowService.getWorkflowSubmission(o))).subscribe(o=>{o&&(this.workflowData=o,this.formAllowedForEditUsers=this.workflowData?.workflowStatus?.map(t=>({users:t?.activeUsers?.map(i=>i?.fullName),status:t?.status})),this.approvedUsers=this.workflowData?.workflowStatus?.map(t=>({users:t?.approvedUsers?.map(i=>i?.fullName),status:t?.status})),this.lastApprovalCheck={status:this.workflowData?.approvalLog.at(-1)?.approvalStatus,user:this.workflowData?.approvalLog.at(-1)?.performedById?.fullName},this.formTabs=this.workflowData?.formIds?.map(t=>t.title),this.formWithWorkflow=this.workflowData?.formIds?.map(t=>({...t,formDataId:this.workflowData?.formDataIds?.map(i=>{if(i.formId==t?._id)return i?._id}).filter(i=>i)[0],data:this.workflowData?.formDataIds?.map(i=>{if(i.formId==t?._id)return i?.data}).filter(i=>i)[0]})),this.activeUsers=this.workflowData?.workflowStatus?.flatMap(t=>t?.activeUsers)?.map(t=>t?.fullName),this.workflowUsers=this.workflowData?.workflowStatus?.map(t=>({approverIds:t?.allUsers?.map(i=>({name:i?.fullName,id:i?._id,stepId:t?.stepId})),condition:t?.condition,status:t?.status})),this.workflowProgress.next(this.workflowData?.summaryData?.progress),this.approvalLogs=this.workflowData?.approvalLog,this.allApproved=this.workflowData?.workflowStatus?.map(t=>"approved"==t?.status),this.loadingData.next(!1))})}showDialog(o,t){this.showLoader.pipe((0,d.R)(this.destroy$)).subscribe(i=>{!1===i&&(this.decisionData.next(o),this.saveDialogSubscription.push(this.dialogs.open(t,{dismissible:!1,closeable:!1}).pipe((0,we.q)(1)).subscribe()))})}sendDecisionData(){this.savingDecision.next(!0),this.workflowService.updateSubmissionWorkflow(this.workflowID,{stepId:this.decisionData?.value?.stepId,userId:this.currentUser?.id,remarks:this.remarks?.value,isApproved:1==this.approve?.value}).pipe((0,d.R)(this.destroy$)).subscribe(t=>{t?(this.fetchData(),this.savingDecision.next(!1),this.remarks.reset(),this.saveDialogSubscription.forEach(i=>i.unsubscribe()),this.reject.reset(),this.approve.reset(),this.reject.enable(),this.approve.enable()):this.savingDecision.next(!1)})}cancelDecision(){this.remarks.reset(),this.saveDialogSubscription.forEach(o=>o.unsubscribe()),this.reject.reset(),this.approve.reset(),this.reject.enable(),this.approve.enable()}changeProgressColor(o){return o<=49?"#F15B41":o>49&&o<75?"#F9B71A":o>=75?"#32de84":"#fff"}checkIfUserCanEditForm(){return this.formAllowedForEditUsers?.map(o=>!(!o.users?.includes(this.currentUser?.fullName)||"inProgress"!=o.status))}checkIfUserIsInEditUsers(){return this.checkIfUserCanEditForm().includes(!0)}checkIfUserIsApproved(o){return this.approvedUsers?.map(t=>!(!t.users?.includes(o)||"inProgress"!=t.status))}userApprovedCheckResult(){return this.checkIfUserIsApproved(this.currentUser?.fullName).includes(!0)}checkIfUserisStillActive(o){return this.activeUsers.includes(o)}checkIfUserRejected(o){return"rejected"==this.lastApprovalCheck?.status&&this.currentUser?.fullName==this.lastApprovalCheck?.user&&0!==o?.map(t=>t?.name).indexOf(this.currentUser?.fullName)}checkIfLoggedInUserIsPartOfActiveUsers(){return this.activeUsers.includes(this.currentUser?.fullName)}checkIfAllApproved(){return!this.allApproved.includes(!1)}updateFormData(o){this.workflowService.updateFormsData({formId:o?._id,data:o?.data},o?.formDataId).pipe((0,d.R)(this.destroy$)).subscribe(i=>{i&&this.fetchData()})}hideRejectButton(o,t,i){return"none"==o&&0==t||"or"==o&&0==t}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}A.\u0275fac=function(o){return new(o||A)(e.Y36(H.RO),e.Y36(f.gz),e.Y36(_),e.Y36(L.e))},A.\u0275cmp=e.Xpm({type:A,selectors:[["ng-component"]],decls:9,vars:4,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52","pb-44"],[4,"ngIf","ngIfElse"],["showSkeleton",""],["template",""],[1,"text-lg","font-semibold"],[1,"flex","flex-col","w-full","px-5","mx-auto","mt-5","border","border-gray-400","border-dashed","rounded-md","bg-gray-50"],[1,"flex","justify-between","my-8"],["tuiTabs","","vertical","left",1,"w-32","mr-5"],[4,"ngFor","ngForOf"],[1,"my-10"],[1,"mb-5","text-lg","font-semibold"],[1,"flex","flex-col","items-center","justify-center"],[1,"my-4"],[1,"grid","grid-cols-12","gap-3"],[1,"col-span-2"],["tuiProgressLabel",""],[1,"font-semibold","text-gray-600"],[1,"font-semibold","text-gray-700"],["size","xl",3,"max","value","color"],[1,"col-span-10"],["size","l",1,"w-full","shadow-lg"],[4,"ngIf"],["tuiTab","",3,"click"],["class","w-full well jsonviewer",4,"ngIf"],[1,"w-full","well","jsonviewer"],[3,"readOnly","options","submission","form","submit"],["size","l",1,"w-1/2","my-4","shadow-lg",3,"hoverable","ngClass"],[1,"tui-list"],["class","fa fa-long-arrow-down fa-2x","aria-hidden","true",4,"ngIf"],["status","custom",1,"px-2","font-semibold","text-white","bg-yellow-600","tui-space_right-2","tui-space_bottom-4",3,"value"],["src","tuiIconClock"],[1,"mb-2"],["status","custom",1,"px-2","font-semibold","text-white","bg-blue-600","tui-space_right-2","tui-space_bottom-4",3,"value"],["src","tuiIconRadio"],["status","custom",1,"px-2","font-semibold","text-white","bg-red-600","tui-space_right-2","tui-space_bottom-4",3,"value"],["src","tuiIconAlertOctagon"],["status","custom",1,"px-2","font-semibold","text-white","bg-green-600","tui-space_right-2","tui-space_bottom-4",3,"value"],["src","tuiIconCheckCircle"],[1,"tui-list__item"],[1,"flex","justify-between"],[1,"text-base","font-semibold"],["class","flex justify-end gap-5",4,"ngIf"],["class","mt-2 ml-8 font-normal",4,"ngIf"],[1,"flex","justify-end","gap-5"],["size","l",3,"showIcons","showLoader","formControl","click"],[1,"mt-2","ml-8","font-normal"],["aria-hidden","true",1,"fa","fa-long-arrow-down","fa-2x"],[1,"py-5","text-base","font-semibold","text-center","text-gray-500"],[1,"grid","grid-cols-12","py-3","gap-x-3","border-b","border-gray-300"],[1,"col-span-2","font-normal"],[1,"font-semibold",3,"ngClass"],[1,"font-semibold","capitalize",3,"ngClass"],[1,"col-span-4","font-normal"],[1,"text-lg","font-semibold","text-center"],[1,"mx-1","text-lg","font-semibold",3,"ngClass"],[1,"mt-3","text-base","font-medium"],[1,"flex","flex-col","justify-center","my-5"],["for","Textarea1",1,"block"],["id","Textarea1","rows","4",1,"form-control",3,"formControl"],[1,"flex","justify-start","gap-x-3"],["tuiButton","","type","button","size","m",3,"showLoader","click"],["tuiButton","","type","button","appearance","accent","size","m",3,"click"]],template:function(o,t){if(1&o&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0),e.YNc(2,He,32,18,"ng-container",1),e.ALo(3,"async"),e.YNc(4,Ke,1,0,"ng-template",null,2,e.W1O),e.qZA(),e._UZ(6,"app-footer"),e.YNc(7,Xe,17,6,"ng-template",null,3,e.W1O)),2&o){const i=e.MAs(5);e.xp6(2),e.Q6J("ngIf",0==e.lcZ(3,2,t.loadingData))("ngIfElse",i)}},dependencies:[p.mk,p.sg,p.O5,D.G,W.c,Y.k4,N.BY,N.vV,q.h,u.Fj,u.JJ,u.oH,De,ue.g,I.PN,B.v0,b.p_,b.uW,b.yu,v,p.Ov,p.JJ,p.uU]});var c=a(4266),j=a(46954),$=a(82176),ce=a(55314),de=a(6110);function et(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"a",19),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2);return e.KtG(s.addSubmissionRoute())}),e._uU(2,"+ Add submission"),e.qZA()()}}function tt(n,o){1&n&&(e.ynx(0),e.TgZ(1,"th",20),e._uU(2," It seems there is no data to show here! "),e.qZA(),e.BQk())}function ot(n,o){1&n&&(e.TgZ(0,"span"),e._uU(1,","),e.qZA())}function nt(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"span"),e._uU(2),e.YNc(3,ot,2,0,"span",29),e._uU(4," \xa0"),e.qZA(),e.BQk()),2&n){const t=o.$implicit,i=o.last;e.xp6(2),e.Oqu(t),e.xp6(1),e.Q6J("ngIf",!i)}}function it(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,r=e.oxw(3);return e.KtG(r.editWorkflowRoute(null==s?null:s.id,null==s||null==s.formIds[0]?null:s.formIds[0].key))}),e._UZ(1,"i",33),e._uU(2," View "),e.qZA()}}function st(n,o){if(1&n&&(e.TgZ(0,"td",30),e.YNc(1,it,3,0,"a",31),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",1==i.checkIfUserisPartofWorkflow(null==t?null:t.workflowAllUsers)||"admin"==(null==i.currentUser?null:i.currentUser.role)||(null==t?null:t.createdBy)==(null==i.currentUser?null:i.currentUser.id))}}function rt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"a",32),e.NdJ("click",function(){e.CHM(t);const s=e.oxw(2).$implicit,r=e.oxw(3);return e.KtG(r.editWorkflowRoute(null==s?null:s.id,null==s||null==s.formIds[0]?null:s.formIds[0].key))}),e._UZ(1,"i",34),e._uU(2," Edit "),e.qZA()}}function at(n,o){if(1&n&&(e.TgZ(0,"td",30),e.YNc(1,rt,3,0,"a",31),e.qZA()),2&n){const t=e.oxw().$implicit,i=e.oxw(3);e.xp6(1),e.Q6J("ngIf",1==i.checkIfUserisPartofWorkflow(null==t?null:t.workflowAllUsers)||"admin"==(null==i.currentUser?null:i.currentUser.role)||(null==t?null:t.createdBy)==(null==i.currentUser?null:i.currentUser.id))}}const lt=function(){return[]};function ut(n,o){if(1&n&&(e.ynx(0),e.TgZ(1,"tr",22)(2,"td",23),e._uU(3),e.qZA(),e.TgZ(4,"td",24),e._uU(5),e.qZA(),e.TgZ(6,"td",24),e.YNc(7,nt,5,2,"ng-container",25),e.qZA(),e.TgZ(8,"td",26),e._UZ(9,"progress",27),e.TgZ(10,"span"),e._uU(11),e.ALo(12,"number"),e.qZA()(),e.YNc(13,st,2,1,"td",28),e.YNc(14,at,2,1,"td",28),e.qZA(),e.BQk()),2&n){const t=o.$implicit,i=e.oxw(3);e.xp6(3),e.hij(" ",i.showStatus(null==t?null:t.submissionStatus)," "),e.xp6(2),e.hij(" ",(null==t||null==t.summaryData?null:t.summaryData.userName)||""," "),e.xp6(2),e.Q6J("ngForOf",i.getPendingOnUsers((null==t||null==t.summaryData?null:t.summaryData.pendingOnUsers)||e.DdM(11,lt))),e.xp6(2),e.Q6J("color",i.changeProgressColor(null==t||null==t.summaryData?null:t.summaryData.progress))("value",null==t||null==t.summaryData?null:t.summaryData.progress),e.xp6(2),e.hij("",e.xi3(12,8,null==t||null==t.summaryData?null:t.summaryData.progress,"1.1-2")," %"),e.xp6(2),e.Q6J("ngIf",0==i.checkIfUserisPartofWorkflow(null==t?null:t.workflowAllUsers)),e.xp6(1),e.Q6J("ngIf",1==i.checkIfUserisPartofWorkflow(null==t?null:t.workflowAllUsers))}}function ct(n,o){if(1&n&&e.YNc(0,ut,15,12,"ng-container",21),2&n){const t=e.oxw(2);e.Q6J("ngForOf",t.tableDataValue)("ngForTrackBy",t.trackByFn)}}function dt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p",3),e._uU(2,"Code:\xa0 "),e.TgZ(3,"span",4),e._uU(4),e.qZA()(),e.TgZ(5,"div",5)(6,"p",6),e._uU(7,"List of Submissions"),e.qZA(),e.YNc(8,et,3,0,"div",7),e.qZA(),e.TgZ(9,"div",8)(10,"table",9)(11,"thead",10)(12,"tr")(13,"th",11),e._uU(14," Submission Status\xa0 "),e.TgZ(15,"filter",12),e.NdJ("applyStatus",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.sendFilterValue(s))})("resetFilters",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.resetFilterValues(s))}),e.qZA()(),e.TgZ(16,"th",13),e._uU(17,"Last Activity By"),e.qZA(),e.TgZ(18,"th",13),e._uU(19,"Now Pending With"),e.qZA(),e.TgZ(20,"th",13),e._uU(21,"Workflow progress"),e.qZA(),e.TgZ(22,"th",14),e._uU(23," Actions "),e.qZA()()(),e.TgZ(24,"tbody"),e.YNc(25,tt,3,0,"ng-container",1),e.YNc(26,ct,1,2,"ng-template",null,15,e.W1O),e.qZA()(),e.TgZ(28,"div",16)(29,"tui-pagination",17),e.NdJ("indexChange",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.goToPage(s))}),e.qZA()()(),e.BQk()}if(2&n){const t=o.ngIf,i=e.MAs(27),s=e.oxw();e.xp6(4),e.Oqu(null==s.submoduleData?null:s.submoduleData.code),e.xp6(4),e.Q6J("ngIf",s.checkIfUserisAdmin()||(null==s.submoduleData?null:s.submoduleData.createdBy)==(null==s.currentUser?null:s.currentUser.id)||"admin"==(null==s.currentUser?null:s.currentUser.role)),e.xp6(7),e.Q6J("filterBy","Status")("items",s.statusMenu)("searchEnabled",!1),e.xp6(10),e.Q6J("ngIf",0==(null==s.tableDataValue?null:s.tableDataValue.length))("ngIfElse",i),e.xp6(4),e.Q6J("length",(null==t?null:t.totalPages)||1)("index",(null==t?null:t.page)-1||0)}}function pt(n,o){1&n&&e._UZ(0,"app-table-loader")}class U{constructor(o,t,i,s,r){this.activatedRoute=o,this.workflowService=t,this.auth=i,this.dashboard=s,this.router=r,this.subscriptions=[],this.adminUsers=[],this.createdByUsers=[],this.destroy$=new g.x,this.filterMenuCompany=[{name:"Sort by Acsending",status:"idle",icon:"fa fa-sort-alpha-asc fa-lg"},{name:"Sort by Decsending",status:"idle",icon:"fa fa-sort-alpha-desc fa-lg"},{name:"Sort by Latest",status:"idle",icon:"fa fa-calendar-check-o fa-lg"},{name:"Sort by Oldest",status:"idle",icon:"fa fa-calendar-times-o fa-lg"}],this.statusMenu=[{name:"Created",status:"idle",icon:""},{name:"Completed",status:"idle",icon:""},{name:"In Progress",status:"idle",icon:""},{name:"Draft",status:"idle",icon:""}],this.page=1,this.limit=7,this.currentUser=this.auth.currentUserValue,this.subscriptions.push(this.activatedRoute.params.subscribe(l=>{this.submoduleId=l.id,(0,c.LS)(c.MX.workflowID,l.id)})),this.subscriptions.push(this.dashboard.getSubModuleByID(this.submoduleId).subscribe(l=>{this.submoduleData=l})),this.subscriptions.push(this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).subscribe(l=>{this.submissionData=l,this.tableDataValue=l?.results,this.adminUsers=l?.results?.flatMap(m=>m?.subModuleId?.adminUsers),this.createdByUsers=l?.results?.map(m=>m?.subModuleId?.createdBy)}))}changeProgressColor(o){return o<=49?"#F15B41":o>49&&o<75?"#F9B71A":o>=75?"#32de84":"#fff"}showStatus(o){return 1===o?"Created":3===o?"Completed":2===o?"In Progress":4===o?"Draft":"Rejected"}checkIfUserisAdmin(){return this.adminUsers?.includes(this.currentUser?.id)}checkIfUserisPartofWorkflow(o){return o?.map(t=>t?._id)?.includes(this.currentUser?.id)}checkIfUserisCreator(){return this.createdByUsers?.includes(this.currentUser?.id)}getPendingOnUsers(o){return o?.map(t=>t?.fullName)}sendFilterValue(o){switch(o?.sortType){case"Created":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,1).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Completed":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,3).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"In Progress":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,2).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Draft":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,4).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Sort by Latest":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,"latest").pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results});break;case"Sort by Oldest":this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page,void 0,"oldest").pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}}resetFilterValues(o){o&&this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}trackByFn(o,t){return t?.id}addSubmissionRoute(){this.router.navigate([`/modules/${(0,c.rV)(c.MX.moduleSlug)}/${(0,c.rV)(c.MX.subModuleSlug)}/add-submission`,this.submoduleId])}editWorkflowRoute(o,t){(0,c.LS)(c.MX.formKey,t),this.router.navigate([`/modules/${(0,c.rV)(c.MX.moduleSlug)}/${(0,c.rV)(c.MX.subModuleSlug)}/${t}`,o])}goToPage(o){this.page=o+1,this.workflowService.getSubmissionFromSubModule(this.submoduleId,this.limit,this.page).pipe((0,d.R)(this.destroy$)).subscribe(t=>{this.submissionData=t,this.tableDataValue=t?.results})}ngOnDestroy(){this.subscriptions.forEach(o=>o.unsubscribe())}}U.\u0275fac=function(o){return new(o||U)(e.Y36(f.gz),e.Y36(_),e.Y36(L.e),e.Y36(j.s),e.Y36(f.F0))},U.\u0275cmp=e.Xpm({type:U,selectors:[["ng-component"]],decls:6,vars:2,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52"],[4,"ngIf","ngIfElse"],["noData",""],[1,"text-left","font-semibold","text-base","mb-7"],[1,"text-[#374151]"],[1,"flex","justify-between","mb-5"],[1,"text-left","font-semibold","text-lg"],["class","cursor-pointer",4,"ngIf"],[1,"relative","overflow-x-auto","rounded-lg","shadow-lg"],[1,"w-full","text-sm","text-left","text-gray-500"],[1,"text-xs","text-gray-700","uppercase","bg-[#eae4d8]"],[1,"px-4","py-3","text-sm"],[3,"filterBy","items","searchEnabled","applyStatus","resetFilters"],[1,"px-2","py-3","text-sm"],["scope","col",1,"px-6","py-3","text-sm"],["showSubmissions",""],[1,"pt-10","pb-6"],[3,"length","index","indexChange"],[1,"cursor-pointer"],[1,"px-6","py-3","rounded-md","bg-[#a58f81]","text-white","no-underline","hover:text-white","text-base",3,"click"],["colspan","12","role","row",1,"px-5","py-10","text-lg","text-center"],[4,"ngFor","ngForOf","ngForTrackBy"],[1,"bg-white","border-b","border-gray-300"],[1,"px-4","py-4"],[1,"px-2","py-4"],[4,"ngFor","ngForOf"],[1,"flex","justify-between","px-2","py-4"],["tuiProgressBar","","max","100","size","s",1,"w-9/12","mt-1.5",3,"color","value"],["class","px-6 py-4",4,"ngIf"],[4,"ngIf"],[1,"px-6","py-4"],["class","px-2 py-1 ml-2 text-xs font-medium text-white no-underline bg-green-400 rounded-md cursor-pointer hover:text-white",3,"click",4,"ngIf"],[1,"px-2","py-1","ml-2","text-xs","font-medium","text-white","no-underline","bg-green-400","rounded-md","cursor-pointer","hover:text-white",3,"click"],["aria-hidden","true",1,"fa","fa-eye","fa-lg"],["aria-hidden","true",1,"fa","fa-edit","fa-lg"]],template:function(o,t){if(1&o&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0),e.YNc(2,dt,30,9,"ng-container",1),e.YNc(3,pt,1,0,"ng-template",null,2,e.W1O),e.qZA(),e._UZ(5,"app-footer")),2&o){const i=e.MAs(4);e.xp6(2),e.Q6J("ngIf",t.submissionData)("ngIfElse",i)}},dependencies:[p.sg,p.O5,D.G,W.c,N.iv,$.r,ce.X,de.z,p.JJ]});var R=a(39062),pe=a(4053),me=a(56772),ge=a(37378),mt=a(53861),fe=a(71115),_e=a(13675),gt=a(82210),he=a(77915);function ft(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"button",16),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw();return e.KtG(l.activeIndex=r)}),e._uU(2),e.qZA(),e.BQk()}if(2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function _t(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",18)(1,"formio",19),e.NdJ("change",function(s){e.CHM(t);const r=e.oxw().index,l=e.oxw();return e.KtG(l.onChange(s,r))}),e.qZA()()}if(2&n){const t=e.oxw().$implicit,i=e.oxw();e.xp6(1),e.Q6J("submission",i.formValues[i.activeIndex])("options",i.options)("form",t)}}function ht(n,o){if(1&n&&(e.ynx(0),e.YNc(1,_t,2,3,"div",17),e.BQk()),2&n){const t=o.index,i=e.oxw();e.xp6(1),e.Q6J("ngIf",i.activeIndex==t)}}function bt(n,o){1&n&&(e.TgZ(0,"span",42),e._uU(1,"Please select either AND or OR as the condition"),e.qZA())}function wt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"p",24),e._uU(2),e.qZA(),e.TgZ(3,"div",25)(4,"div",26)(5,"label",27),e._uU(6,"Approvers "),e.TgZ(7,"span",28),e._uU(8,"*"),e.qZA()(),e.TgZ(9,"custom-multi-select",29),e.NdJ("checkUsersLength",function(s){const l=e.CHM(t).index,m=e.oxw(2);return e.KtG(m.countUsers(s,l))})("approverList",function(s){const l=e.CHM(t).index,m=e.oxw(2);return e.KtG(m.getApproverList(s,l))}),e.qZA(),e.YNc(10,bt,2,0,"span",30),e.ALo(11,"async"),e.qZA(),e.TgZ(12,"div",26)(13,"label",31),e._uU(14,"Condition "),e.TgZ(15,"span",28),e._uU(16,"*"),e.qZA()(),e.TgZ(17,"select",32),e.NdJ("change",function(){const r=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.validateSelection(r))}),e.TgZ(18,"option",33),e._uU(19,"AND"),e.qZA(),e.TgZ(20,"option",34),e._uU(21,"OR"),e.qZA(),e.TgZ(22,"option",35),e._uU(23,"NONE"),e.qZA()()(),e.TgZ(24,"div",36),e._UZ(25,"tui-tooltip",37),e.TgZ(26,"tui-badged-content",38)(27,"button",39),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw(2),m=e.MAs(23);return e.KtG(l.openEmailNotifyModal(m,l.workflows,r))}),e.qZA()()(),e.TgZ(28,"div",40)(29,"button",41),e.NdJ("click",function(){const r=e.CHM(t).index,l=e.oxw(2);return e.KtG(l.removeWorkflowStep(r))}),e.qZA()()(),e.BQk()}if(2&n){const t=o.index,i=e.oxw(2),s=e.MAs(25);let r;e.xp6(2),e.hij("Step ",0===t?"1":t+1,""),e.xp6(1),e.Q6J("formGroupName",t),e.xp6(7),e.Q6J("ngIf",e.lcZ(11,6,i.showError)&&t===i.errorIndex),e.xp6(15),e.Q6J("content",s),e.xp6(1),e.Q6J("contentTop",null==(r=i.workflows.at(t).get("emailNotifyTo"))||null==r.value?null:r.value.length)("colorTop","green")}}function xt(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"div",20)(1,"h4",21),e._uU(2,"Modify submodule workflow"),e.qZA(),e.ynx(3,22),e.YNc(4,wt,30,8,"ng-container",4),e.BQk(),e.TgZ(5,"button",23),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.addWorkflowStep())}),e.qZA()()}if(2&n){const t=e.oxw();e.Q6J("formGroup",t.workflowForm),e.xp6(4),e.Q6J("ngForOf",t.workflows.controls)}}function vt(n,o){if(1&n&&(e.TgZ(0,"ul",55)(1,"li",56),e._uU(2),e.qZA()()),2&n){const t=o.$implicit;e.xp6(2),e.Oqu(t)}}function yt(n,o){1&n&&e._UZ(0,"i",57)}function kt(n,o){if(1&n&&(e.TgZ(0,"div",48)(1,"div",49)(2,"p",50),e._uU(3),e.qZA(),e.YNc(4,vt,3,1,"ul",51),e.TgZ(5,"div",52),e._uU(6),e.qZA()(),e.TgZ(7,"div",53),e.YNc(8,yt,1,0,"i",54),e.qZA()()),2&n){const t=e.oxw(),i=t.index,s=t.$implicit,r=t.last;e.xp6(3),e.hij("Step ",i+1,""),e.xp6(1),e.Q6J("ngForOf",null==s?null:s.approvers),e.xp6(2),e.hij(" ",null==s?null:s.condition," "),e.xp6(2),e.Q6J("ngIf",!r)}}function Ct(n,o){1&n&&(e.ynx(0),e.YNc(1,kt,9,4,"div",47),e.BQk())}function Tt(n,o){if(1&n){const t=e.EpF();e.ynx(0),e.TgZ(1,"tui-island",43)(2,"h4",44),e._uU(3,"Workflow Steps"),e.qZA(),e.TgZ(4,"tui-carousel",45),e.NdJ("indexChange",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.carouselIndex=s)}),e.YNc(5,Ct,2,0,"ng-container",4),e.qZA(),e.TgZ(6,"tui-pagination",46),e.NdJ("indexChange",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.carouselIndex=s)}),e.qZA()(),e.BQk()}if(2&n){const t=e.oxw();e.xp6(4),e.Q6J("draggable",!0)("itemsCount",3)("index",t.carouselIndex),e.xp6(1),e.Q6J("ngForOf",t.items),e.xp6(1),e.Q6J("length",(null==t.items?null:t.items.length)>2?(null==t.items?null:t.items.length)-2:null==t.items?null:t.items.length)("index",t.carouselIndex)}}function Zt(n,o){if(1&n&&e._UZ(0,"tui-data-list-wrapper",66),2&n){const t=e.oxw(2);e.Q6J("items",t.userListForEmail)}}function It(n,o){if(1&n){const t=e.EpF();e.TgZ(0,"p",58),e._uU(1,"Email Notification Users"),e.qZA(),e.TgZ(2,"p",59),e._uU(3," Please specify the users you want to send the notification email to "),e.qZA(),e.TgZ(4,"div",60)(5,"tui-input-tag",61),e.NdJ("searchChange",function(s){e.CHM(t);const r=e.oxw();return e.KtG(r.onSearchChange(s))}),e._uU(6," Type to search and press Enter to select... "),e.YNc(7,Zt,1,1,"tui-data-list-wrapper",62),e.qZA()(),e.TgZ(8,"div",63)(9,"button",64),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.validateEmails())}),e._uU(10," Confirm & Close "),e.qZA(),e.TgZ(11,"button",65),e.NdJ("click",function(){e.CHM(t);const s=e.oxw();return e.KtG(s.cancelEmailNotify())}),e._uU(12," Remove Users & Close "),e.qZA()()}if(2&n){const t=e.oxw();e.xp6(5),e.Q6J("formControl",null==t.currentFieldArray||null==t.currentFieldArray.controls[t.activeEmailIndex]?null:t.currentFieldArray.controls[t.activeEmailIndex].controls.emailNotifyTo)("tuiTextfieldLabelOutside",!0)}}function At(n,o){1&n&&(e.TgZ(0,"strong",67),e._uU(1,"How conditions work?"),e.qZA(),e._UZ(2,"hr"),e.TgZ(3,"ul",68)(4,"li")(5,"strong"),e._uU(6,"AND"),e.qZA(),e._uU(7," implies that every user of the step must provide approval"),e.qZA(),e.TgZ(8,"li",69)(9,"strong"),e._uU(10,"OR"),e.qZA(),e._uU(11," implies that any one of the users may provide approval"),e.qZA(),e.TgZ(12,"li")(13,"strong"),e._uU(14,"NONE"),e.qZA(),e._uU(15," implies that there is only one user per step and hence no conditon is necessary"),e.qZA()())}class S{constructor(o,t,i,s,r,l,m,Ot,Dt){this.fb=o,this.notif=t,this.dashBoardService=i,this.activatedRoute=s,this.submissionService=r,this.router=l,this.auth=m,this.dialogs=Ot,this.dashboard=Dt,this.formTabs=[],this.activeIndex=0,this.formDataIds=[],this.formSubmission=new O.X([]),this.destroy$=new g.x,this.activeItemIndex=0,this.options={disableAlerts:!0,noDefaultSubmitButton:!0},this.formValues=[],this.carouselIndex=0,this.items=[],this.userListForEmail=[],this.search$=new g.x,this.saveDialogSubscription=[],this.limit=10,this.page=0,this.creatingSubmission=new g.x,this.showError=new g.x,this.errorIndex=0,this.currentUser=this.auth.currentUserValue,this.initWorkflowForm(),this.activatedRoute.params.pipe((0,d.R)(this.destroy$)).subscribe(h=>this.subModuleId=h.id),this.populateData(),this.search$.pipe((0,E.w)(h=>this.dashboard.getAllUsersForListing(this.limit,this.page,h))).subscribe(h=>{h&&(this.userListForEmail=h?.results?.map(z=>z?.email))}),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,d.R)(this.destroy$)).subscribe(h=>{h&&(this.userListForEmail=h?.results?.map(z=>z?.email))})}openEmailNotifyModal(o,t,i){this.activeEmailIndex=i,this.currentFieldArray=t,this.saveDialogSubscription.push(this.dialogs.open(o,{dismissible:!1,closeable:!1}).subscribe())}onSearchChange(o){this.search$.next(o)}validateEmails(){let o=this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.value;o=o.map(t=>!!/\S+@\S+\.\S+/.test(t)),o.includes(!1)?this.notif.displayNotification("Please provide valid email addresses","Email Notify","warning"):this.saveDialogSubscription.forEach(t=>t.unsubscribe())}cancelEmailNotify(){this.workflows.at(this.activeEmailIndex)?.get("emailNotifyTo")?.setValue([]),this.saveDialogSubscription.forEach(o=>o.unsubscribe())}populateData(){this.activatedRoute.params.pipe((0,K.j)("id"),(0,E.w)(o=>this.dashBoardService.getSubModuleByID(o)),(0,d.R)(this.destroy$)).subscribe(o=>{if(o){this.subModuleData=o,this.formWithWorkflow=o?.formIds?.map(i=>({...i,components:i.components?.map(s=>(s?.label&&"Submit"==s?.label&&(s.hidden=!0),s))})),this.formTabs=o?.formIds?.map(i=>i.title),this.items=o?.workFlowId?.stepIds?.map(i=>({approvers:i?.approverIds?.map(s=>s?.fullName),condition:i?.condition,emailNotifyTo:i?.emailNotifyToId?.notifyUsers||[]})),this.createdByUser=o?.createdBy;const t=o?.workFlowId?.stepIds?.map(i=>({approverIds:i?.approverIds?.map(s=>({name:s?.fullName,id:s?.id,control:new u.NI(!0)})),condition:i?.condition,emailNotifyTo:i?.emailNotifyToId?.notifyUsers||[]}));delete this.subModuleData?.workFlowId,Object.assign(this.subModuleData,{workFlowId:t}),this.initWorkflowForm(t)}})}initWorkflowForm(o){this.workflowForm=this.fb.group(o?{workflows:this.fb.array(o?.map(t=>this.fb.group({condition:[t.condition,u.kI.required],approverIds:[t.approverIds,u.kI.required],emailNotifyTo:[t?.emailNotifyTo||[],u.kI.required]})))}:{workflows:this.fb.array([this.fb.group({condition:["",u.kI.required],approverIds:[[],u.kI.required],emailNotifyTo:[[],u.kI.required]})])})}get workflows(){return this.workflowForm.controls.workflows}addWorkflowStep(){const o=this.fb.group({approverIds:[[],u.kI.required],condition:[{value:"",disabled:""},u.kI.required],emailNotifyTo:[[],u.kI.required]});this.workflows.push(o)}removeWorkflowStep(o){this.workflows.removeAt(o)}getApproverList(o,t){this.workflows.at(t)?.get("approverIds")?.setValue(o)}onChange(o,t){if(o?.data&&o?.changed){const i=this.subModuleData?.formIds[this.activeIndex]?.id;this.formValues[this.activeIndex]={...o,formId:i};const s=this.formValues?.map(r=>({formId:r?.formId,data:r?.data}));this.formSubmission.next(s)}}dataSubmitValidation(){return!(0==this.workflows?.length||this.workflows.controls.map(o=>0==o.get("approverIds")?.value.length).includes(!0)||!0===this.workflows.controls.map(o=>o.get("condition")?.value).includes(""))}createSubmission(o){if(0==this.dataSubmitValidation())return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create Submission","warning");if(this.workflows.controls.map(i=>i.get("approverIds")?.value.length>1&&i.get("condition")?.value).includes("none"))return this.notif.displayNotification("Please provide valid condition for the workflow step/s","Create Submission","warning");if(this.formSubmission?.value?.length!==this.formWithWorkflow?.length)return this.notif.displayNotification("Please provide data for all form fields","Create Submission","warning");this.creatingSubmission.next(!0);const t={subModuleId:this.subModuleId,formIds:this.subModuleData?.formIds?.map(i=>i.id),formDataIds:this.formSubmission?.value,submissionStatus:o||void 0,steps:this.workflows?.value?.map(i=>({approverIds:i?.approverIds?.map(s=>s.id?s.id:s),condition:i?.condition,emailNotifyTo:i?.emailNotifyTo||[]}))};this.submissionService.addNewSubmission(t).pipe((0,d.R)(this.destroy$)).subscribe(i=>{if(i){let s=(0,c.rV)(c.MX.moduleSlug),r=(0,c.rV)(c.MX.subModuleSlug);this.creatingSubmission.next(!1),this.router.navigate([`/modules/${s}/${r}`,this.subModuleId])}})}countUsers(o,t){return this.errorIndex=t,o<2?(this.workflows.at(t)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info")):o>=2&&"none"==this.workflows.at(t)?.get("condition")?.value?this.showError.next(!0):void this.showError.next(!1)}validateSelection(o){if(this.errorIndex=o,this.workflows.at(o)?.get("approverIds")?.value?.length<2&&(this.workflows.at(o)?.get("condition")?.setValue("none"),this.notif.displayNotification('Default condition of "None" will be used if the number of approvers is less than 2',"Create Module","info")),this.workflows.at(o)?.get("approverIds")?.value?.length>=2&&"none"==this.workflows.at(o)?.get("condition")?.value)return this.showError.next(!0);this.showError.next(!1)}cancelSubmission(){let o=(0,c.rV)(c.MX.moduleSlug),t=(0,c.rV)(c.MX.subModuleSlug);this.router.navigate([`/modules/${o}/${t}`,this.subModuleId])}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}S.\u0275fac=function(o){return new(o||S)(e.Y36(u.qu),e.Y36(Q.T),e.Y36(j.s),e.Y36(f.gz),e.Y36(_),e.Y36(f.F0),e.Y36(L.e),e.Y36(H.RO),e.Y36(j.s))},S.\u0275cmp=e.Xpm({type:S,selectors:[["ng-component"]],decls:26,vars:8,consts:[[1,"w-11/12","h-auto","min-h-screen","mx-auto","mt-52","pb-44"],[1,"flex","flex-col","w-full","px-5","mx-auto","mt-5","border","border-gray-400","border-dashed","rounded-md","bg-gray-50"],[1,"flex","justify-between","my-8"],["tuiTabs","","vertical","left",1,"w-32","mr-5"],[4,"ngFor","ngForOf"],[3,"activeItemIndex","activeItemIndexChange"],["tuiTab",""],["src","tuiIconEye",1,"tui-space_right-2"],["src","tuiIconEdit",1,"tui-space_right-2"],["class","mt-12",3,"formGroup",4,"ngIf"],[4,"ngIf"],[1,"flex","justify-end","gap-5","mt-8"],["tuiButton","","type","button","size","m","appearance","primary",3,"showLoader","click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],["template",""],["hint",""],["tuiTab","",3,"click"],["class","w-full well jsonviewer",4,"ngIf"],[1,"w-full","well","jsonviewer"],[3,"submission","options","form","change"],[1,"mt-12",3,"formGroup"],[1,"text-lg","font-semibold"],["formArrayName","workflows"],["tuiIconButton","","type","button","size","m","appearance","primary","icon","tuiIconPlusLarge",3,"click"],[1,"text-base","font-semibold","mt-7"],[1,"grid","grid-cols-12","gap-3","my-4",3,"formGroupName"],[1,"col-span-4"],[1,"block","pb-1"],[1,"text-xs","text-red-400"],["formControlName","approverIds",3,"checkUsersLength","approverList"],["class","text-xs text-red-500",4,"ngIf"],["for","conditionSelect",1,"block","pb-1"],["formControlName","condition","aria-label","Default select example","id","conditionSelect",1,"h-10","form-select","form-control",3,"change"],["value","and"],["value","or"],["value","none"],[1,"col-span-1","mt-8","inline-flex"],["direction","right",1,"mr-4","mt-1","-ml-2",3,"content"],[3,"contentTop","colorTop"],["tuiIconButton","","type","button","size","s","appearance","outline","icon","tuiIconMailLarge",3,"click"],[1,"col-span-1","mt-8","-ml-8"],["tuiIconButton","","type","button","size","s","appearance","secondary-destructive","icon","tuiIconTrash2Large",3,"click"],[1,"text-xs","text-red-500"],["size","l",1,"w-full","my-4","shadow-lg","border","border-[#F15B41]","px-5","mx-auto"],[1,"mb-5","text-base","font-semibold","text-gray-700"],[3,"draggable","itemsCount","index","indexChange"],["size","s",1,"my-5","pagination",3,"length","index","indexChange"],["class","flex justify-between w-full",4,"tuiItem"],[1,"flex","justify-between","w-full"],[1,"relative","w-full","px-4","py-4","text-left","border","border-gray-200","rounded-md","bg-gray-50"],[1,"mb-2","text-lg","font-semibold","text-gray-700"],["class","px-5",4,"ngFor","ngForOf"],[1,"absolute","top-0","right-0","px-3","py-1","text-sm","font-semibold","bg-gray-200","rounded-b-none","text-slate-700","rounded-r-md"],[1,"ml-4","mt-7"],["class","fa fa-long-arrow-right fa-lg","aria-hidden","true",4,"ngIf"],[1,"px-5"],[1,"list-disc"],["aria-hidden","true",1,"fa","fa-long-arrow-right","fa-lg"],[1,"text-lg","font-semibold","text-center"],[1,"mt-3","text-base","font-medium","text-gray-500"],[1,"flex","flex-col","justify-center","my-5"],[1,"b-form",3,"formControl","tuiTextfieldLabelOutside","searchChange"],[3,"items",4,"tuiDataList"],[1,"flex","justify-start","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["appearance","accent","tuiButton","","type","button","size","m",3,"click"],[3,"items"],[1,"text-base"],[1,"mt-2"],[1,"my-2"]],template:function(o,t){1&o&&(e._UZ(0,"app-header"),e.TgZ(1,"section",0)(2,"div",1)(3,"section",2)(4,"nav",3),e.YNc(5,ft,3,1,"ng-container",4),e.qZA(),e.YNc(6,ht,2,1,"ng-container",4),e.qZA()(),e.TgZ(7,"tui-tabs",5),e.NdJ("activeItemIndexChange",function(s){return t.activeItemIndex=s}),e.TgZ(8,"button",6),e._UZ(9,"tui-svg",7),e._uU(10," Approval Workflow "),e.qZA(),e.TgZ(11,"button",6),e._UZ(12,"tui-svg",8),e._uU(13," Modify Workflow "),e.qZA()(),e.YNc(14,xt,6,2,"div",9),e.YNc(15,Tt,7,6,"ng-container",10),e.TgZ(16,"div",11)(17,"button",12),e.NdJ("click",function(){return t.createSubmission()}),e.ALo(18,"async"),e._uU(19," Create submission "),e.qZA(),e.TgZ(20,"button",13),e.NdJ("click",function(){return t.cancelSubmission()}),e._uU(21," Cancel "),e.qZA()()(),e.YNc(22,It,13,2,"ng-template",null,14,e.W1O),e.YNc(24,At,16,0,"ng-template",null,15,e.W1O)),2&o&&(e.xp6(5),e.Q6J("ngForOf",t.formTabs),e.xp6(1),e.Q6J("ngForOf",t.formWithWorkflow),e.xp6(1),e.Q6J("activeItemIndex",t.activeItemIndex),e.xp6(7),e.Q6J("ngIf",1==t.activeItemIndex),e.xp6(1),e.Q6J("ngIf",0==t.activeItemIndex),e.xp6(2),e.Q6J("showLoader",e.lcZ(18,6,t.creatingSubmission)))},dependencies:[p.sg,p.O5,D.G,Y.k4,q.h,u.YN,u.Kr,u.EJ,u.JJ,u.JL,u.oH,u.sg,u.u,u.x0,u.CE,I.PN,B.v0,b.H9,b.p_,b.uW,b.yu,gt.w,$.r,he.e,R.VF,R.EB,pe.PZ,me.eC,mt.gX,ge.V,fe.xT,_e.w,p.Ov]});class M{constructor(o,t,i){this.activatedRoute=o,this.workflowService=t,this.notif=i,this.destory$=new g.x,this.savingDecision=new O.X(!0),this.activatedRoute.queryParams.pipe((0,d.R)(this.destory$)).subscribe(s=>{if(s){const r={stepId:s.stepId,userId:s.userId,isApproved:Boolean(s.isApproved)};this.userDecision=r.isApproved,this.savingDecision.next(!0),this.workflowService.updateSubmissionWorkflow(s.submissionId,r).pipe((0,d.R)(this.destory$)).subscribe(l=>{console.log(l),this.savingDecision.next(!1)})}else this.savingDecision.next(!1),this.notif.displayNotification("Something Went Wrong","Update Submission","error")})}ngOnDestroy(){this.destory$.complete(),this.destory$.unsubscribe()}}M.\u0275fac=function(o){return new(o||M)(e.Y36(f.gz),e.Y36(_),e.Y36(Q.T))},M.\u0275cmp=e.Xpm({type:M,selectors:[["ng-component"]],decls:14,vars:6,consts:[["size","xxl",3,"inheritColor","overlay","showLoader"],[1,"w-screen","h-screen","sm:h-80","bg-[#808285]","relative"],[1,"absolute","w-11/12","px-4","py-2","mx-3","text-center","bg-white","rounded-lg","shadow-lg","left-2","sm:left-1/4","top-32","sm:w-1/2","sm:top-1/2"],[1,"pt-3","w-26","h-26","absolute","-top-16","-translate-x-1/2","left-1/2"],["ngSrc","../../../../assets/depa_logo.svg","width","100","height","100"],[1,"my-16","px-4"],[1,"pt-2","text-4xl","tracking-widest","font-semibold"],[1,"py-4","text-lg","tracking-widest"],[1,"text-gray-600","font-semibold"]],template:function(o,t){1&o&&(e.TgZ(0,"tui-loader",0),e.ALo(1,"async"),e.TgZ(2,"section",1)(3,"div",2)(4,"div",3),e._UZ(5,"img",4),e.qZA(),e.TgZ(6,"div",5)(7,"h2",6),e._uU(8,"Hello!"),e.qZA(),e.TgZ(9,"p",7),e._uU(10,"You have chosen to "),e.TgZ(11,"span",8),e._uU(12),e.qZA(),e._uU(13," this step. Your decision has been saved and the workflow has been updated. You may now close this page"),e.qZA()()()()()),2&o&&(e.Q6J("inheritColor",!0)("overlay",!0)("showLoader",!0===e.lcZ(1,4,t.savingDecision)),e.xp6(12),e.Oqu(!0===t.userDecision?"Approve":"Reject"))},dependencies:[p.Zd,J.kM,p.Ov]});var V=a(14371);class y{resolve(o){return(0,c.rV)(c.MX.subModuleSlug)}}y.\u0275fac=function(o){return new(o||y)},y.\u0275prov=e.Yz7({token:y,factory:y.\u0275fac,providedIn:"root"});class k{resolve(o){return(0,c.rV)(c.MX.formKey)}}k.\u0275fac=function(o){return new(o||k)},k.\u0275prov=e.Yz7({token:k,factory:k.\u0275fac,providedIn:"root"});const Ut=[{path:"",component:w,resolve:{breadcrumb:y},children:[{path:":submoduleCode/add-submission/:id",canActivate:[V.a],component:S,data:{breadcrumb:"Add Submission"}},{path:":submoduleCode/:key/:id",canActivate:[V.a],component:A,resolve:{breadcrumb:k}},{path:":submoduleCode/:id",canActivate:[V.a],component:U},{path:"email-submission",component:M},{path:"",canActivate:[V.a],component:w}]}];class C{}C.\u0275fac=function(o){return new(o||C)},C.\u0275mod=e.oAB({type:C}),C.\u0275inj=e.cJS({imports:[f.Bz.forChild(Ut),f.Bz]});var St=a(44886),Mt=a(69952);class T{}T.\u0275fac=function(o){return new(o||T)},T.\u0275mod=e.oAB({type:T}),T.\u0275inj=e.cJS({imports:[p.ez,C,D.G,W.c,Y.XI,N.V5,q.y,u.UX,Ne,ue.f,I.EI,B.fN,b.$$,Mt.x,$.i,he.e,J.dS,R.Xj,pe.cB,me.zX,ge.f,fe.cn,ce.X,de.z,St.go,_e.Q,v]})}}]);