"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[919],{24919:(lt,N,m)=>{m.r(N),m.d(N,{FormsModule:()=>_});var p=m(88692),T=m(94032),t=m(64537);class F{}F.\u0275fac=function(e){return new(e||F)},F.\u0275cmp=t.Xpm({type:F,selectors:[["app-forms"]],decls:1,vars:0,template:function(e,o){1&e&&t._UZ(0,"router-outlet")},dependencies:[T.lC]});var l=m(20092),x=m(42281),Z=m(20707),D=m(38023),u=m(13528),J=m(92340),c=m(4266),U=m(17820),A=m(89570),E=m(12628),j=m(56501),B=m(20696);function Y(r,e){if(1&r){const o=t.EpF();t.ynx(0),t.TgZ(1,"div",6)(2,"p",7),t._uU(3),t.qZA(),t.TgZ(4,"tui-checkbox-labeled",8),t.NdJ("ngModelChange",function(a){const i=t.CHM(o).$implicit,d=t.oxw();return t.KtG(d.setCanView(a,i.id))}),t._uU(5," Can Edit? "),t.TgZ(6,"div",9),t._uU(7,"User will have the right to edit this component"),t.qZA()(),t.TgZ(8,"tui-checkbox-labeled",10),t._uU(9," Can View? "),t.TgZ(10,"div",9),t._uU(11,"User will have the right to only view this component"),t.qZA()()(),t.BQk()}if(2&r){const o=e.$implicit,n=t.oxw();t.xp6(3),t.Oqu(null==o?null:o.name),t.xp6(1),t.Q6J("formControl",n.userFormControls[o.id].canEdit),t.xp6(4),t.Q6J("formControl",n.userFormControls[o.id].canView)}}class b{constructor(e,o,n){this.context=e,this.dialogs=o,this.transport=n,this.userFormControls={},this.workflowApprovers=(0,c.rV)(c.MX.approvers)||[],this.workflowApprovers.forEach(this.workflowApprovers.length>0?a=>{let s=!1;this.data&&this.data?.permissions?.length>0&&this.data?.permissions?.forEach(i=>{a?.id==i?.id&&(this.userFormControls[a.id]={canEdit:new l.NI(i?.canEdit),canView:new l.NI(i?.canView)},s=!0)}),s||(this.userFormControls[a.id]={canEdit:new l.NI(!1),canView:new l.NI(!1)})}:a=>{this.userFormControls[a.id]={canEdit:new l.NI(!1),canView:new l.NI(!1)}})}setCanView(e,o){1==e&&this.userFormControls[o]?.canView?.setValue(!0)}get data(){return this.context.data}submitPermission(){this.workflowApprovers=this.workflowApprovers?.map(o=>({...o,canEdit:this.userFormControls[o.id]?.canEdit?.value,canView:this.userFormControls[o.id]?.canView?.value}));let e={...this.data,permissions:this.workflowApprovers};this.transport.updatedComponent.emit(e),this.context.completeWith(this.data)}cancel(){this.context.completeWith(null)}showDialog(e){this.dialogs.open(e,{dismissible:!1,closeable:!1,size:"l"}).subscribe()}}b.\u0275fac=function(e){return new(e||b)(t.Y36(A.yf),t.Y36(Z.RO),t.Y36(B.R))},b.\u0275cmp=t.Xpm({type:b,selectors:[["ng-component"]],standalone:!0,features:[t.jDz],decls:9,vars:1,consts:[[1,"text-lg","font-semibold","text-center"],[1,"my-6"],[4,"ngFor","ngForOf"],[1,"flex","justify-center","gap-2","mt-5"],["tuiButton","","type","button","size","m","appearance","primary",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"border-b","border-gray-300","py-4","flex","justify-start","gap-x-3"],[1,"font-semibold","text-base","mb-3","mr-4"],[1,"tui-space_top-1",3,"formControl","ngModelChange"],[1,"text-gray-400"],[1,"tui-space_top-1",3,"formControl"]],template:function(e,o){1&e&&(t.TgZ(0,"h2",0),t._uU(1,"Set Permissions for users"),t.qZA(),t.TgZ(2,"div",1),t.YNc(3,Y,12,3,"ng-container",2),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return o.submitPermission()}),t._uU(6," Confirm "),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return o.cancel()}),t._uU(8," Cancel "),t.qZA()()),2&e&&(t.xp6(3),t.Q6J("ngForOf",o.workflowApprovers))},dependencies:[p.ez,p.sg,E.fN,E.v0,l.UX,l.JJ,l.oH,l.u5,j.s,j.p],encapsulation:2});var S=m(22603),V=m(94051),Q=m(46954),k=m(95380),h=m(30663),M=m(29145);const R=["json"],P=["code"];function $(r,e){if(1&r){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",5),t.NdJ("click",function(){const s=t.CHM(o).index,i=t.oxw();return i.activeIndex=s,i.onJsonView(),t.KtG(i.triggerPermissionBtnOnTabChange())}),t._UZ(2,"i",6),t._uU(3),t.qZA(),t.BQk()}if(2&r){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function H(r,e){1&r&&(t.TgZ(0,"p",18),t._uU(1," A form by this title already exists. Please select another name "),t.qZA())}function G(r,e){1&r&&(t.TgZ(0,"p",18),t._uU(1," A code by this name already exists. Please select another code "),t.qZA())}function X(r,e){if(1&r){const o=t.EpF();t.TgZ(0,"section",7)(1,"div",8)(2,"div",9)(3,"label",10),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",11),t.YNc(6,H,2,0,"p",12),t.qZA(),t.TgZ(7,"div",9)(8,"label",10),t._uU(9,"Code"),t.qZA(),t._UZ(10,"input",13),t.YNc(11,G,2,0,"p",12),t.qZA()(),t.TgZ(12,"form-builder",14),t.NdJ("change",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.onChange(a))}),t.qZA(),t.TgZ(13,"div",15)(14,"button",16),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.submitFormData())}),t._uU(15),t.qZA(),t.TgZ(16,"button",17),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.cancelFormData())}),t._uU(17," Cancel "),t.qZA()()()}if(2&r){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("ngIf",null==o.formTitleControl?null:o.formTitleControl.hasError("codeExists")),t.xp6(4),t.Q6J("formControl",o.formCodeControl),t.xp6(1),t.Q6J("ngIf",null==o.formCodeControl?null:o.formCodeControl.hasError("codeExists")),t.xp6(1),t.Q6J("form",o.form)("options",o.options),t.xp6(2),t.Q6J("disabled",null==o.formTitleControl?null:o.formTitleControl.hasError("codeExists")),t.xp6(1),t.hij(" ",1==o.editMode?"Update":"Submit"," Form ")}}function q(r,e){if(1&r&&(t.TgZ(0,"section",7)(1,"div",19),t._UZ(2,"formio",20),t.qZA()()),2&r){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function z(r,e){1&r&&(t.TgZ(0,"section",7)(1,"div",19)(2,"pre",21),t._UZ(3,"code",22),t.qZA()()())}class w{constructor(e,o,n,a,s,i,d,g){this.transportService=e,this.notif=o,this.location=n,this.activatedRoute=a,this.formService=s,this.dashboard=i,this.dialogs=d,this.injector=g,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode},l.kI.compose([l.kI.required])),this.formCodeControl=new l.NI({value:"",disabled:this.editMode},l.kI.compose([l.kI.required]),[U.Iw.createValidator(this.dashboard,"form")]),this.formDisplayType=new l.NI("form"),this.destroy$=new D.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.options={disableAlerts:!0,noDefaultSubmitButton:!0},this.editMode=this.transportService.isFormEdit.value,this.activatedRoute.queryParams?.subscribe(v=>{v.key&&this.formService.getFormByKey(v.key).pipe((0,u.R)(this.destroy$)).subscribe(f=>{f&&(this.form=f,this.formTitleControl.setValue(f?.title),this.formCodeControl.setValue(f?.key),this.formValue=this.form)}),!0===this.editMode?(this.form=this.transportService.sendFormDataForEdit.value,this.formTitleControl.setValue(this.transportService.sendFormDataForEdit.value.title),this.formCodeControl.setValue(this.transportService.sendFormDataForEdit.value?.key),this.formValue=this.form):this.form={title:this.formTitleControl?.value,key:this.formCodeControl?.value,display:this.formDisplayType.value,components:[]},this.formValue=this.form})}ngOnInit(){this.activatedRoute.queryParams.pipe((0,u.R)(this.destroy$)).subscribe(e=>{this.dashboard.items=[...(0,c.rV)(c.MX.editBreadcrumbs),{caption:"Add Form",routerLink:"/forms/form-builder"}]}),this.transportService.updatedComponent.pipe((0,u.R)(this.destroy$)).subscribe(e=>{e&&x.cQ.eachComponent(this.form.components,(o,n)=>{if(o.key===e.key){Object.assign(o,e);const a=n.split(".");let s=this.form.components;for(let i=0;i<a.length-1;i++){const d=a[i];if(s=s.find(g=>g.key===d),!s)break;s=s.components}if(s){const i=s.findIndex(d=>d.key===e.key);-1!==i&&(s[i]=o)}}},!0)})}ngAfterViewInit(){setTimeout(()=>this.addCustomEventTrigger(),2e3),this.onJsonView()}triggerPermissionBtnOnTabChange(){setTimeout(()=>this.addCustomEventTrigger(),2e3)}goback(){this.location.back()}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,"file"==e.component?.type&&(e.component.storage="url",e.component.url=`${J.N.apiUrl}/upload`,e.component.uploadEnabled=!0,e.component.input=!0,e.component.multiple=!0),"select"==e.component?.type&&e.component?.template?.replace(/&lt;/g,"<").replace(/&gt;/g,">"),this.formValue=e.form,this.addCustomEventTrigger()}addCustomEventTrigger(){let e=document.getElementsByClassName("component-btn-group");Array.from(e).forEach((o,n)=>{if(o.querySelector("#custom-div"))return;let s=document.createElement("div"),i=document.createElement("div");i.id="custom-div",i.setAttribute("class","btn btn-xxs btn-primary component-settings-button component-settings-button-depa relative"),i.tabIndex=-1,i.role="button",i.ariaLabel="Permissions Button",i.innerHTML='<i class="fa fa-key"></i>',i.addEventListener("click",()=>{let d=x.cQ.flattenComponents(this.form.components,!0);this.openPermissionDialog(Object.values(d)[n])}),i.addEventListener("mouseover",()=>{s.setAttribute("class","absolute z-30 -top-8 -left-10 bg-black bg-opacity-80 text-white text-[13px] font-medium rounded-md p-2"),s.innerText="Permissions",i.append(s)}),i.addEventListener("mouseleave",()=>{s.remove()}),o.append(i)})}openPermissionDialog(e){this.dialogs.open(new A.Al(b,this.injector),{data:e,dismissible:!1,closeable:!1}).pipe((0,u.R)(this.destroy$)).subscribe()}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value||!this.formCodeControl?.value||""==this.formCodeControl?.value||this.formCodeControl?.invalid)return this.notif.displayNotification("Please provide a valid title and code for your form","Create Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("You have not created a form!","Create Form","warning");if((0,c.cl)(c.MX.approvers),this.form.title=this.formTitleControl?.value,this.form.display=this.formDisplayType?.value,this.form.key=this.formCodeControl?.value,0==this.editMode)if(this.transportService.formBuilderData.value[0].components?.length>0){const e=[...this.transportService.formBuilderData.value,this.form];this.transportService.sendFormBuilderData(e),this.location.back()}else this.transportService.sendFormBuilderData([this.form]),this.location.back();else{(0==this.transportService.formBuilderData.value?.components?.length||0==Object.keys(this.transportService.formBuilderData.value)?.length)&&this.transportService.formBuilderData.next([this.form]);const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.location.back()}}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){if((0,c.cl)(c.MX.approvers),0==this.editMode)this.transportService.sendFormBuilderData([{title:"",key:"",display:"",components:[]}]),this.location.back();else{(0==this.transportService.formBuilderData.value?.components?.length||0==Object.keys(this.transportService.formBuilderData.value)?.length)&&this.transportService.formBuilderData.next([this.form]);const e=this.transportService.formBuilderData.value?.map(o=>(o.title==this.form?.title&&(o=this.form),o));this.transportService.sendFormBuilderData(e),this.location.back()}}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}w.\u0275fac=function(e){return new(e||w)(t.Y36(B.R),t.Y36(S.T),t.Y36(p.Ye),t.Y36(T.gz),t.Y36(V.s),t.Y36(Q.s),t.Y36(Z.RO),t.Y36(t.zs3))},w.\u0275cmp=t.Xpm({type:w,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(R,7),t.Gf(P,7)),2&e){let n;t.iGM(n=t.CRH())&&(o.jsonElement=n.first),t.iGM(n=t.CRH())&&(o.codeElement=n.first)}},decls:9,vars:5,consts:[[1,"relative","pt-40","pb-5"],["tuiMobileTabs","",1,"flex","justify-center","mx-2","lg:mx-20","md:mx-10",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["childContainer",""],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","w-8/12","grid-cols-12","gap-3","px-1","mx-auto","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],["class","mt-1 text-xs text-red-500",4,"ngIf"],["type","text","placeholder","Form code","id","codField",1,"form-control",3,"formControl"],[3,"form","options","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"disabled","click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"mt-1","text-xs","text-red-500"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t._UZ(0,"app-header"),t.TgZ(1,"section",0)(2,"tui-tabs",1),t.YNc(3,$,4,3,"ng-container",2),t.qZA()(),t.YNc(4,X,18,8,"section",3),t.YNc(5,q,3,2,"section",3),t.YNc(6,z,4,0,"section",3),t.GkF(7,null,4)),2&e&&(t.xp6(2),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[p.sg,p.O5,k.k4,k.hd,h.H9,h.p_,h.yu,E.v0,M.G,l.Fj,l.JJ,l.oH]});const L=["json"],K=["code"];function W(r,e){if(1&r){const o=t.EpF();t.ynx(0),t.TgZ(1,"button",4),t.NdJ("click",function(){const s=t.CHM(o).index,i=t.oxw();return i.activeIndex=s,i.onJsonView(),t.KtG(i.triggerPermissionBtnOnTabChange())}),t._UZ(2,"i",5),t._uU(3),t.qZA(),t.BQk()}if(2&r){const o=e.$implicit;t.xp6(2),t.Tol(o.icon),t.xp6(1),t.hij(" \xa0 ",o.text," ")}}function tt(r,e){1&r&&(t.TgZ(0,"p",17),t._uU(1," A form by this title already exists. Please select another name "),t.qZA())}function et(r,e){1&r&&(t.TgZ(0,"p",17),t._uU(1," A code by this name already exists. Please select another code "),t.qZA())}function ot(r,e){if(1&r){const o=t.EpF();t.TgZ(0,"section",6)(1,"div",7)(2,"div",8)(3,"label",9),t._uU(4,"Title"),t.qZA(),t._UZ(5,"input",10),t.YNc(6,tt,2,0,"p",11),t.qZA(),t.TgZ(7,"div",8)(8,"label",9),t._uU(9,"Code"),t.qZA(),t._UZ(10,"input",12),t.YNc(11,et,2,0,"p",11),t.qZA()(),t.TgZ(12,"form-builder",13),t.NdJ("change",function(a){t.CHM(o);const s=t.oxw();return t.KtG(s.onChange(a))}),t.qZA(),t.TgZ(13,"div",14)(14,"button",15),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.submitFormData())}),t.ALo(15,"async"),t._uU(16),t.qZA(),t.TgZ(17,"button",16),t.NdJ("click",function(){t.CHM(o);const a=t.oxw();return t.KtG(a.cancelFormData())}),t._uU(18," Cancel "),t.qZA()()()}if(2&r){const o=t.oxw();t.xp6(5),t.Q6J("formControl",o.formTitleControl),t.xp6(1),t.Q6J("ngIf",null==o.formTitleControl?null:o.formTitleControl.hasError("codeExists")),t.xp6(4),t.Q6J("formControl",o.formCodeControl),t.xp6(1),t.Q6J("ngIf",null==o.formCodeControl?null:o.formCodeControl.hasError("codeExists")),t.xp6(1),t.Q6J("form",o.form)("options",o.options),t.xp6(2),t.Q6J("disabled",null==o.formTitleControl?null:o.formTitleControl.hasError("codeExists"))("showLoader",t.lcZ(15,9,o.creatingForm)),t.xp6(2),t.hij(" ",o.editFormID?"Update":"Submit"," Form ")}}function it(r,e){if(1&r&&(t.TgZ(0,"section",6)(1,"div",18),t._UZ(2,"formio",19),t.qZA()()),2&r){const o=t.oxw();t.xp6(2),t.Q6J("form",o.form)("refresh",o.refreshForm)}}function rt(r,e){1&r&&(t.TgZ(0,"section",6)(1,"div",18)(2,"pre",20),t._UZ(3,"code",21),t.qZA()()())}class I{constructor(e,o,n,a,s,i,d,g){this.notif=e,this.activatedRoute=o,this.formService=n,this._location=a,this.dashboard=s,this.dialogs=i,this.injector=d,this.transportService=g,this.refreshForm=new t.vpe,this.activeIndex=0,this.editMode=!1,this.options={disableAlerts:!0,noDefaultSubmitButton:!0},this.items=[{text:"Form Builder",icon:"fa fa-file-text-o fa-lg"},{text:"Preview",icon:"fa fa-eye fa-lg"},{text:"JSON view",icon:"fa fa-file-code-o fa-lg"}],this.formTitleControl=new l.NI({value:"",disabled:this.editMode},l.kI.compose([l.kI.required])),this.formCodeControl=new l.NI({value:"",disabled:this.editMode},l.kI.compose([l.kI.required]),[U.Iw.createValidator(this.dashboard,"form")]),this.formDisplayType=new l.NI("form"),this.destroy$=new D.x,this.crudUsers=new l.NI([]),this.viewUsers=new l.NI([]),this.creatingForm=new D.x,this.activatedRoute?.queryParams.pipe((0,u.R)(this.destroy$)).subscribe(v=>{v.id?(this.editFormID=v.id,this.formService.getFormById(v.id).pipe((0,u.R)(this.destroy$)).subscribe(f=>{f&&(x.cQ.eachComponent(f?.components,C=>{if("select"==C.type&&(C.template=C?.template?.replace(/&lt;/g,"<").replace(/&gt;/g,">")),"editgrid"==C.type)for(const O in C.templates)C.templates[O]=C.templates[O]?.replace(/&lt;/g,"<").replace(/&gt;/g,">")}),this.form=f,this.formTitleControl.setValue(f?.title),this.formCodeControl.setValue(f?.key))})):this.form={title:this.formTitleControl?.value,key:this.formCodeControl?.value,display:this.formDisplayType.value||null,components:[]}})}ngOnInit(){this.dashboard.items=[...(0,c.rV)(c.MX.editBreadcrumbs),{caption:(0,c.rV)(c.MX.formKey)||"Add Form",routerLink:`/forms/edit-form?id=${this.editFormID}`}],this.transportService.updatedComponent.pipe((0,u.R)(this.destroy$)).subscribe(e=>{e&&x.cQ.eachComponent(this.form.components,(o,n)=>{if(o.key===e.key){Object.assign(o,e);const a=n.split(".");let s=this.form.components;for(let i=0;i<a.length-1;i++){const d=a[i];if(s=s.find(g=>g.key===d),!s)break;s=s.components}if(s){const i=s.findIndex(d=>d.key===e.key);-1!==i&&(s[i]=o)}}},!0)})}ngAfterViewInit(){setTimeout(()=>this.addCustomEventTrigger(),2e3)}triggerPermissionBtnOnTabChange(){setTimeout(()=>this.addCustomEventTrigger(),2e3)}onChange(e){this.refreshForm.emit({property:"form",value:e.form}),e.form.display=this.formDisplayType?.value,e.form.title=this.formTitleControl?.value,this.formValue=e.form,"file"==e.component?.type&&(e.component.storage="url",e.component.url=`${J.N.apiUrl}/upload`,e.component.uploadEnabled=!0,e.component.input=!0,e.component.multiple=!0),"select"==e.component?.type&&(e.component.template=e.component?.template?.replace(/&lt;/g,"<").replace(/&gt;/g,">")),this.addCustomEventTrigger()}addCustomEventTrigger(){let e=document.getElementsByClassName("component-btn-group");Array.from(e).forEach((o,n)=>{if(o.querySelector("#custom-div"))return;let s=document.createElement("div"),i=document.createElement("div");i.id="custom-div",i.setAttribute("class","btn btn-xxs btn-primary component-settings-button component-settings-button-depa relative"),i.tabIndex=-1,i.role="button",i.ariaLabel="Permissions Button",i.innerHTML='<i class="fa fa-key"></i>',i.addEventListener("click",()=>{let d=x.cQ.flattenComponents(this.form.components,!0);this.openPermissionDialog(Object.values(d)[n])}),i.addEventListener("mouseover",()=>{s.setAttribute("class","absolute z-30 -top-8 -left-10 bg-black bg-opacity-80 text-white text-[13px] font-medium rounded-md p-2"),s.innerText="Permissions",i.append(s)}),i.addEventListener("mouseleave",()=>{s.remove()}),o.append(i)})}openPermissionDialog(e){this.dialogs.open(new A.Al(b,this.injector),{data:e,dismissible:!1,closeable:!1}).pipe((0,u.R)(this.destroy$)).subscribe()}onJsonView(){setTimeout(()=>{const e=document.getElementById("json_code");e&&(e.innerHTML=""),e?.appendChild(document.createTextNode(JSON.stringify(this.formValue||this.form,null,4)))},500)}submitFormData(){if(!this.formTitleControl?.value||""==this.formTitleControl?.value||!this.formCodeControl?.value||""==this.formCodeControl?.value||this.formCodeControl?.invalid)return this.notif.displayNotification("Please provide a valid title and code for your form","Edit Form","warning");if(0==this.form?.components?.length)return this.notif.displayNotification("Your form cannot be empty!","Edit Form","warning");(0,c.cl)(c.MX.approvers),this.creatingForm.next(!0),x.cQ.eachComponent(this.form?.components,n=>{if("select"==n.type&&(n.template=n?.template?.replace(/&lt;/g,"<").replace(/&gt;/g,">")),"editgrid"==n.type)for(const a in n.templates)n.templates[a]=n.templates[a]?.replace(/&lt;/g,"<").replace(/&gt;/g,">")});const e={title:this.formTitleControl?.value,key:this.formCodeControl?.value,display:this.form?.display??this.formDisplayType.value,components:this.form?.components},o=(0,c.rV)(c.MX.formEdit);this.editFormID?this.formService.updateForm(this.editFormID,e).pipe((0,u.R)(this.destroy$)).subscribe(n=>{n?(o?((0,c.cl)(c.MX.formEdit),setTimeout(()=>this._location.back(),800)):this._location.back(),this.creatingForm.next(!1)):this.creatingForm.next(!1)}):(Object.assign(e,{subModuleId:this.transportService.subModuleID?.value}),this.formService.createForm(e).pipe((0,u.R)(this.destroy$)).subscribe(n=>{n?(o?((0,c.cl)(c.MX.formEdit),setTimeout(()=>this._location.back(),800)):this._location.back(),this.creatingForm.next(!1)):this.creatingForm.next(!1)}))}setSelectValue(e){this.formDisplayType.setValue(e.target.value)}cancelFormData(){(0,c.cl)(c.MX.approvers),(0,c.rV)(c.MX.formEdit)?((0,c.cl)(c.MX.formEdit),this._location.back()):this._location.back()}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}I.\u0275fac=function(e){return new(e||I)(t.Y36(S.T),t.Y36(T.gz),t.Y36(V.s),t.Y36(p.Ye),t.Y36(Q.s),t.Y36(Z.RO),t.Y36(t.zs3),t.Y36(B.R))},I.\u0275cmp=t.Xpm({type:I,selectors:[["ng-component"]],viewQuery:function(e,o){if(1&e&&(t.Gf(L,7),t.Gf(K,7)),2&e){let n;t.iGM(n=t.CRH())&&(o.jsonElement=n.first),t.iGM(n=t.CRH())&&(o.codeElement=n.first)}},decls:7,vars:5,consts:[[1,"pb-5","pt-44"],["tuiMobileTabs","",1,"flex","justify-center","mx-2","lg:mx-20","md:mx-10",3,"activeItemIndex"],[4,"ngFor","ngForOf"],["class","px-5",4,"ngIf"],["tuiTab","","tuiRipple","var(--tui-text-01)",3,"click"],["alt","svg-icon",1,"pr-1"],[1,"px-5"],[1,"grid","w-8/12","grid-cols-12","gap-3","px-1","mx-auto","my-4"],[1,"col-span-6"],["for","titleField"],["type","text","placeholder","Form title","id","titleField",1,"form-control",3,"formControl"],["class","mt-1 text-xs text-red-500",4,"ngIf"],["type","text","placeholder","Form code","id","codField",1,"form-control",3,"formControl"],[3,"form","options","change"],[1,"flex","justify-center","py-3"],["tuiButton","","type","button","size","m","appearance","accent",1,"tui-space_right-3","tui-space_bottom-3",3,"disabled","showLoader","click"],["tuiButton","","type","button","size","m","appearance","secondary-destructive",1,"tui-space_right-3","tui-space_bottom-3",3,"click"],[1,"mt-1","text-xs","text-red-500"],[1,"well","jsonviewer"],[3,"form","refresh"],["id","json"],["id","json_code",1,"language-json"]],template:function(e,o){1&e&&(t._UZ(0,"app-header"),t.TgZ(1,"section",0)(2,"tui-tabs",1),t.YNc(3,W,4,3,"ng-container",2),t.qZA()(),t.YNc(4,ot,19,11,"section",3),t.YNc(5,it,3,2,"section",3),t.YNc(6,rt,4,0,"section",3)),2&e&&(t.xp6(2),t.Q6J("activeItemIndex",o.activeIndex),t.xp6(1),t.Q6J("ngForOf",o.items),t.xp6(1),t.Q6J("ngIf",0==o.activeIndex),t.xp6(1),t.Q6J("ngIf",1===o.activeIndex),t.xp6(1),t.Q6J("ngIf",2===o.activeIndex))},dependencies:[p.sg,p.O5,k.k4,k.hd,h.H9,h.p_,h.yu,E.v0,M.G,l.Fj,l.JJ,l.oH,p.Ov]});const nt=[{path:"",component:F,children:[{path:"form-builder",component:w,data:{breadcrumb:"Form Builder"}},{path:"edit-form",component:I,data:{breadcrumb:"Edit Form"}},{path:"",redirectTo:"form-builder",pathMatch:"full"}]}];class y{}y.\u0275fac=function(e){return new(e||y)},y.\u0275mod=t.oAB({type:y}),y.\u0275inj=t.cJS({imports:[T.Bz.forChild(nt),T.Bz]});var st=m(64413),at=m(27076);class _{}_.\u0275fac=function(e){return new(e||_)},_.\u0275mod=t.oAB({type:_}),_.\u0275inj=t.cJS({imports:[p.ez,y,k.XI,h.$$,E.fN,M.G,l.UX,st.e,at.nm]})}}]);