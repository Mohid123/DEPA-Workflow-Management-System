"use strict";(self.webpackChunkDEPA_FRONTEND=self.webpackChunkDEPA_FRONTEND||[]).push([[142],{89142:(mn,G,l)=>{l.r(G),l.d(G,{DashboardModule:()=>A});var p=l(88692),a=l(20092),g=l(94032),t=l(64537);class E{constructor(){}}E.\u0275fac=function(n){return new(n||E)},E.\u0275cmp=t.Xpm({type:E,selectors:[["app-dashboard"]],decls:1,vars:0,template:function(n,e){1&n&&t._UZ(0,"router-outlet")},dependencies:[g.lC]});var f=l(20707),h=l(46954),b=l(13916),T=l(13782),d=l(12628),Y=l(40719),x=l(5754),m=l(4266),L=l(88070),y=l(8089),v=l(20696);function ct(i,n){1&i&&(t.ynx(0),t._UZ(1,"tui-badge",22),t.BQk())}const K=function(i){return["/modules",i]},X=function(i){return{moduleID:i}};function pt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"a",23),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.storeModuleID(null==r.appData?null:r.appData._id,null==r.appData?null:r.appData.code))}),t._UZ(1,"i",24),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("routerLink",t.VKq(2,K,null==e.appData?null:e.appData.code))("queryParams",t.VKq(4,X,null==e.appData?null:e.appData._id))}}const dt=function(i){return["/modules/edit-module",i]},mt=function(i){return{moduleCode:i}};function _t(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"a",25),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.editModuleEvent(null==r.appData?null:r.appData._id,null==r.appData?null:r.appData.code,null==r.appData?null:r.appData.title))}),t._UZ(1,"i",26),t.qZA()}if(2&i){const e=t.oxw(2);t.Q6J("routerLink",t.VKq(2,dt,null==e.appData?null:e.appData._id))("queryParams",t.VKq(4,mt,null==e.appData?null:e.appData.code))}}function gt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"a",27),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2);return t.KtG(r.deleteModuleEvent(null==r.appData?null:r.appData._id))}),t._UZ(1,"i",28),t.qZA()}}function ht(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"div",4),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.storeModuleID(null==r.appData?null:r.appData._id,null==r.appData?null:r.appData.code))}),t.TgZ(2,"div",5),t._UZ(3,"img",6),t.qZA(),t.TgZ(4,"div",7)(5,"h3",8),t._uU(6),t.YNc(7,ct,2,0,"ng-container",9),t.qZA(),t.TgZ(8,"p",10),t._uU(9),t.qZA()()(),t.TgZ(10,"div",11),t.YNc(11,pt,2,6,"a",12),t.YNc(12,_t,2,6,"a",13),t.YNc(13,gt,2,0,"a",14),t.TgZ(14,"div",15)(15,"a",16),t._UZ(16,"tui-badge",17)(17,"i",18),t.qZA(),t.TgZ(18,"a",19),t._UZ(19,"tui-badge",20)(20,"i",21),t.qZA()()()()}if(2&i){const e=t.oxw(),o=t.MAs(2),r=t.MAs(4);t.xp6(1),t.Q6J("routerLink",t.VKq(14,K,null==e.appData?null:e.appData.code))("queryParams",t.VKq(16,X,null==e.appData?null:e.appData._id)),t.xp6(2),t.Q6J("src",null==e.appData?null:e.appData.image,t.LSH),t.xp6(3),t.hij(" ",null==e.appData?null:e.appData.title," "),t.xp6(1),t.Q6J("ngIf",3===(null==e.appData?null:e.appData.status)),t.xp6(2),t.Oqu(null==e.appData?null:e.appData.description),t.xp6(2),t.Q6J("ngIf",3!==(null==e.appData?null:e.appData.status)&&1==e.checkAccess(e.appData)),t.xp6(1),t.Q6J("ngIf",(null==e.currentUser?null:e.currentUser.id)==(null==e.appData?null:e.appData.createdBy)||1==e.userRoleCheck||e.checkIfUserisAdmin(null==e.appData?null:e.appData.adminUsers)),t.xp6(1),t.Q6J("ngIf",(null==e.currentUser?null:e.currentUser.id)==(null==e.appData?null:e.appData.createdBy)||1==e.userRoleCheck&&0==e.checkIfUserisViewOnly(null==e.appData?null:e.appData.viewOnlyUsers)||e.checkIfUserisAdmin(null==e.appData?null:e.appData.adminUsers)),t.xp6(2),t.Q6J("tuiHintAppearance","success")("tuiHint",o),t.xp6(1),t.Q6J("value",null==e.appData||null==e.appData.stats?null:e.appData.stats.completedCount),t.xp6(2),t.Q6J("tuiHint",r),t.xp6(1),t.Q6J("value",null==e.appData||null==e.appData.stats?null:e.appData.stats.inProgressCount)}}function ft(i,n){if(1&i&&(t.TgZ(0,"strong",29),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("Completed Submissions: \xa0 ",(null==e.appData||null==e.appData.stats?null:e.appData.stats.completedCount)||0,"")}}function Ct(i,n){if(1&i&&(t.TgZ(0,"strong",29),t._uU(1),t.qZA()),2&i){const e=t.oxw();t.xp6(1),t.hij("In Progress Submissions: \xa0 ",(null==e.appData||null==e.appData.stats?null:e.appData.stats.inProgressCount)||0,"")}}class D{constructor(n,e){this.transport=n,this.auth=e,this.deleteModule=new t.vpe,this.editModule=new t.vpe,this.currentUser=this.auth.currentUserValue,this.userRoleCheck=this.auth.checkIfRolesExist("sysAdmin")}checkAccess(n){return!(0==this.userRoleCheck&&"disabled"==n?.accessType&&!n.authorizedUsers.includes(this.currentUser.id))}storeModuleID(n,e){this.transport.moduleID.next(n),(0,m.LS)(m.MX.moduleSlug,e)}deleteModuleEvent(n){this.deleteModule.emit(n)}editModuleEvent(n,e,o){(0,m.LS)(m.MX.moduleSlug,e),(0,m.LS)(m.MX.editmoduleTitle,o),(0,m.LS)(m.MX.editmoduleId,n),this.editModule.emit(n),this.transport.moduleID.next(n)}checkIfUserisAdmin(n){return n?.includes(this.currentUser?.id)}checkIfUserisViewOnly(n){return n?.includes(this.currentUser?.id)}}function bt(i,n){1&i&&(t.ynx(0),t.TgZ(1,"div",5),t._UZ(2,"tui-loader",6),t.TgZ(3,"p",7),t._uU(4,"Loading..."),t.qZA()(),t.BQk()),2&i&&(t.xp6(2),t.Q6J("showLoader",!0)("overlay",!0))}function Tt(i,n){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"p",11),t._uU(2," Create a category to start adding new apps "),t._UZ(3,"br")(4,"br"),t.TgZ(5,"a",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(2),s=t.MAs(10);return t.KtG(r.showAddDialog(s))}),t._uU(6,"+ Add Category"),t.qZA()(),t.BQk()}}D.\u0275fac=function(n){return new(n||D)(t.Y36(v.R),t.Y36(b.e))},D.\u0275cmp=t.Xpm({type:D,selectors:[["grid-top-app"]],inputs:{appData:"appData"},outputs:{deleteModule:"deleteModule",editModule:"editModule"},standalone:!0,features:[t.jDz],decls:5,vars:1,consts:[["class","bg-white rounded-md shadow-md h-auto drop-shadow-md flex flex-col border-t-4 border-t-[#F15B41] cursor-pointer",4,"ngIf"],["hint",""],["hint2",""],[1,"bg-white","rounded-md","shadow-md","h-auto","drop-shadow-md","flex","flex-col","border-t-4","border-t-[#F15B41]","cursor-pointer"],[1,"flex","pt-5","space-x-8","px-4","pb-3",3,"routerLink","queryParams","click"],[1,"flex","items-center","justify-center","border","border-gray-200","rounded-lg","w-[13rem]","h-[8rem]"],["alt","top_app_icon","loading","eager",1,"object-contain","w-full","h-full","rounded-lg",3,"src"],[1,"w-full","h-full"],[1,"mb-2","text-lg","font-semibold","line-clamp-2"],[4,"ngIf"],[1,"leading-6","line-clamp-2"],[1,"bg-gradient-to-r","from-orange-200","to-slate-200","h-8","w-full","flex","justify-center","items-center","rounded-br-md","rounded-bl-md","py-5","px-3"],["title","Apps and Submissions","class","px-2 py-1 text-white bg-green-600 rounded-md hover:text-white hover:bg-opacity-80 hover:transition-colors",3,"routerLink","queryParams","click",4,"ngIf"],["title","Edit","class","px-2 py-1 mx-2 text-white bg-blue-500 rounded-md hover:text-white cursor-pointer hover:bg-opacity-80 hover:transition-colors",3,"routerLink","queryParams","click",4,"ngIf"],["title","Delete","class","px-2 py-1 text-white bg-red-600 rounded-md hover:text-white cursor-pointer hover:bg-opacity-80 hover:transition-colors",3,"click",4,"ngIf"],[1,"ml-auto"],["tuiHintDirection","top",1,"px-2","py-1","text-white","bg-green-500","rounded-md","cursor-pointer","hover:text-white","mr-2","relative",3,"tuiHintAppearance","tuiHint"],["status","custom","size","s",1,"absolute","-top-2","-right-2","bg-green-500",3,"value"],["aria-hidden","true",1,"fa","fa-check-circle","fa-lg"],["tuiHintDirection","top",1,"px-2","py-1","text-white","bg-gray-500","rounded-md","cursor-pointer","hover:text-white","relative",3,"tuiHint"],["status","custom","size","s",1,"absolute","-top-2","-right-2","bg-gray-500",3,"value"],["aria-hidden","true",1,"fa","fa-clock-o","fa-lg"],["status","primary","value","Draft","size","s",1,"tui-space_left-1"],["title","Apps and Submissions",1,"px-2","py-1","text-white","bg-green-600","rounded-md","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"routerLink","queryParams","click"],["aria-hidden","true",1,"fa","fa-sitemap","fa-lg"],["title","Edit",1,"px-2","py-1","mx-2","text-white","bg-blue-500","rounded-md","hover:text-white","cursor-pointer","hover:bg-opacity-80","hover:transition-colors",3,"routerLink","queryParams","click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg"],["title","Delete",1,"px-2","py-1","text-white","bg-red-600","rounded-md","hover:text-white","cursor-pointer","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-trash","fa-lg"],[1,"text-base"]],template:function(n,e){1&n&&(t.YNc(0,ht,21,18,"div",0),t.YNc(1,ft,2,1,"ng-template",null,1,t.W1O),t.YNc(3,Ct,2,1,"ng-template",null,2,t.W1O)),2&n&&t.Q6J("ngIf",3!==(null==e.appData?null:e.appData.status)&&1==e.checkAccess(e.appData))},dependencies:[p.ez,p.O5,g.Bz,g.rH,L.f,L.g,y.go,y.D,y.xn,y.t6,y.DM],changeDetection:0});const xt=function(i){return["/modules/add-module",i]},yt=function(i){return{parentID:i}};function vt(i,n){if(1&i&&(t.TgZ(0,"a",17),t._uU(1,"+ Add new app"),t.qZA()),2&i){const e=t.oxw().$implicit;t.Q6J("routerLink",t.VKq(2,xt,e._id))("queryParams",t.VKq(4,yt,(null==e?null:e._id)||""))}}function Dt(i,n){1&i&&(t.ynx(0),t._UZ(1,"div",18),t.BQk())}function wt(i,n){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"grid-top-app",19),t.NdJ("deleteModule",function(r){t.CHM(e);const s=t.oxw(5),u=t.MAs(8);return t.KtG(s.showDialog(r,u))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw().$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("appData",e)("ngClass",null!=e&&e.layout&&null!=e&&null!=e.layout&&e.layout.colWidth?"col-span-"+o.toString(null==e||null==e.layout?null:e.layout.colWidth):"col-span-4")}}function It(i,n){if(1&i){const e=t.EpF();t.ynx(0),t.TgZ(1,"grid-top-app",19),t.NdJ("deleteModule",function(r){t.CHM(e);const s=t.oxw(6),u=t.MAs(8);return t.KtG(s.showDialog(r,u))}),t.qZA(),t.BQk()}if(2&i){const e=t.oxw(2).$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("appData",e)("ngClass",null!=e&&e.layout&&null!=e&&null!=e.layout&&e.layout.colWidth?"col-span-"+o.toString(null==e||null==e.layout?null:e.layout.colWidth):"col-span-4")}}function At(i,n){if(1&i&&(t.ynx(0),t.YNc(1,It,2,2,"ng-container",9),t.BQk()),2&i){const e=t.oxw().$implicit,o=t.oxw(4);t.xp6(1),t.Q6J("ngIf",(null==o.currentUser?null:o.currentUser.id)==(null==e?null:e.createdBy))}}function Et(i,n){if(1&i&&(t.ynx(0),t.YNc(1,wt,2,2,"ng-container",9),t.YNc(2,At,2,1,"ng-container",9),t.BQk()),2&i){const e=n.$implicit;t.xp6(1),t.Q6J("ngIf",3!==(null==e?null:e.status)),t.xp6(1),t.Q6J("ngIf",3==(null==e?null:e.status))}}function kt(i,n){if(1&i&&t.YNc(0,Et,3,2,"ng-container",10),2&i){const e=t.oxw().$implicit;t.Q6J("ngForOf",null==e?null:e.submodules)}}function Zt(i,n){if(1&i&&(t.ynx(0),t.TgZ(1,"div",13)(2,"p",14),t._uU(3),t.qZA(),t.YNc(4,vt,2,6,"a",15),t.qZA(),t.YNc(5,Dt,2,0,"ng-container",1),t.YNc(6,kt,1,1,"ng-template",null,16,t.W1O),t.BQk()),2&i){const e=n.$implicit,o=t.MAs(7),r=t.oxw(2);t.xp6(3),t.Oqu(e.name),t.xp6(1),t.Q6J("ngIf",1==r.userRoleCheck),t.xp6(1),t.Q6J("ngIf",!e.submodules||0==(null==e.subsubmodules?null:e.subsubmodules.length))("ngIfElse",o)}}function Ut(i,n){if(1&i&&(t.TgZ(0,"section",8),t.YNc(1,Tt,7,0,"ng-container",9),t.ALo(2,"async"),t.YNc(3,Zt,8,4,"ng-container",10),t.ALo(4,"async"),t.qZA()),2&i){const e=t.oxw();let o;t.xp6(1),t.Q6J("ngIf",0==(null==(o=t.lcZ(2,2,e.dashboardApps))?null:o.length)),t.xp6(2),t.Q6J("ngForOf",t.lcZ(4,4,e.dashboardApps))}}function Ot(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",20),t._uU(1,"Delete App"),t.qZA(),t.TgZ(2,"p",21),t._uU(3,"Are you sure you want to delete this app?"),t.qZA(),t.TgZ(4,"div",22)(5,"button",23),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().deleteModule(),t.KtG(s.complete())}),t._uU(6," Confirm "),t.qZA(),t.TgZ(7,"button",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.complete())}),t._uU(8," Cancel "),t.qZA()()}}function Mt(i,n){1&i&&(t.TgZ(0,"span",31),t._uU(1,"Category name is required"),t.qZA())}function Nt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",25),t._uU(1," Add Category "),t.qZA(),t.TgZ(2,"div",26),t._UZ(3,"input",27),t.YNc(4,Mt,2,0,"span",28),t.qZA(),t.TgZ(5,"div",29)(6,"button",30),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().addCategory(),t.KtG(s.complete())}),t._uU(7," Add "),t.qZA(),t.TgZ(8,"button",24),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),t.KtG(u.formData.reset())}),t._uU(9," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(3),t.Q6J("ngClass",null!=e.formData&&e.formData.invalid&&null!=e.formData&&e.formData.touched?"is-invalid":"")("formControl",e.formData),t.xp6(1),t.Q6J("ngIf",(null==e.formData?null:e.formData.invalid)&&(null==e.formData?null:e.formData.touched)),t.xp6(2),t.Q6J("disabled",null==e.formData?null:e.formData.invalid)}}class k{constructor(n,e,o){this.dashboard=n,this.dialogs=e,this.auth=o,this.subscription=[],this.formData=new a.NI(null,a.kI.compose([a.kI.required])),this.currentUser=this.auth.currentUserValue,this.userRoleCheck=this.auth.checkIfRolesExist("admin"),this.dashboardApps=this.dashboard.getDashboardApps()}showAddDialog(n){this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()}toString(n){return String(n)}addCategory(){this.subscription.push(this.dashboard.addCategory({name:this.formData.value}).subscribe(e=>{e&&(this.dashboardApps=this.dashboard.getDashboardApps())}))}showDialog(n,e){n&&(this.moduleId=n,this.dialogs.open(e).subscribe())}deleteModule(){this.subscription.push(this.dashboard.deleteSubModule(this.moduleId).subscribe(n=>{this.dashboardApps=this.dashboard.getDashboardApps()}))}ngOnDestroy(){this.subscription.forEach(n=>n.unsubscribe())}}k.\u0275fac=function(n){return new(n||k)(t.Y36(h.s),t.Y36(f.RO),t.Y36(b.e))},k.\u0275cmp=t.Xpm({type:k,selectors:[["ng-component"]],decls:11,vars:4,consts:[[1,"bg_img_main"],[4,"ngIf","ngIfElse"],["dashboardapps",""],["template",""],["addTemplate",""],[1,"mt-72"],["size","xl",3,"showLoader","overlay"],[1,"font-semibold","text-center"],[1,"grid","w-11/12","grid-cols-12","md:grid-cols-8","lg:grid-cols-12","gap-4","pb-20","mx-auto","md:mt-52","mt-40"],[4,"ngIf"],[4,"ngFor","ngForOf"],[1,"col-span-12","my-8","text-base","font-semibold","text-center"],[1,"px-2","py-1","bg-[#A58F81]","text-white","text-sm","rounded-md","cursor-pointer","hover:text-white",3,"click"],[1,"flex","justify-between","py-2","px-2","bg-[#eae4d8]","rounded-md","col-span-12","relative"],[1,"mt-2","text-lg","font-semibold"],["class","px-4 py-2 rounded-md bg-[#F15B41] text-white no-underline hover:text-white text-base hover:bg-opacity-80 hover:transition-colors",3,"routerLink","queryParams",4,"ngIf"],["showApps",""],[1,"px-4","py-2","rounded-md","bg-[#F15B41]","text-white","no-underline","hover:text-white","text-base","hover:bg-opacity-80","hover:transition-colors",3,"routerLink","queryParams"],[1,"h-5"],[3,"appData","ngClass","deleteModule"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","primary","type","button","size","m",1,"mx-3",3,"click"],["tuiButton","","type","button","appearance","accent","size","m",3,"click"],[1,"text-lg","font-semibold","text-center"],[1,"flex","flex-col","justify-center","my-5"],["type","text",1,"my-2","form-control",3,"ngClass","formControl"],["class","text-xs text-red-500",4,"ngIf"],[1,"flex","justify-center","gap-2"],["tuiButton","","type","button","size","m",3,"disabled","click"],[1,"text-xs","text-red-500"]],template:function(n,e){if(1&n&&(t._UZ(0,"app-header"),t.TgZ(1,"div",0),t.YNc(2,bt,5,2,"ng-container",1),t.ALo(3,"async"),t.YNc(4,Ut,5,6,"ng-template",null,2,t.W1O),t.qZA(),t._UZ(6,"app-footer"),t.YNc(7,Ot,9,0,"ng-template",null,3,t.W1O),t.YNc(9,Nt,10,4,"ng-template",null,4,t.W1O)),2&n){const o=t.MAs(5);t.xp6(2),t.Q6J("ngIf",!t.lcZ(3,2,e.dashboardApps))("ngIfElse",o)}},dependencies:[p.mk,p.sg,p.O5,g.rH,T.G,d.v0,x.c,a.Fj,a.JJ,a.oH,Y.kM,D,p.Ov]});var J=l(89570);class Z{constructor(n,e,o,r){this.dialog=n,this.transportService=e,this.dashboard=o,this.context=r}showDialog(n){this.dialog.open(n).subscribe()}cancel(){this.dashboard.moduleEditData.next(null),(0,m.cl)(m.MX.publishAppValue),(0,m.cl)(m.MX.activeIndex),this.transportService.dialogState.emit(v.U.DISCARD),this.context.completeWith(!0)}saveDraft(){}stayOnPage(){this.context.completeWith(!0),this.transportService.dialogState.emit(v.U.DEFAULT)}}Z.\u0275fac=function(n){return new(n||Z)(t.Y36(f.RO),t.Y36(v.R),t.Y36(h.s),t.Y36(J.yf))},Z.\u0275cmp=t.Xpm({type:Z,selectors:[["app-module-guard"]],decls:9,vars:0,consts:[[1,"flex","justify-center","flex-col","items-center"],["aria-hidden","true",1,"fa","fa-exclamation-circle","fa-5x","text-yellow-500"],[1,"font-semibold","text-base","my-5"],[1,"flex","justify-between","gap-2"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],["tuiButton","","type","button","size","m","appearance","secondary",3,"click"]],template:function(n,e){1&n&&(t.TgZ(0,"div",0),t._UZ(1,"i",1),t.TgZ(2,"p",2),t._uU(3,"All your unsaved data will be lost. Are you sure you want to proceed?"),t.qZA(),t.TgZ(4,"div",3)(5,"button",4),t.NdJ("click",function(){return e.cancel()}),t._uU(6,"Proceed"),t.qZA(),t.TgZ(7,"button",5),t.NdJ("click",function(){return e.stayOnPage()}),t._uU(8,"Stay on this page"),t.qZA()()())},dependencies:[d.v0],changeDetection:0});class w{constructor(n,e,o,r){this.dialog=n,this.dashboard=e,this.transportService=o,this.router=r}canActivate(n,e){return null===this.dashboard.moduleEditData.value&&!(0,m.rV)(m.MX.publishAppValue)||(this.dialog.open(new J.Al(Z),{dismissible:!0,closeable:!0}).subscribe(),this.transportService.dialogState.subscribe(r=>r===v.U.DISCARD&&(this.router.navigate([e.url]),!0)),!1)}}w.\u0275fac=function(n){return new(n||w)(t.LFG(f.RO),t.LFG(h.s),t.LFG(v.R),t.LFG(g.F0))},w.\u0275prov=t.Yz7({token:w,factory:w.\u0275fac,providedIn:"root"});var _=l(38023),Q=l(54121),c=l(13528),C=l(17820);function Pt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"div",3)(1,"a",4),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),s=t.MAs(5);return t.KtG(r.showAddOrEditDialog(s,null==r.cellValue?null:r.cellValue.data))}),t._UZ(2,"i",5),t.qZA(),t.TgZ(3,"button",6),t.NdJ("click",function(){t.CHM(e);const r=t.oxw(),s=t.MAs(3);return t.KtG(r.showDeleteDialog(null==r.cellValue?null:r.cellValue.data,s))}),t._UZ(4,"i",7),t.qZA()()}}function Rt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",8),t._uU(1,"Delete Category"),t.qZA(),t.TgZ(2,"p",9),t._uU(3,"Are you sure you want to delete this category?"),t.qZA(),t.TgZ(4,"div",10)(5,"button",11),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().deleteCategory(),t.KtG(s.complete())}),t._uU(6," Confirm "),t.qZA(),t.TgZ(7,"button",12),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.complete())}),t._uU(8," Cancel "),t.qZA()()}}function Ft(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," Category is required "),t.qZA())}function St(i,n){1&i&&(t.TgZ(0,"span",22),t._uU(1," A category with this name already exists. Please provide a different name. "),t.qZA())}function qt(i,n){if(1&i&&(t.TgZ(0,"div",17)(1,"label",18),t._uU(2,"Category Name"),t.TgZ(3,"sup",19),t._uU(4,"*"),t.qZA()(),t._UZ(5,"input",20),t.YNc(6,Ft,2,0,"span",21),t.YNc(7,St,2,0,"span",21),t.qZA()),2&i){const e=t.oxw(2);t.xp6(5),t.Q6J("formControl",e.categoryControlEdit),t.xp6(1),t.Q6J("ngIf",(null==e.categoryControlEdit?null:e.categoryControlEdit.hasError("required"))&&(null==e.categoryControlEdit?null:e.categoryControlEdit.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.categoryControlEdit?null:e.categoryControlEdit.hasError("codeExists"))}}function Vt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",13),t._uU(1),t.qZA(),t.YNc(2,qt,8,3,"div",14),t.TgZ(3,"div",15)(4,"button",12),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editOrAddCategory())}),t._uU(5),t.qZA(),t.TgZ(6,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),t.KtG(u.categoryId=null)}),t._uU(7," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.categoryId?"Update":"Add"," Category "),t.xp6(1),t.Q6J("ngIf",e.categoryId),t.xp6(3),t.hij(" ",e.categoryId?"Update":"Add"," ")}}class U{constructor(n,e,o){this.dialogs=n,this.dashboard=e,this.auth=o,this.sendingDecision=new _.x,this.destroy$=new _.x,this.saveDialogSubscription=[],this.categoryId=null,this.userEditFormCustom=new a.cw({fullName:new a.NI(null,a.kI.compose([a.kI.required])),email:new a.NI(null,a.kI.compose([a.kI.required,a.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$")]),[C.Iw.createValidator(this.dashboard,"user",void 0,void 0)]),role:new a.NI(null,a.kI.compose([a.kI.required])),password:new a.NI(null,a.kI.compose([a.kI.minLength(8),a.kI.pattern("^(?=.*[0-9])(?=.*[a-zA-Z]).*$")]))}),this.categoryControlEdit=new a.NI("",a.kI.compose([a.kI.required]),[C.Iw.createValidator(this.dashboard,"category",void 0,void 0)]),this.userRoleCheckAdmin=this.auth.checkIfRolesExist("admin")}get fE(){return this.userEditFormCustom.controls}checkRoles(n){return n?.includes("sysAdmin")}agInit(n){this.cellValue=n}refresh(n){return this.cellValue=n,!0}showAddOrEditDialog(n,e){this.categoryControlEdit.reset(),this.saveDialogSubscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),e?.id?(this.categoryId=e?.id,this.dashboard.excludeIdEmitter.emit(e?.id),this.categoryControlEdit.setValue(e?.name)):this.categoryId=null}showDeleteDialog(n,e){this.dialogs.open(e,{dismissible:!1,closeable:!1}).subscribe(),this.categoryId=n?.id}editOrAddCategory(){if(this.categoryId){if(this.categoryControlEdit.invalid)return void this.categoryControlEdit.markAsDirty();this.dashboard.editCategory({name:this.categoryControlEdit.value},this.categoryId).pipe((0,c.R)(this.destroy$)).subscribe(e=>{e&&(this.categoryId=null,this.dashboard.actionComplete.emit(!0),this.saveDialogSubscription.forEach(o=>o.unsubscribe()),this.categoryControlEdit.reset())})}}deleteCategory(){this.dashboard.deleteCategory(this.categoryId).pipe((0,c.R)(this.destroy$)).subscribe(()=>{this.categoryId=null,this.dashboard.actionComplete.emit(!0)})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe(),this.saveDialogSubscription.forEach(n=>n.unsubscribe())}}U.\u0275fac=function(n){return new(n||U)(t.Y36(f.RO),t.Y36(h.s),t.Y36(b.e))},U.\u0275cmp=t.Xpm({type:U,selectors:[["catgeories-actions-component"]],standalone:!0,features:[t.jDz],decls:6,vars:1,consts:[["class","flex justify-start gap-x-2 mt-2",4,"ngIf"],["deltemplate",""],["addTemplate",""],[1,"flex","justify-start","gap-x-2","mt-2"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-blue-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-red-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-trash","fa-lg"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"],["tuiButton","","type","button","size","m",3,"click"],[1,"text-lg","font-semibold","text-center"],["class","flex flex-col justify-center my-5",4,"ngIf"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"flex","flex-col","justify-center","my-5"],["for","Textarea2",1,"block"],[1,"text-red-500"],[1,"mb-1","form-control",3,"formControl"],["class","text-xs text-red-500",4,"ngIf"],[1,"text-xs","text-red-500"]],template:function(n,e){1&n&&(t.ynx(0),t.YNc(1,Pt,5,0,"div",0),t.YNc(2,Rt,9,0,"ng-template",null,1,t.W1O),t.YNc(4,Vt,8,3,"ng-template",null,2,t.W1O),t.BQk()),2&n&&(t.xp6(1),t.Q6J("ngIf",(null==e.cellValue||null==e.cellValue.data?null:e.cellValue.data.createdBy)===(null==e.currentUser?null:e.currentUser.id)||1==e.userRoleCheckAdmin))},dependencies:[p.ez,p.O5,g.Bz,a.UX,a.Fj,a.JJ,a.oH,d.fN,d.v0,a.u5],encapsulation:2});var B=l(35554);function zt(i,n){1&i&&(t.TgZ(0,"span",18),t._uU(1," Category is required "),t.qZA())}function Jt(i,n){1&i&&(t.TgZ(0,"span",18),t._uU(1," A category with this name already exists. Please provide a different name. "),t.qZA())}function Bt(i,n){if(1&i&&(t.TgZ(0,"div",13)(1,"label",14),t._uU(2,"Category Name"),t.TgZ(3,"sup",15),t._uU(4,"*"),t.qZA()(),t._UZ(5,"input",16),t.YNc(6,zt,2,0,"span",17),t.YNc(7,Jt,2,0,"span",17),t.qZA()),2&i){const e=t.oxw(2);t.xp6(5),t.Q6J("formControl",e.categoryControl),t.xp6(1),t.Q6J("ngIf",(null==e.categoryControl?null:e.categoryControl.hasError("required"))&&(null==e.categoryControl?null:e.categoryControl.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.categoryControl?null:e.categoryControl.hasError("codeExists"))}}function $t(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",8),t._uU(1),t.qZA(),t.YNc(2,Bt,8,3,"div",9),t.TgZ(3,"div",10)(4,"button",11),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editOrAddCategory())}),t._uU(5),t.qZA(),t.TgZ(6,"button",12),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),t.KtG(u.categoryId=null)}),t._uU(7," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(1),t.hij(" ",e.categoryId?"Update":"Add"," Category "),t.xp6(1),t.Q6J("ngIf",!e.categoryId),t.xp6(3),t.hij(" ",e.categoryId?"Update":"Add"," ")}}class O{constructor(n,e,o,r){this.dashboard=n,this.dialogs=e,this.cf=o,this.auth=r,this.categoryEditControl=new a.NI(""),this.categoryId=null,this.destroy$=new _.x,this.limit=2e3,this.page=0,this.formData=new Q.X({isValid:!1}),this.subscription=[],this.columnDefs=[{field:"name",headerName:"Category Name",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"actions",headerName:"Actions",cellRenderer:U,width:30}],this.rowData=[],this.categoryControl=new a.NI("",a.kI.compose([a.kI.required]),[C.Iw.createValidator(this.dashboard,"category")]),this.currentUser=this.auth.currentUserValue,this.userRoleCheckAdmin=this.auth.checkIfRolesExist("admin"),this.dashboard.getAllCategories(this.limit).pipe((0,c.R)(this.destroy$)).subscribe(s=>{this.rowData=s.results,this.cf.detectChanges()}),this.dashboard.actionComplete.pipe((0,c.R)(this.destroy$)).subscribe(s=>{1==s&&this.dashboard.getAllCategories(this.limit).pipe((0,c.R)(this.destroy$)).subscribe(u=>{this.rowData=u.results,this.cf.detectChanges()})})}onGridReady(n){n.api.sizeColumnsToFit()}showAddOrEditDialog(n,e){this.categoryControl.reset(),this.subscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),e?.id?(this.categoryId=e?.id,this.dashboard.excludeIdEmitter.emit(e?.id)):this.categoryId=null}editOrAddCategory(){this.categoryControl.invalid?this.categoryControl.markAsDirty():this.dashboard.addCategory({name:this.categoryControl.value}).pipe((0,c.R)(this.destroy$)).subscribe(e=>{e&&(this.dashboard.getAllCategories(this.limit).pipe((0,c.R)(this.destroy$)).subscribe(o=>{this.rowData=o.results,this.cf.detectChanges()}),this.cf.detectChanges(),this.subscription.forEach(o=>o.unsubscribe()),this.categoryControl.reset())})}showStatus(n){return 1==n?"Published":2==n?"Deleted":"Draft"}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}function Qt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Full name is required "),t.qZA())}function Ht(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Email is required "),t.qZA())}function jt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Please provide a valid email address "),t.qZA())}function Gt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," A user with this email already exists. Please provide a different email. "),t.qZA())}function Yt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Please specify user role "),t.qZA())}function Lt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Password is required "),t.qZA())}function Kt(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Password should be at least 8 characters long "),t.qZA())}function Xt(i,n){1&i&&(t.TgZ(0,"p",23),t._uU(1," Password should have at least one number and one character "),t.qZA())}function Wt(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",7),t._uU(1," Update User "),t.qZA(),t.TgZ(2,"div",8)(3,"div",9)(4,"label",10),t._uU(5,"Full Name"),t.TgZ(6,"sup",11),t._uU(7,"*"),t.qZA()(),t._UZ(8,"input",12),t.YNc(9,Qt,2,0,"span",13),t.qZA(),t.TgZ(10,"div",14)(11,"label",10),t._uU(12,"Email"),t.TgZ(13,"sup",11),t._uU(14,"*"),t.qZA()(),t._UZ(15,"input",15),t.YNc(16,Ht,2,0,"span",13),t.YNc(17,jt,2,0,"span",13),t.YNc(18,Gt,2,0,"span",13),t.qZA(),t.TgZ(19,"div",14)(20,"label",10),t._uU(21,"Role"),t.TgZ(22,"sup",11),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"select",16)(25,"option",17),t._uU(26,"Admin"),t.qZA(),t.TgZ(27,"option",18),t._uU(28,"User"),t.qZA()(),t.YNc(29,Yt,2,0,"span",13),t.qZA(),t.TgZ(30,"div",14)(31,"label",10),t._uU(32,"Password"),t.qZA(),t._UZ(33,"input",19),t.YNc(34,Lt,2,0,"span",13),t.YNc(35,Kt,2,0,"span",13),t.YNc(36,Xt,2,0,"p",13),t.qZA()(),t.TgZ(37,"div",20)(38,"button",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editOrAddUser())}),t._uU(39," Update "),t.qZA(),t.TgZ(40,"button",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),t.KtG(u.userId=null)}),t._uU(41," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.userEditFormCustom),t.xp6(7),t.Q6J("ngIf",(null==e.fE.fullName?null:e.fE.fullName.hasError("required"))&&(null==e.fE.fullName?null:e.fE.fullName.dirty)),t.xp6(7),t.Q6J("ngIf",(null==e.fE.email?null:e.fE.email.hasError("required"))&&(null==e.fE.email?null:e.fE.email.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.fE.email?null:e.fE.email.hasError("pattern"))&&(null==e.fE.email?null:e.fE.email.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.fE.email?null:e.fE.email.hasError("codeExists")),t.xp6(11),t.Q6J("ngIf",(null==e.fE.role?null:e.fE.role.hasError("required"))&&(null==e.fE.role?null:e.fE.role.dirty)),t.xp6(5),t.Q6J("ngIf",(null==e.fE.password?null:e.fE.password.hasError("required"))&&(null==e.fE.password?null:e.fE.password.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.fE.password?null:e.fE.password.hasError("minlength"))&&(null==e.fE.password?null:e.fE.password.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.fE.password?null:e.fE.password.hasError("pattern"))&&(null==e.fE.password?null:e.fE.password.dirty))}}function te(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",24),t._uU(1,"Delete User"),t.qZA(),t.TgZ(2,"p",25),t._uU(3,"Are you sure you want to delete this user ?"),t.qZA(),t.TgZ(4,"div",26)(5,"button",27),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().deleteUser(),t.KtG(s.complete())}),t._uU(6," Confirm "),t.qZA(),t.TgZ(7,"button",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.complete())}),t._uU(8," Cancel "),t.qZA()()}}O.\u0275fac=function(n){return new(n||O)(t.Y36(h.s),t.Y36(f.RO),t.Y36(t.sBO),t.Y36(b.e))},O.\u0275cmp=t.Xpm({type:O,selectors:[["ng-component"]],decls:12,vars:5,consts:[[1,"bg_img_main"],[1,"w-11/12","mx-auto","mt-52","pb-60"],[1,"flex","justify-end","mb-5"],[1,"cursor-pointer"],[1,"px-4","py-2","rounded-lg","bg-[#a58f81]","text-white","no-underline","hover:text-white","text-sm",3,"click"],[1,"flex","flex-col"],[1,"w-full","h-full","overflow-hidden","ag-theme-alpine",3,"rowData","columnDefs","pagination","paginationPageSize","suppressMenuHide","gridReady"],["addTemplate",""],[1,"text-lg","font-semibold","text-center"],["class","flex flex-col justify-center my-5",4,"ngIf"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"flex","flex-col","justify-center","my-5"],["for","Textarea2",1,"block"],[1,"text-red-500"],[1,"mb-1","form-control",3,"formControl"],["class","text-xs text-red-500",4,"ngIf"],[1,"text-xs","text-red-500"]],template:function(n,e){if(1&n){const o=t.EpF();t._UZ(0,"app-header"),t.TgZ(1,"div",0)(2,"section",1)(3,"div",2)(4,"div",3)(5,"a",4),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(11);return t.KtG(e.showAddOrEditDialog(s,null))}),t._uU(6,"+ Add category"),t.qZA()()(),t.TgZ(7,"div",5)(8,"ag-grid-angular",6),t.NdJ("gridReady",function(s){return e.onGridReady(s)}),t.qZA()()()(),t._UZ(9,"app-footer"),t.YNc(10,$t,8,3,"ng-template",null,7,t.W1O)}2&n&&(t.xp6(8),t.Q6J("rowData",e.rowData)("columnDefs",e.columnDefs)("pagination",!0)("paginationPageSize",10)("suppressMenuHide",!0))},dependencies:[p.O5,T.G,d.v0,x.c,a.Fj,a.JJ,a.oH,B.N8],changeDetection:0});class M{constructor(n,e){this.dialogs=n,this.dashboard=e,this.sendingDecision=new _.x,this.destroy$=new _.x,this.saveDialogSubscription=[],this.userId=null,this.userEditFormCustom=new a.cw({fullName:new a.NI(null,a.kI.compose([a.kI.required])),email:new a.NI(null,a.kI.compose([a.kI.required,a.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$")]),[C.Iw.createValidator(this.dashboard,"user",void 0,void 0)]),role:new a.NI(null,a.kI.compose([a.kI.required])),password:new a.NI(null,a.kI.compose([a.kI.minLength(8),a.kI.pattern("^(?=.*[0-9])(?=.*[a-zA-Z]).*$")]))})}get fE(){return this.userEditFormCustom.controls}checkRoles(n){return n?.includes("sysAdmin")}agInit(n){this.cellValue=n}refresh(n){return this.cellValue=n,!0}showDialog(n,e){this.saveDialogSubscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),this.userId=e?.id||null,this.dashboard.excludeIdEmitter.emit(e?.id?e?.id:null),this.userEditFormCustom?.controls.fullName?.setValue(e?.fullName),this.userEditFormCustom?.controls.email?.setValue(e?.email),this.userEditFormCustom?.controls.role?.setValue(e?.roles[0]),this.userEditFormCustom?.controls.password?.setValue(e?.password)}showDeleteDialog(n,e){this.dialogs.open(e,{dismissible:!1,closeable:!1}).subscribe(),this.userId=n?.id}editOrAddUser(){if(this.userId){if(this.fE.email?.invalid||this.fE.fullName?.invalid||this.fE.role?.invalid)return this.fE.email?.markAsDirty(),this.fE.fullName?.markAsDirty(),void this.fE.role?.markAsDirty();if(this.fE.password?.value&&this.fE.password?.invalid)return this.fE.email?.markAsDirty(),this.fE.fullName?.markAsDirty(),this.fE.role?.markAsDirty(),void this.fE.password?.markAsDirty();this.dashboard.updateUser(this.userId,{roles:[this.userEditFormCustom?.value?.role],fullName:this.userEditFormCustom?.value?.fullName,email:this.userEditFormCustom?.value?.email,password:this.userEditFormCustom?.value?.password||void 0}).pipe((0,c.R)(this.destroy$)).subscribe(e=>{e&&(this.dashboard.actionComplete.emit(!0),this.userId=null,this.saveDialogSubscription.forEach(o=>o.unsubscribe()),this.userEditFormCustom.reset())})}}deleteUser(){this.dashboard.deleteUser(this.userId).pipe((0,c.R)(this.destroy$)).subscribe(()=>{this.userId=null,this.dashboard.actionComplete.emit(!0)})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe(),this.saveDialogSubscription.forEach(n=>n.unsubscribe())}}function ee(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Full name is required "),t.qZA())}function ne(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Email is required "),t.qZA())}function ie(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Please provide a valid email address "),t.qZA())}function oe(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," A user with this email already exists. Please provide a different email. "),t.qZA())}function re(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Please specify user role "),t.qZA())}function ae(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Password is required "),t.qZA())}function se(i,n){1&i&&(t.TgZ(0,"span",23),t._uU(1," Password should be at least 8 characters long "),t.qZA())}function le(i,n){1&i&&(t.TgZ(0,"p",23),t._uU(1," Password should have at least one number and one character "),t.qZA())}function ue(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",7),t._uU(1," Add User "),t.qZA(),t.TgZ(2,"div",8)(3,"div",9)(4,"label",10),t._uU(5,"Full Name"),t.TgZ(6,"sup",11),t._uU(7,"*"),t.qZA()(),t._UZ(8,"input",12),t.YNc(9,ee,2,0,"span",13),t.qZA(),t.TgZ(10,"div",14)(11,"label",10),t._uU(12,"Email"),t.TgZ(13,"sup",11),t._uU(14,"*"),t.qZA()(),t._UZ(15,"input",15),t.YNc(16,ne,2,0,"span",13),t.YNc(17,ie,2,0,"span",13),t.YNc(18,oe,2,0,"span",13),t.qZA(),t.TgZ(19,"div",14)(20,"label",10),t._uU(21,"Role"),t.TgZ(22,"sup",11),t._uU(23,"*"),t.qZA()(),t.TgZ(24,"select",16)(25,"option",17),t._uU(26,"Admin"),t.qZA(),t.TgZ(27,"option",18),t._uU(28,"User"),t.qZA()(),t.YNc(29,re,2,0,"span",13),t.qZA(),t.TgZ(30,"div",14)(31,"label",10),t._uU(32,"Password"),t.qZA(),t._UZ(33,"input",19),t.YNc(34,ae,2,0,"span",13),t.YNc(35,se,2,0,"span",13),t.YNc(36,le,2,0,"p",13),t.qZA()(),t.TgZ(37,"div",20)(38,"button",21),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.addUser())}),t._uU(39," Add "),t.qZA(),t.TgZ(40,"button",22),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.complete())}),t._uU(41," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(2),t.Q6J("formGroup",e.userAddFormCustom),t.xp6(7),t.Q6J("ngIf",(null==e.f.fullName?null:e.f.fullName.hasError("required"))&&(null==e.f.fullName?null:e.f.fullName.dirty)),t.xp6(7),t.Q6J("ngIf",(null==e.f.email?null:e.f.email.hasError("required"))&&(null==e.f.email?null:e.f.email.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.f.email?null:e.f.email.hasError("pattern"))&&(null==e.f.email?null:e.f.email.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.f.email?null:e.f.email.hasError("codeExists")),t.xp6(11),t.Q6J("ngIf",(null==e.f.role?null:e.f.role.hasError("required"))&&(null==e.f.role?null:e.f.role.dirty)),t.xp6(5),t.Q6J("ngIf",(null==e.f.password?null:e.f.password.hasError("required"))&&(null==e.f.password?null:e.f.password.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.f.password?null:e.f.password.hasError("minlength"))&&(null==e.f.password?null:e.f.password.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.f.password?null:e.f.password.hasError("pattern"))&&(null==e.f.password?null:e.f.password.dirty))}}M.\u0275fac=function(n){return new(n||M)(t.Y36(f.RO),t.Y36(h.s))},M.\u0275cmp=t.Xpm({type:M,selectors:[["user-actions-component"]],standalone:!0,features:[t.jDz],decls:10,vars:1,consts:[[1,"flex","justify-start","gap-x-3","mt-2",3,"ngClass"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-blue-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-red-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-trash","fa-lg"],["template",""],["deltemplate",""],[1,"text-lg","font-semibold","text-center"],[1,"flex","flex-col","justify-center","my-5",3,"formGroup"],[1,"mb-2"],[1,"block"],[1,"text-red-500"],["formControlName","fullName",1,"mb-1","form-control"],["class","text-xs text-red-500",4,"ngIf"],[1,"my-2"],["formControlName","email",1,"mb-1","form-control"],["aria-label","Default select example","formControlName","role",1,"form-select","form-control"],["value","admin"],["value","user"],["type","password","formControlName","password",1,"mb-1","form-control"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"text-xs","text-red-500"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"]],template:function(n,e){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"div",0)(2,"a",1),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(7);return t.KtG(e.showDialog(s,null==e.cellValue?null:e.cellValue.data))}),t._UZ(3,"i",2),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(9);return t.KtG(e.showDeleteDialog(null==e.cellValue?null:e.cellValue.data,s))}),t._UZ(5,"i",4),t.qZA()(),t.YNc(6,Wt,42,9,"ng-template",null,5,t.W1O),t.YNc(8,te,9,0,"ng-template",null,6,t.W1O),t.BQk()}2&n&&(t.xp6(1),t.Q6J("ngClass",0==e.checkRoles(null==e.cellValue||null==e.cellValue.data?null:e.cellValue.data.roles)?"block":"hidden"))},dependencies:[p.ez,p.mk,p.O5,g.Bz,a.UX,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,d.fN,d.v0,a.u5],encapsulation:2});class N{constructor(n,e,o,r){this.dashboard=n,this.auth=e,this.dialogs=o,this.cf=r,this.userId=null,this.destroy$=new _.x,this.limit=2e3,this.page=0,this.searchValue=new a.NI,this.fetchingUsers=new _.x,this.subscription=[],this.columnDefs=[{field:"fullName",headerName:"Full Name",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"email",headerName:"Email",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"roles",headerName:"Role/s",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"actions",headerName:"Actions",cellRenderer:M,width:80}],this.rowData=[],this.userAddFormCustom=new a.cw({fullName:new a.NI(null,a.kI.compose([a.kI.required])),email:new a.NI(null,a.kI.compose([a.kI.required,a.kI.pattern("^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+.[a-zA-Z]{2,}$")]),[C.Iw.createValidator(this.dashboard,"user")]),role:new a.NI("user",a.kI.compose([a.kI.required])),password:new a.NI("Welcome1!",a.kI.compose([a.kI.minLength(8),a.kI.pattern("^(?=.*[0-9])(?=.*[a-zA-Z]).*$")]))}),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(s=>{this.rowData=s?.results,this.cf.detectChanges()}),this.dashboard.actionComplete.pipe((0,c.R)(this.destroy$)).subscribe(s=>{1==s&&(this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(u=>{this.rowData=u?.results,this.cf.detectChanges()}),this.dashboard.actionComplete.emit(!1))})}onGridReady(n){n.api.sizeColumnsToFit()}get f(){return this.userAddFormCustom.controls}showAddDialog(n){this.subscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),this.formSubmission={data:{}}}addUser(){return this.f.email?.invalid||this.f.fullName?.invalid||this.f.role?.invalid?(this.f.email?.markAsDirty(),this.f.fullName?.markAsDirty(),void this.f.role?.markAsDirty()):this.f.password?.value&&this.f.password?.invalid?(this.f.email?.markAsDirty(),this.f.fullName?.markAsDirty(),this.f.role?.markAsDirty(),void this.f.password?.markAsDirty()):void this.dashboard.addNewUser({roles:[this.userAddFormCustom?.value?.role],fullName:this.userAddFormCustom?.value?.fullName,email:this.userAddFormCustom?.value?.email,password:this.userAddFormCustom?.value?.password||void 0}).pipe((0,c.R)(this.destroy$)).subscribe(e=>{e&&(this.userId=null,this.subscription.forEach(o=>o.unsubscribe()),this.dashboard.getAllUsersForListing(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(o=>{this.rowData=o?.results,this.cf.detectChanges()}))})}cancel(){this.userAddFormCustom.reset(),this.userAddFormCustom.controls.password.setValue("Welcome1!"),this.userAddFormCustom.controls.role.setValue("user")}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}function ce(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Company name is required "),t.qZA())}function pe(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," A company with this name already exists. Please provide another name. "),t.qZA())}function de(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code is required "),t.qZA())}function me(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code should be at least 3 characters "),t.qZA())}function _e(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code should not exceed 4 characters "),t.qZA())}function ge(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," A company with this code already exists. Please provide a different code. "),t.qZA())}function he(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",7),t._uU(1," Update Company "),t.qZA(),t.TgZ(2,"div",8)(3,"label",9),t._uU(4,"Company Name "),t.TgZ(5,"sup",10),t._uU(6,"*"),t.qZA()(),t._UZ(7,"input",11),t.YNc(8,ce,2,0,"span",12),t.YNc(9,pe,2,0,"span",12),t.qZA(),t.TgZ(10,"div",8)(11,"label",13),t._uU(12,"Group Code"),t.TgZ(13,"sup",10),t._uU(14,"*"),t.qZA()(),t._UZ(15,"input",11),t.YNc(16,de,2,0,"span",12),t.YNc(17,me,2,0,"span",12),t.YNc(18,_e,2,0,"span",12),t.YNc(19,ge,2,0,"span",12),t.qZA(),t.TgZ(20,"div",14)(21,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editOrAddCompany())}),t._uU(22," Update "),t.qZA(),t.TgZ(23,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),t.KtG(u.categoryId=null)}),t._uU(24," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(7),t.Q6J("formControl",e.categoryEditControlEdit),t.xp6(1),t.Q6J("ngIf",(null==e.categoryEditControlEdit?null:e.categoryEditControlEdit.hasError("required"))&&(null==e.categoryEditControlEdit?null:e.categoryEditControlEdit.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.categoryEditControlEdit?null:e.categoryEditControlEdit.hasError("codeExists")),t.xp6(6),t.Q6J("formControl",e.groupCodeControlEdit),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.hasError("required"))&&(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.hasError("minlength"))&&(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.hasError("maxlength"))&&(null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.groupCodeControlEdit?null:e.groupCodeControlEdit.hasError("codeExists"))}}function fe(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",18),t._uU(1,"Delete Company"),t.qZA(),t.TgZ(2,"p",19),t._uU(3,"Are you sure you want to delete this company?"),t.qZA(),t.TgZ(4,"div",20)(5,"button",21),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.oxw().deleteCompanyData(),t.KtG(s.complete())}),t._uU(6," Confirm "),t.qZA(),t.TgZ(7,"button",15),t.NdJ("click",function(){const s=t.CHM(e).$implicit;return t.KtG(s.complete())}),t._uU(8," Cancel "),t.qZA()()}}N.\u0275fac=function(n){return new(n||N)(t.Y36(h.s),t.Y36(b.e),t.Y36(f.RO),t.Y36(t.sBO))},N.\u0275cmp=t.Xpm({type:N,selectors:[["ng-component"]],decls:11,vars:5,consts:[[1,"bg_img_main"],[1,"w-11/12","mx-auto","mt-52","pb-60"],[1,"cursor-pointer","flex","justify-end","mb-3"],[1,"px-4","py-2","rounded-lg","bg-[#a58f81]","text-white","no-underline","hover:text-white","text-sm",3,"click"],[1,"flex","flex-col"],[1,"w-full","h-full","overflow-hidden","ag-theme-alpine",3,"rowData","columnDefs","pagination","paginationPageSize","suppressMenuHide","gridReady"],["addTemplate",""],[1,"text-lg","font-semibold","text-center"],[1,"flex","flex-col","justify-center","my-5",3,"formGroup"],[1,"mb-2"],[1,"block"],[1,"text-red-500"],["autocomplete","new-password","formControlName","fullName",1,"mb-1","form-control"],["class","text-xs text-red-500",4,"ngIf"],[1,"my-2"],["autocomplete","new-password","formControlName","email",1,"mb-1","form-control"],["aria-label","Default select example","formControlName","role",1,"form-select","form-control"],["value","admin"],["value","user"],["autocomplete","new-password","type","password","formControlName","password",1,"mb-1","form-control"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"text-xs","text-red-500"]],template:function(n,e){if(1&n){const o=t.EpF();t._UZ(0,"app-header"),t.TgZ(1,"div",0)(2,"section",1)(3,"div",2)(4,"a",3),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(10);return t.KtG(e.showAddDialog(s))}),t._uU(5,"+ Add new user"),t.qZA()(),t.TgZ(6,"div",4)(7,"ag-grid-angular",5),t.NdJ("gridReady",function(s){return e.onGridReady(s)}),t.qZA()()()(),t._UZ(8,"app-footer"),t.YNc(9,ue,42,9,"ng-template",null,6,t.W1O)}2&n&&(t.xp6(7),t.Q6J("rowData",e.rowData)("columnDefs",e.columnDefs)("pagination",!0)("paginationPageSize",10)("suppressMenuHide",!0))},dependencies:[p.O5,T.G,d.v0,x.c,a.YN,a.Kr,a.Fj,a.EJ,a.JJ,a.JL,a.sg,a.u,B.N8],changeDetection:0});class P{constructor(n,e){this.dialogs=n,this.dashboard=e,this.sendingDecision=new _.x,this.destroy$=new _.x,this.saveDialogSubscription=[],this.categoryId=null,this.categoryEditControlEdit=new a.NI("",a.kI.compose([a.kI.required]),[C.Iw.createValidator(this.dashboard,"company","title")]),this.groupCodeControlEdit=new a.NI("",a.kI.compose([a.kI.required,a.kI.minLength(3),a.kI.maxLength(4)]),[C.Iw.createValidator(this.dashboard,"company")])}checkRoles(n){return n?.includes("sysAdmin")}agInit(n){this.cellValue=n}refresh(n){return this.cellValue=n,!0}showAddOrEditDialog(n,e){this.saveDialogSubscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),this.dashboard.excludeIdEmitter.emit(e?.id?e?.id:null),this.categoryEditControlEdit.setValue(e?.title?e?.title:""),this.groupCodeControlEdit.setValue(e?.groupCode?e?.groupCode:""),this.categoryId=e?.id||null}showDeleteDialog(n,e){this.dialogs.open(e,{dismissible:!1,closeable:!1}).subscribe(),this.categoryId=n?.id}editOrAddCompany(){if(this.categoryId){if(this.categoryEditControlEdit.invalid||this.groupCodeControlEdit.invalid)return this.categoryEditControlEdit.markAsDirty(),void this.groupCodeControlEdit.markAsDirty();this.dashboard.updateCompany({title:this.categoryEditControlEdit?.value,groupCode:this.groupCodeControlEdit?.value},this.categoryId).pipe((0,c.R)(this.destroy$)).subscribe(n=>{n&&(this.saveDialogSubscription.forEach(e=>e.unsubscribe()),this.categoryEditControlEdit.reset(),this.groupCodeControlEdit.reset(),this.categoryId=null,this.dashboard.actionComplete.emit(!0))})}}deleteCompanyData(){this.dashboard.deleteCompany(this.categoryId).pipe((0,c.R)(this.destroy$)).subscribe(()=>{this.categoryId=null,this.dashboard.actionComplete.emit(!0)})}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe(),this.saveDialogSubscription.forEach(n=>n.unsubscribe())}}function Ce(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Company name is required "),t.qZA())}function be(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," A company with this name already exists. Please provide another name. "),t.qZA())}function Te(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code is required "),t.qZA())}function xe(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code should be at least 3 characters "),t.qZA())}function ye(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," Group Code should not exceed 4 characters "),t.qZA())}function ve(i,n){1&i&&(t.TgZ(0,"span",17),t._uU(1," A company with this code already exists. Please provide a different code. "),t.qZA())}function De(i,n){if(1&i){const e=t.EpF();t.TgZ(0,"p",8),t._uU(1," Add Company "),t.qZA(),t.TgZ(2,"div",9)(3,"label",10),t._uU(4,"Company Name "),t.TgZ(5,"sup",11),t._uU(6,"*"),t.qZA()(),t._UZ(7,"input",12),t.YNc(8,Ce,2,0,"span",13),t.YNc(9,be,2,0,"span",13),t.qZA(),t.TgZ(10,"div",9)(11,"label",10),t._uU(12,"Group Code"),t.TgZ(13,"sup",11),t._uU(14,"*"),t.qZA()(),t._UZ(15,"input",12),t.YNc(16,Te,2,0,"span",13),t.YNc(17,xe,2,0,"span",13),t.YNc(18,ye,2,0,"span",13),t.YNc(19,ve,2,0,"span",13),t.qZA(),t.TgZ(20,"div",14)(21,"button",15),t.NdJ("click",function(){t.CHM(e);const r=t.oxw();return t.KtG(r.editOrAddCompany())}),t._uU(22," Add "),t.qZA(),t.TgZ(23,"button",16),t.NdJ("click",function(){const s=t.CHM(e).$implicit,u=t.oxw();return s.complete(),u.categoryEditControl.reset(),u.groupCodeControl.reset(),t.KtG(u.categoryId=null)}),t._uU(24," Cancel "),t.qZA()()}if(2&i){const e=t.oxw();t.xp6(7),t.Q6J("formControl",e.categoryEditControl),t.xp6(1),t.Q6J("ngIf",(null==e.categoryEditControl?null:e.categoryEditControl.hasError("required"))&&(null==e.categoryEditControl?null:e.categoryEditControl.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.categoryEditControl?null:e.categoryEditControl.hasError("codeExists")),t.xp6(6),t.Q6J("formControl",e.groupCodeControl),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControl?null:e.groupCodeControl.hasError("required"))&&(null==e.groupCodeControl?null:e.groupCodeControl.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControl?null:e.groupCodeControl.hasError("minlength"))&&(null==e.groupCodeControl?null:e.groupCodeControl.dirty)),t.xp6(1),t.Q6J("ngIf",(null==e.groupCodeControl?null:e.groupCodeControl.hasError("maxlength"))&&(null==e.groupCodeControl?null:e.groupCodeControl.dirty)),t.xp6(1),t.Q6J("ngIf",null==e.groupCodeControl?null:e.groupCodeControl.hasError("codeExists"))}}P.\u0275fac=function(n){return new(n||P)(t.Y36(f.RO),t.Y36(h.s))},P.\u0275cmp=t.Xpm({type:P,selectors:[["companies-actions-component"]],standalone:!0,features:[t.jDz],decls:10,vars:0,consts:[[1,"flex","justify-start","gap-x-2","mt-2"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-blue-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-pencil-square-o","fa-lg"],[1,"w-7","px-1","pt-1","pb-1.5","text-xs","font-medium","text-center","text-white","no-underline","bg-red-600","rounded-md","cursor-pointer","hover:text-white","hover:bg-opacity-80","hover:transition-colors",3,"click"],["aria-hidden","true",1,"fa","fa-trash","fa-lg"],["editTemplate",""],["deltemplate",""],[1,"text-lg","font-semibold","text-center"],[1,"flex","flex-col","justify-center","my-5"],["for","Textarea1",1,"block"],[1,"text-red-500"],[1,"mb-1","form-control",3,"formControl"],["class","text-xs text-red-500",4,"ngIf"],["for","Textarea2",1,"block"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"text-xs","text-red-500"],[1,"pb-2","text-xl","font-semibold","text-center","border-b","border-gray-400"],[1,"mt-4","text-base","font-medium","text-center"],[1,"flex","justify-center","mt-4"],["tuiButton","","appearance","secondary-destructive","type","button","size","m",1,"mx-3",3,"click"]],template:function(n,e){if(1&n){const o=t.EpF();t.ynx(0),t.TgZ(1,"div",0)(2,"a",1),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(7);return t.KtG(e.showAddOrEditDialog(s,null==e.cellValue?null:e.cellValue.data))}),t._UZ(3,"i",2),t.qZA(),t.TgZ(4,"button",3),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(9);return t.KtG(e.showDeleteDialog(null==e.cellValue?null:e.cellValue.data,s))}),t._UZ(5,"i",4),t.qZA()(),t.YNc(6,he,25,8,"ng-template",null,5,t.W1O),t.YNc(8,fe,9,0,"ng-template",null,6,t.W1O),t.BQk()}},dependencies:[p.ez,p.O5,g.Bz,a.UX,a.Fj,a.JJ,a.oH,d.fN,d.v0,a.u5],encapsulation:2});class R{constructor(n,e){this.dashboard=n,this.dialogs=e,this.categoryEditControl=new a.NI("",a.kI.compose([a.kI.required]),[C.Iw.createValidator(this.dashboard,"company","title")]),this.groupCodeControl=new a.NI("",a.kI.compose([a.kI.required,a.kI.minLength(3),a.kI.maxLength(4)]),[C.Iw.createValidator(this.dashboard,"company")]),this.destroy$=new _.x,this.limit=2e3,this.page=0,this.subscription=[],this.columnDefs=[{field:"groupCode",headerName:"Group Code",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"title",headerName:"Company Name",filter:!0,floatingFilter:!0,sortable:!0,resizable:!0},{field:"actions",headerName:"Actions",cellRenderer:P,width:60}],this.rowData=[],this.dashboard.getAllCompanies(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(o=>{this.rowData=o.results}),this.dashboard.actionComplete.pipe((0,c.R)(this.destroy$)).subscribe(o=>{1==o&&this.dashboard.getAllCompanies(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(r=>{this.rowData=r.results})})}onGridReady(n){n.api.sizeColumnsToFit()}editOrAddCompany(){if(this.categoryEditControl.invalid||this.groupCodeControl.invalid)return this.categoryEditControl.markAsDirty(),void this.groupCodeControl.markAsDirty();this.dashboard.addCompany({title:this.categoryEditControl?.value,groupCode:this.groupCodeControl?.value}).pipe((0,c.R)(this.destroy$)).subscribe(n=>{n&&(this.dashboard.getAllCompanies(this.limit,this.page).pipe((0,c.R)(this.destroy$)).subscribe(e=>{this.rowData=e.results}),this.subscription.forEach(e=>e.unsubscribe()),this.categoryEditControl.reset(),this.groupCodeControl.reset(),this.categoryId=null)})}showDialog(n,e){this.subscription.push(this.dialogs.open(n,{dismissible:!1,closeable:!1}).subscribe()),this.dashboard.excludeIdEmitter.emit(e?.id?e?.id:null)}showDeleteDialog(n,e){this.dialogs.open(e,{dismissible:!1,closeable:!1}).subscribe(),this.categoryId=n?.id}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}R.\u0275fac=function(n){return new(n||R)(t.Y36(h.s),t.Y36(f.RO))},R.\u0275cmp=t.Xpm({type:R,selectors:[["ng-component"]],decls:12,vars:5,consts:[[1,"bg_img_main"],[1,"w-11/12","mx-auto","mt-52","pb-60"],[1,"flex","justify-end","mb-5"],[1,"cursor-pointer"],[1,"px-4","py-2","rounded-lg","bg-[#a58f81]","text-white","no-underline","hover:text-white","text-sm",3,"click"],[1,"flex","flex-col"],[1,"w-full","h-full","overflow-hidden","ag-theme-alpine",3,"rowData","columnDefs","pagination","paginationPageSize","suppressMenuHide","gridReady"],["template",""],[1,"text-lg","font-semibold","text-center"],[1,"flex","flex-col","justify-center","my-5"],[1,"block"],[1,"text-red-500"],[1,"mb-1","form-control",3,"formControl"],["class","text-xs text-red-500",4,"ngIf"],[1,"flex","justify-center","gap-x-3"],["tuiButton","","type","button","size","m",3,"click"],["tuiButton","","type","button","size","m","appearance","accent",3,"click"],[1,"text-xs","text-red-500"]],template:function(n,e){if(1&n){const o=t.EpF();t._UZ(0,"app-header"),t.TgZ(1,"div",0)(2,"section",1)(3,"div",2)(4,"div",3)(5,"a",4),t.NdJ("click",function(){t.CHM(o);const s=t.MAs(11);return t.KtG(e.showDialog(s,null))}),t._uU(6,"+ Add company"),t.qZA()()(),t.TgZ(7,"div",5)(8,"ag-grid-angular",6),t.NdJ("gridReady",function(s){return e.onGridReady(s)}),t.qZA()()()(),t._UZ(9,"app-footer"),t.YNc(10,De,25,8,"ng-template",null,7,t.W1O)}2&n&&(t.xp6(8),t.Q6J("rowData",e.rowData)("columnDefs",e.columnDefs)("pagination",!0)("paginationPageSize",10)("suppressMenuHide",!0))},dependencies:[p.O5,T.G,d.v0,x.c,a.Fj,a.JJ,a.oH,B.N8]});var W=l(57505),we=l(22603),tt=l(95380),et=l(8771);class F{constructor(n,e,o,r){this.auth=n,this.dashboard=e,this.notif=o,this.cf=r,this.formData=new Q.X({}),this.userForm=W.dI,this.passwordForm=W.LD,this.destroy$=new _.x,this.passValue=new Q.X(null),this.currentUser=this.auth.currentUserValue,this.formData.next({fullname:this.currentUser?.fullName,email:this.currentUser?.email,roles:this.currentUser?.roles}),this.formSubmission={data:{fullname:this.currentUser?.fullName,email:this.currentUser?.email,roles:this.currentUser?.roles}}}getFormValues(n){if(n?.data)return n}getPasswordFieldValues(n){n?.data&&this.passValue.next(n?.data)}updatePassword(){if(this.passValue?.value?.password?.length>0&&this.passValue?.value?.password1?.length){if(this.passValue?.value?.password!==this.passValue?.value?.password1)return this.notif.displayNotification("Passwords do not match","Update password","warning");this.dashboard.updateUser(this.currentUser?.id,{password:this.passValue?.value?.password}).pipe((0,c.R)(this.destroy$)).subscribe(e=>{})}else this.notif.displayNotification("Please fill in all fields","Update password","warning")}editUser(){if(1==this.checkIfObjectValuesHaveChanged(this.formData?.value,this.formSubmission?.data))return this.notif.displayNotification("You have not changed any information","Edit User Info","warning");this.dashboard.updateUser(this.currentUser?.id,{fullName:this.formSubmission?.data?.fullname,email:this.formSubmission?.data?.email}).pipe((0,c.R)(this.destroy$)).subscribe(e=>{e&&(this.auth.updateUser(e),this.formData.next({fullname:e?.fullName,email:e?.email,roles:e?.roles}))})}checkIfObjectValuesHaveChanged(n,e){const o=Object?.keys(n).sort(),r=Object?.keys(e).sort();return o.length===r.length&&!!o.every((u,j)=>n[u]===e[r[j]])}ngOnDestroy(){this.destroy$.complete(),this.destroy$.unsubscribe()}}F.\u0275fac=function(n){return new(n||F)(t.Y36(b.e),t.Y36(h.s),t.Y36(we.T),t.Y36(t.sBO))},F.\u0275cmp=t.Xpm({type:F,selectors:[["ng-component"]],decls:23,vars:9,consts:[[1,"bg_img_main"],[1,"mt-52","pb-52","mx-auto","w-11/12"],[1,"px-8","py-5","bg-white","rounded-md","w-full","grid","grid-cols-12","sahdow-lg","drop-shadow-lg"],[1,"col-span-4","flex","flex-col","items-center","gap-2"],["new","","size","xxl",3,"text"],[1,"font-semibold"],[1,"col-span-8"],[1,"pb-3","text-base","font-semibold"],[3,"submission","form","change"],["tuiButton","","type","button","size","m",3,"disabled","click"],[1,"py-3","mt-9","text-base","font-semibold"],[3,"form","change"],["tuiButton","","type","button","size","m",3,"click"]],template:function(n,e){if(1&n&&(t._UZ(0,"app-header"),t.TgZ(1,"div",0)(2,"section",1)(3,"div",2)(4,"div",3),t._UZ(5,"tui-avatar",4),t.TgZ(6,"p",5),t._uU(7),t.qZA(),t.TgZ(8,"p"),t._uU(9),t.qZA()(),t.TgZ(10,"div",6)(11,"p",7),t._uU(12,"Profile data"),t.qZA(),t.TgZ(13,"formio",8),t.NdJ("change",function(r){return e.getFormValues(r)}),t.qZA(),t.TgZ(14,"button",9),t.NdJ("click",function(){return e.editUser()}),t.ALo(15,"async"),t._uU(16," Update Profile "),t.qZA(),t.TgZ(17,"p",10),t._uU(18,"Reset password"),t.qZA(),t.TgZ(19,"formio",11),t.NdJ("change",function(r){return e.getPasswordFieldValues(r)}),t.qZA(),t.TgZ(20,"button",12),t.NdJ("click",function(){return e.updatePassword()}),t._uU(21," Update password "),t.qZA()()()()(),t._UZ(22,"app-footer")),2&n){let o;t.xp6(5),t.Q6J("text",null==e.currentUser?null:e.currentUser.fullName),t.xp6(2),t.Oqu(null==e.currentUser?null:e.currentUser.fullName),t.xp6(2),t.Oqu(null==e.currentUser?null:e.currentUser.email),t.xp6(4),t.Q6J("submission",e.formSubmission)("form",e.userForm),t.xp6(1),t.Q6J("disabled",0==(null==(o=t.lcZ(15,7,e.formData))?null:o.isValid)),t.xp6(5),t.Q6J("form",e.passwordForm)}},dependencies:[T.G,d.v0,x.c,tt.k4,et.JP,p.Ov],changeDetection:0});const Ie=[{path:"",component:E,data:{breadcrumb:"Dashboard"},children:[{path:"home",component:k,canActivate:[w],data:{breadcrumb:"Home"}},{path:"categories",component:O,data:{breadcrumb:"Categories"}},{path:"users",component:N,data:{breadcrumb:"Users"}},{path:"companies",component:R,data:{breadcrumb:"Companies"}},{path:"profile",component:F,data:{breadcrumb:"Profile"}},{path:"",redirectTo:"home",pathMatch:"full"}]}];class I{}I.\u0275fac=function(n){return new(n||I)},I.\u0275mod=t.oAB({type:I}),I.\u0275inj=t.cJS({imports:[g.Bz.forChild(Ie),g.Bz]});var S=l(441),Ae=l(1515),q=l(64762),Ee=l(76480),V=l(44358),ke=(l(92172),l(42420)),Ze=l(27969),z=l(11693),it=l(12130),Ue=l(76060),ot=l(54789);const rt={icons:{up:"tuiIconPlus",down:"tuiIconMinus"},appearance:"textfield",hideButtons:!1,min:0,max:Number.MAX_SAFE_INTEGER,step:1,postfix:""},H=new t.OlP("[TUI_INPUT_COUNT_OPTIONS]",{factory:()=>rt}),at=new t.OlP("[TUI_STUCK]"),ze={provide:at,deps:[t.SBq,z.te],useFactory:({nativeElement:i},n)=>{const e=n.pipe((0,Ze.U)(([{intersectionRatio:o}])=>o<1));return i["$.class._stuck"]=e,e}},Je=[{provide:z.RL,useValue:"10000px 10000px 10000px 0px"},{provide:z.op,useValue:[0,1]},{provide:S.x_,useFactory:()=>{const i=new S.qc;return i.appearance="table",i}},{provide:S.rW,useValue:{labelOutside:!0}},{provide:H,deps:[[new t.tp0,H]],useFactory:i=>Object.assign(Object.assign({},i),{hideButtons:!0})},{provide:S.kI,useExisting:(0,t.Gpc)(()=>$)},z.te,it.CV,ze];let $=(()=>{class i extends Ee.QJ{constructor(e,o,r,s){super(),this.entries$=e,this.mode$=o,this.stuck$=r,this.changeDetectorRef=s,this.columns=[],this.size="m",this.direction=1,this.directionChange=new t.vpe,this.sorterChange=new t.vpe,this.sorter=()=>0}updateSorterAndDirection(e){this.sorter===e?this.updateDirection(1===this.direction?-1:1):(this.updateSorter(e),this.updateDirection(1))}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}updateSorter(e){this.sorter=e||(()=>0),this.sorterChange.emit(this.sorter),this.change$.next()}updateDirection(e){this.direction=e,this.directionChange.emit(this.direction),this.change$.next()}}return i.\u0275fac=function(e){return new(e||i)(t.Y36(z.te),t.Y36(Ue.Au),t.Y36(at),t.Y36(t.sBO))},i.\u0275dir=t.lG2({type:i,selectors:[["table","tuiTable",""]],hostAttrs:[2,"border-collapse","separate"],hostVars:1,hostBindings:function(e,o){1&e&&t.NdJ("$.data-mode.attr",function(){return o.mode$})("$.class._stuck",function(){return o.stuck$}),2&e&&t.uIk("data-size",o.size)},inputs:{columns:"columns",size:"size",direction:"direction",sorter:"sorter"},outputs:{directionChange:"directionChange",sorterChange:"sorterChange"},features:[t._Bn(Je),t.qOj]}),(0,q.gn)([(0,V.TH)()],i.prototype,"columns",void 0),(0,q.gn)([(0,V.TH)()],i.prototype,"size",void 0),(0,q.gn)([(0,V.TH)()],i.prototype,"direction",void 0),(0,q.gn)([(0,V.TH)()],i.prototype,"sorter",void 0),i})();new t.tp0;let st=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.ez,J.wq,ke.I,ot.EI]]}),i})();var $e=l(82847),Qe=l(85600),He=l(75111);const lt={sizeOptionContent:function en({$implicit:i}){return`${i}`},showPages:!0,items:[10,20,50,100],size:10};new t.OlP("[TUI_TABLE_PAGINATION_OPTIONS]",{factory:()=>lt});let on=(()=>{class i{}return i.\u0275fac=function(e){return new(e||i)},i.\u0275mod=t.oAB({type:i}),i.\u0275inj=t.cJS({imports:[[p.ez,d.fN,$e.j,Qe.jh,He.pc,ot.EI,J.wq]]}),i})();var rn=l(92668),an=l(48011),sn=l(30663),ln=l(84690),un=l(88024),cn=l(64618),pn=l(64413);class A{}A.\u0275fac=function(n){return new(n||A)},A.\u0275mod=t.oAB({type:A}),A.\u0275inj=t.cJS({imports:[p.ez,I,T.G,d.fN,x.c,st,an.i,rn.WD,sn.$$,a.UX,a.u5,Y.dS,D,pn.e,tt.XI,st,ln.cB,un.zX,S.cn,on,cn.f,et.Jm,y.go,Ae.Q,B.sF]})}}]);