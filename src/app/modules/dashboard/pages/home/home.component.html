<app-header></app-header>
<div class="bg_img_main">
  <app-grid-view-loader *ngIf="!(dashboardApps | async); else dashboardapps"></app-grid-view-loader>
  <ng-template #dashboardapps>
    <section class="grid w-11/12 grid-cols-12 gap-4 mx-auto mt-52 pb-20">
      <ng-container *ngIf="(dashboardApps | async)?.length == 0">
        <p class="col-span-12 my-8 text-base font-semibold text-center">There are currently no categories. Add your first Category <a class="text-[#F15B41] hover:text-[#F15B41] hover:underline" routerLink="/dashboard/create-edit-module">here</a> </p>
      </ng-container>
      <ng-container *ngFor="let app of (dashboardApps | async); let index = index; let firstItem = first">
        <div class="flex justify-between py-2 px-2 bg-[#eae4d8] rounded-md col-span-12">
          <p class="text-lg font-semibold mt-2">{{app.title}}</p>
          <a *ngIf="currentUser?.role == 'admin'" [routerLink]="['/modules/add-module', app._id]" [queryParams]="{parentID: app?.parentId || ''}" class="px-4 py-2 rounded-md bg-[#a58f81] text-white no-underline hover:text-white text-base">+ Add module</a>
        </div>
        <ng-container *ngIf="!app.submodules; else showApps">
          <p class="col-span-12 my-8 text-base font-semibold text-center">No modules exist against this category. </p>
        </ng-container>
        <ng-template #showApps>
          <ng-container *ngFor="let appdata of app?.submodules; let i = index; let firstModule = first; let last = last;">
              <grid-top-app
                (deleteModule)="showDialog($event, template)"
                [appData]="appdata"
                class="col-span-6"
              ></grid-top-app>
          </ng-container>
        </ng-template>
      </ng-container>
    </section>
  </ng-template>

</div>
<app-footer></app-footer>

<ng-template #template let-observer>
  <p class="pb-2 text-xl font-semibold text-center border-b border-gray-400">Delete Module</p>
  <p class="mt-4 text-base font-medium text-center">Are you sure you want to delete this module?</p>
  <div class="flex justify-center mt-4">
    <button
      tuiButton
      appearance="secondary-destructive"
      type="button"
      size="m"
      class="mx-3"
      (click)="deleteModule(); observer.complete()"
      >
      Confirm
    </button>

    <button
      tuiButton
      type="button"
      size="m"
      (click)="observer.complete()"
      >
      Cancel
    </button>
  </div>
</ng-template>
